{"title":"Arista MLS EOS 4.X L2S Security Technical Implementation Guide","description":"This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DOD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents. Comments or proposed revisions to this document should be sent via email to the following address: disa.stig_spt@mail.mil.","version":"2","releaseInfo":"Release: 3 Benchmark Date: 02 Jul 2025","rules":[{"id":"SV-255968r882246_rule","stigId":"V-255968","groupId":"V-255968","title":"DPMS Target Arista MLS EOS 4.X L2S","severity":"CAT I","description":"Controlling LAN access via 802.1x authentication can assist in preventing a malicious user from connecting an unauthorized PC to a switch port to inject or receive data from the network without detection. Satisfies: SRG-NET-000148-L2S-000015, SRG-NET-000343-L2S-000016","fixText":"Configure Arista MLS switch for 802.1X globally with the following mandatory parameters, and then configure non-data center access ports and all applicable interfaces.\n\nStep 1: Configure the Arista MLS switch for 802.1X globally using the following commands:\n\n! \nlogging level DOT1X informational \naaa authentication dot1x default group radius \ndot1x system-auth-control\n!\n\nStep 2: Configure the Arista switch for all non-data center access ports with 802.1X VLAN to an access/trunk port and set the 802.1X port access entity (PAE) to authenticator with the following commands:\n\ninterface Ethernet4\ndescription 802.1X Host-Mode Access Port\n   switchport access vlan 100\n   dot1x pae authenticator\n   dot1x reauthentication\n   dot1x port-control auto\n   dot1x host-mode single-host\n   dot1x timeout quiet-period 10\n!\n\nStep 3: The Arista switch can be also configured for MAC-based authentication. Configuring MAB requires that every supplicant trying to gain access to the switch authenticator port is individually authenticated by MAC address as opposed to authenticating just one supplicant on a given VLAN or port with 802.1X, and then using the MAC address of these devices as username and password in the RADIUS request packets.\n\n!\ninterface Ethernet7\n description MAC-Based Authentication\n   speed 100full\n   dot1x pae authenticator\n   dot1x port-control auto\n   dot1x mac based authentication\n!","checkText":"Verify the Arista MLS switch configuration has 802.1x authentication implemented for all access switch ports connecting to LAN outlets (i.e., RJ-45 wall plates) or devices not located in the telecom room, wiring closets, or equipment rooms. MAC Authentication Bypass (MAB) must be configured on  switch ports connected to devices that do not provide an 802.1x supplicant.\n\nVerify the Arista MLS switch configuration for 802.1x is configured globally and, on the required host-based access ports or MAB, is configured on ports that require RADIUS and MAC-based supplicants.\n\nswitch# show run | section dot1x\nlogging level DOT1X informational \naaa authentication dot1x default group radius \ndot1x system-auth-control\n!\ninterface Ethernet6\n   description 802.1X Access Network\n   switchport access vlan 100\n   dot1x pae authenticator\n   dot1x reauthentication\n   dot1x port-control auto\n   dot1x host-mode single-host\n   dot1x timeout quiet-period 10\n!\ninterface Ethernet7\n   description STIG MAC-Based Authentication\n   speed 100full\n   dot1x pae authenticator\n   dot1x port-control auto\n   dot1x mac based authentication\n!\n\nIf 802.1x authentication or MAB is not configured on all access switch ports connecting to LAN outlets or devices not located in the telecom room, wiring closets, or equipment rooms, this is a finding.","cciIds":["CCI-000778","CCI-001958"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-255969r991773_rule","stigId":"V-255969","groupId":"V-255969","title":"DPMS Target Arista MLS EOS 4.X L2S","severity":"CAT II","description":"Denial of service is a condition when a resource is not available for legitimate users. Packet flooding distributed DoS (DDoS) attacks are referred to as volumetric attacks and have the objective of overloading a network or circuit to deny or seriously degrade performance, which denies access to the services that normally traverse the network or circuit. Volumetric attacks have become relatively easy to launch by using readily available tools such as Low Orbit Ion Cannon or by using botnets. Measures to mitigate the effects of a successful volumetric attack must be taken to ensure that sufficient capacity is available for mission-critical traffic. Managing capacity may include, for example, establishing selected network usage priorities or quotas and enforcing them using rate limiting, Quality of Service (QoS), or other resource reservation control methods. These measures may also mitigate the effects of sudden decreases in network capacity that are the result of accidental or intentional physical damage to telecommunications facilities (such as cable cuts or weather-related outages). Satisfies: SRG-NET-000193-L2S-000020, SRG-NET-000362-L2S-000024, SRG-NET-000512-L2S-000001","fixText":"The Arista MLS switch must be configured to implement a storm-control policy for traffic prioritization and bandwidth reservation.\n\nStorm-control on switch Ethernet interfaces can be configured to limit the packets based on broadcast, multicast, and unknown-unicast traffic:\n\nswitch#configure\nswitch(config)#internet et[X]\ninterface Ethernet[X] \nswitchport\n   storm-control broadcast level pps 5000\n   storm-control multicast level pps 5000\n   storm-control unknown-unicast level pps 5000","checkText":"Verify the Arista MLS switch is configured for storm-control on applicable Ethernet interfaces.\n\nswitch#show storm-control\nPort          Type  Level Rate(Mbps)   Status      Drops Reason\nEt10/2         all     75       7500   active          0\nEt4   multicast     55       5500   active          0\nEt4   broadcast     50       5000   active          \nswitch#\n\nIf the Arista MLS switch is not configured to implement a storm-control policy, this is a finding.","cciIds":["CCI-001095","CCI-002385","CCI-004866"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-255970r882252_rule","stigId":"V-255970","groupId":"V-255970","title":"DPMS Target Arista MLS EOS 4.X L2S","severity":"CAT III","description":"Spanning Tree Protocol (STP) does not provide any means for the network administrator to securely enforce the topology of the switched network. Any switch can be the root bridge in a network. However, a more optimal forwarding topology places the root bridge at a specific predetermined location. With the standard STP, any bridge in the network with a lower bridge ID takes the role of the root bridge. The administrator cannot enforce the position of the root bridge but can set the root bridge priority to 0 in an effort to secure the root bridge position.","fixText":"The Arista MLS switch must be configured for spanning-tree guard root mode on all ports connecting to the access layer interface.\n\nConfigure Arista MLS switch Ethernet interface with the following commands:\n\nswitch#config \nswitch(config)interface Ethernet[X] \nswitch(config-if-Et[X])#spanning-tree guard root\nswitch(config-if-Et[X])#exit \n!","checkText":"Review the Arista MLS switch topology as well as the configuration to verify that root guard is enabled on switch ports facing switches that are downstream from the root bridge.\n\nExample:\nswitch#sh run | sec guard root\ninterface Ethernet37\n   spanning-tree guard root \n\nIf the Arista MLS switch has not enabled guard root on all ports connecting to the access layer where the root bridge must not appear, this is a finding.","cciIds":["CCI-002385"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-255971r882255_rule","stigId":"V-255971","groupId":"V-255971","title":"DPMS Target Arista MLS EOS 4.X L2S","severity":"CAT II","description":"If a rogue switch is introduced into the topology and transmits a Bridge Protocol Data Unit (BPDU) with a lower bridge priority than the existing root bridge, it will become the new root bridge and cause a topology change, rendering the network in a suboptimal state. The STP PortFast BPDU guard enhancement allows network designers to enforce the STP domain borders and keep the active topology predictable. The devices behind the ports that have STP PortFast enabled are not able to influence the STP topology. At the reception of BPDUs, the BPDU guard operation disables the port that has PortFast configured. The BPDU guard transitions the port into a disabled state and sends a log message.","fixText":"The Arista MLS switch provides the capability to configure \"spanning-tree bpduguard\". Configure the Ethernet interface commands:\n\nconfig \ninterface Ethernet[X] \nswitch(config)#interface ethernet [X]\nswitch(config-if-Et[X])#spanning-tree bpduguard enabled\nswitch(config-if-Et[X])","checkText":"Review the Arista MLS to verify that BPDU Guard is enabled on all user-facing or untrusted access switch ports.\n\nswitch#show run | section bpdu\ninterface Ethernet37\n   spanning-tree bpduguard enable\n\nIf the Arista MLS switch has not enabled BPDU Guard, this is a finding.","cciIds":["CCI-002385"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-255972r1107168_rule","stigId":"V-255972","groupId":"V-255972","title":"DPMS Target Arista MLS EOS 4.X L2S","severity":"CAT II","description":"The Spanning Tree Protocol (STP) loop guard feature provides additional protection against STP loops. An STP loop is created when an STP blocking port in a redundant topology erroneously transitions to the forwarding state. In its operation, STP relies on continuous reception and transmission of BPDUs based on the port role. The designated port transmits BPDUs, and the nondesignated port receives BPDUs. When one of the ports in a physically redundant topology no longer receives BPDUs, the STP conceives that the topology is loop free. Eventually, the blocking port from the alternate or backup port becomes a designated port and moves to a forwarding state. This situation creates a loop. The loop guard feature makes additional checks. If BPDUs are not received on a nondesignated port and loop guard is enabled, that port is moved into the STP loop-inconsistent blocking state. In topologies where fiber optic interconnections are used, physical misconnections can occur that allow a link to appear to be up when there is a mismatched set of transmit/receive pairs. When such a physical misconfiguration occurs, protocols such as STP can cause network instability.","fixText":"Configure the Arista MLS switch for STP Loop Guard globally with the following command:\n\nswitch(config)#spanning-tree guard loop default\nswitch(config)#\n\nAlternatively, configure Loop Guard on each interface:\n\nswitch(config-if-Eth6)# spanning-tree guard loop","checkText":"Review the Arista MLS switch configuration to verify that STP Loop Guard is enabled. It can be enabled globally or applied to an interface.\n\nNote: Arista uses STP Loop guard to protect against one-way connections.\n\nswitch# sh run | sec spanning-tree\nspanning-tree guard loop default\n\nOr,\n\ninterface Ethernet6\n    spanning-tree guard loop\n\nIf STP Loop Guard is not configured globally or on nondesignated STP ports, this is a finding.","cciIds":["CCI-002385"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-255973r882261_rule","stigId":"V-255973","groupId":"V-255973","title":"DPMS Target Arista MLS EOS 4.X L2S","severity":"CAT II","description":"In an enterprise network, devices under administrative control are trusted sources. These devices include the switches, routers, and servers in the network. Host ports and unknown DHCP servers are considered untrusted sources. An unknown DHCP server on the network on an untrusted port is called a spurious DHCP server, any device (PC, Wireless Access Point) that is loaded with DHCP server enabled. The DHCP snooping feature determines whether traffic sources are trusted or untrusted. The potential exists for a spurious DHCP server to respond to DHCPDISCOVER messages before the real server has time to respond. DHCP snooping allows switches on the network to trust the port a DHCP server is connected to and not trust the other ports. The DHCP snooping feature validates DHCP messages received from untrusted sources and filters out invalid messages as well as rate-limits DHCP traffic from trusted and untrusted sources. DHCP snooping feature builds and maintains a binding database, which contains information about untrusted hosts with leased IP addresses, and it utilizes the database to validate subsequent requests from untrusted hosts. Other security features, such as IP Source Guard and Dynamic Address Resolution Protocol (ARP) Inspection (DAI), also use information stored in the DHCP snooping binding database. Hence, it is imperative that the DHCP snooping feature is enabled on all user VLANs.","fixText":"Configure the Arista MLS switch to have DHCP snooping enabled globally and for all user VLANs to validate DHCP messages from untrusted sources.\n\nStep 1: Configure DHCP Snooping globally by using the following command:\n\nswitch(config)# ip dhcp snooping\n\nStep 2: Configure DHCP Snooping to enable the insertion of option-82 in DHCP request packets. By default, option-82 is not enabled and without this, DHCP Snooping is not operational.\n\nswitch(config)#ip dhcp snooping information option\n\nStep 3: Configure the Arista MLS switch to enable IP DHCP Snooping on the corresponding VLANs. By default, DHCP Snooping will not be enabled on any VLAN.\n\nswitch(config)#ip dhcp snooping vlan <vlan-id>\n\nStep 4: Configure the following command to set the circuit-id information that will be sent in option-82. By default, Interface name and VLAN ID are sent. Remote circuit-id will always be the MAC address of the relay agent.\n\nswitch# ip dhcp snooping information option circuit-id type 2 format\n  Hostname and interface name\n  Interface name and VLAN ID","checkText":"Review the Arista MLS switch configuration and verify that DHCP snooping is enabled on all user VLANs.\n\nVerify the Arista MLS has the DHCP Snooping feature enabled globally by executing \"show ip dhcp snooping\".\n\nswitch(config)# show ip dhcp snooping\nDHCP Snooping is enabled\nDHCP Snooping is operational\nDHCP Snooping is configured on following VLANs:\n 650\nDHCP Snooping is operational on following VLANs:\n 650\n\nIf the Arista MLS switch does not have DHCP snooping enabled for all user VLANs to validate DHCP messages from untrusted sources, this is a finding.","cciIds":["CCI-002385"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-255974r882264_rule","stigId":"V-255974","groupId":"V-255974","title":"DPMS Target Arista MLS EOS 4.X L2S","severity":"CAT II","description":"IP Source Guard (IPSG) provides source IP address filtering on a layer 2 port to prevent a malicious host from impersonating a legitimate host by assuming the legitimate host's IP address. The feature uses dynamic DHCP snooping and static IP source binding to match IP addresses to hosts on untrusted Layer 2 access ports. Initially, all IP traffic on the protected port is blocked except for DHCP packets. After a client receives an IP address from the DHCP server, or after static IP source binding is configured by the administrator, all traffic with that IP source address is permitted from that client. Traffic from other hosts is denied. This filtering limits a host's ability to attack the network by claiming a neighbor host's IP address.","fixText":"Configure the Arista MLS switch to have IPSG enabled on all user-facing or untrusted access switch ports.\n\nStep 1: The Arista MLS IPSG feature must be configured by applying filters to inbound IP packets based on their source MAC and IP addresses. The following example commands exclude VLAN IDs 1 through 3 from IPSG filtering. When enabled on a trunk port, IPSG filters the inbound IP packets on all allowed VLANs. IP packets received on VLANs 4 through 10 on Ethernet 36 will be filtered by IPSG, while those received on VLANs 1 through 3 are permitted.\n\nswitch(config)#no ip verify source vlan 1-3\nswitch(config)#interface ethernet 36\nswitch(config-if-Et36)#switchport mode trunk\nswitch(config-if-Et36)#switchport trunk allowed vlan 1-10\nswitch(config-if-Et36)#ip verify source\nswitch(config-if-Et36)#\n\nStep 2: By using the Arista MLS switch command, the switch binds the source IP-MAC binding entries to IP address 10.1.1.1, MAC address 0000.aaaa.1111, VLAN ID 4094, and Ethernet interface 36.\n\nswitch(config)#ip source binding 10.1.1.1 0000.aaaa.1111 vlan 4094 interface ethernet 36\nswitch(config)#","checkText":"Review the Arista MLS switch configuration to verify that IPSG is enabled on all user-facing or untrusted access switch ports.\n\nStep 1: The Arista MLS switch command verifies the IPSG configuration and operational states.\n\nswitch(config)#show ip verify source\n\nInterface       Operational State\n--------------- ------------------------\nEthernet1       IP source guard enabled\nEthernet2       IP source guard disabled\n\nStep 2: The following command displays all VLANs configured in no IP verify source VLAN:\n\nswitch(config)#show ip verify source vlan\n\nIPSG disabled on VLANS: 1-2\nVLAN            Operational State\n--------------- ------------------------\n1               IP source guard disabled\n2               Error: vlan classification failed\n\nIf the Arista MLS switch does not have IP Source Guard enabled on all untrusted access switch ports, this is a finding.","cciIds":["CCI-002385"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-255975r882267_rule","stigId":"V-255975","groupId":"V-255975","title":"DPMS Target Arista MLS EOS 4.X L2S","severity":"CAT II","description":"DAI intercepts Address Resolution Protocol (ARP) requests and verifies that each of these packets has a valid IP-to-MAC address binding before updating the local ARP cache and before forwarding the packet to the appropriate destination. Invalid ARP packets are dropped and logged. DAI determines the validity of an ARP packet based on valid IP-to-MAC address bindings stored in the DHCP snooping binding database. If the ARP packet is received on a trusted interface, the switch forwards the packet without any checks. On untrusted interfaces, the switch forwards the packet only if it is valid.","fixText":"Configure the Arista MLS switch to have static Address Resolution Protocol (ARP) Inspection to be enabled on all user VLANs.\n\nBy default, Arista MLS switch static ARP Inspection is disabled on all VLANs. Static ARP inspection can be enabled on all specific user VLANs by using the following command:\n\nswitch(config)#ip arp inspection vlan <vlan-list>","checkText":"Review the Arista MLS switch configuration to verify that Dynamic Address Resolution Protocol (ARP) Inspection (DAI) feature is enabled on all user VLANs.\n\nVerify ARP inspection for user VLANs by the following command:\n\nsh ip arp inspection vlan\n\nVLAN 2200\n------------\nConfiguration: Enabled\nOperation State: Active\n\nIf static ARP inspection is not enabled on all user VLANs, this is a finding.","cciIds":["CCI-002385"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-255976r882270_rule","stigId":"V-255976","groupId":"V-255976","title":"DPMS Target Arista MLS EOS 4.X L2S","severity":"CAT III","description":"IGMP and MLD snooping provides a way to constrain multicast traffic at Layer 2. By monitoring the IGMP or MLD membership reports sent by hosts within a VLAN, the snooping application can set up Layer 2 multicast forwarding tables to deliver specific multicast traffic only to interfaces connected to hosts interested in receiving the traffic, thereby significantly reducing the volume of multicast traffic that would otherwise flood the VLAN.","fixText":"Configure the Arista MLS switch for IGMP snooping for IPv4 and IPv6 multicast traffic for each VLAN.\n\nConfigure the Arista MLS switch for IP PIM, which also enables IGMP on an Arista MLS switch VLAN or interface, by using the following command:\n\nswitch(config)#int vlan8\n   ip igmp\n   pim ipv4 sparse-mode\n   pim ipv6 sparse-mode\nswitch(config)#exit\n!\n\nArista MLS switch alternative configuration for MLD snooping on an interface for version 1 and 2. Version 2 is the default MLD version.\n\nswitch(config)# mld snooping\nswitch(config-mld-snooping)# vlan 200\n!","checkText":"Review the Arista MLS switch configuration to verify that IGMP or MLD snooping has been configured.\n\nDetermine which snooping feature is used.\n\nFor IGMP:\nVerify the PIM that also enables IGMP on an Arista MLS switch VLAN interface by using the \"sh run interface vlan8\" command:\n\nswitch(config)#sh run int vlan8\ninterface VLAN8\n   ip igmp\n   pim ipv4 sparse-mode\nswitch(config)#exit\n\nFor MLD:\nVerify the Arista MLS switch is configured for MLD snooping on an interface for version 1 and 2. Version 2 is the default MLD version.\n\nswitch#sh run | section mld\n mld snooping\n   vlan 200\n\nIf the Arista switch is not configured to implement IGMP or MLD snooping for each VLAN, this is a finding.","cciIds":["CCI-000366"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-255977r882273_rule","stigId":"V-255977","groupId":"V-255977","title":"DPMS Target Arista MLS EOS 4.X L2S","severity":"CAT II","description":"Spanning Tree Protocol (STP) is implemented on bridges and switches to prevent layer 2 loops when a broadcast domain spans multiple bridges and switches and when redundant links are provisioned to provide high availability in case of link failures. Convergence time can be significantly reduced using Multiple Spanning-Tree (802.1s) instead of Rapid STP (802.1w) instead of STP (802.1d), resulting in improved availability. Multiple Spanning-Tree Protocol (MSTP) should be deployed by implementing either Rapid Per-VLAN-Spanning-Tree (Rapid-PVST) or Multiple Spanning-Tree MST, the latter scales topologies much better when there are many VLANs.","fixText":"Configure the Arista MLS switch for Multiple Spanning-tree (MST) or Rapid STP to be implemented at the access and distribution layers where VLANs span multiple switches.\n\nswitch(config)#spanning-tree mode mstp\n\nThe Arista MLS switch can alternatively be configured for spanning-tree mode RSTP to support a spanning-tree instance for each VLAN:\n\nswitch(config)#\nspanning-tree mode rstp\n!","checkText":"In cases where VLANs do not span multiple switches, it is a best practice to not implement STP. Avoiding the use of STP will provide the most deterministic and highly available network topology. If STP is required, review the Arista MLS switch configuration to verify that Rapid STP has been implemented.\n\nswitch(config)#sh run | sec spanning-tree\nspanning-tree mode rstp\n!\n\nNote: MSTP can be configured as an alternate mode. MSTP uses RSTP for rapid convergence and enables multiple VLANs to be grouped into and mapped to the same spanning-tree instance, thereby reducing the number of spanning-tree instances needed to support a large number of VLANs.\n\nIf MSTP or Rapid STP has not been implemented where STP is required, this is a finding.","cciIds":["CCI-000366"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-255979r882279_rule","stigId":"V-255979","groupId":"V-255979","title":"DPMS Target Arista MLS EOS 4.X L2S","severity":"CAT II","description":"When trunk negotiation is enabled via Dynamic Trunk Protocol (DTP), considerable time can be spent negotiating trunk settings (802.1q or ISL) when a node or interface is restored. While this negotiation is happening, traffic is dropped because the link is up from a layer 2 perspective. Packet loss can be eliminated by setting the interface statically to trunk mode, thereby avoiding dynamic trunk protocol negotiation and significantly reducing any outage when restoring a failed link or switch.","fixText":"Configure static Ethernet interfaces for switchport trunk mode. Ensure required VLAN member tagged traffic is allowed and all other VLAN traffic will be dropped unless an associated untagged native VLAN for the Ethernet interface is allowed.\n\nswitch#configure\nswitch(config)#interface Ethernet6\n   description STIG Static Trunk\n   speed forced 10000full\n   switchport trunk native vlan 2102\n   switchport trunk allowed vlan 2100-2102\n   switchport mode trunk\n!\nswitch(config)#interface Ethernet7\n   description STIG Static Trunk\n   speed forced 10000full\n   switchport trunk native vlan 3102\n   switchport trunk allowed vlan 3100-3102\n   switchport mode trunk\n!","checkText":"Review the Arista MLS switch configuration to verify that all Ethernet interfaces designated as trunk links are statically configured to specify only member tagged VLAN traffic is allowed and all nonmember VLAN traffic will be dropped unless untagged traffic is associated with the interface's native VLAN.\n\nswitch#show run | section trunk\n!\ninterface Ethernet6\n   description STIG Static Trunk\n   speed forced 10000full\n   switchport trunk native vlan 2102\n   switchport trunk allowed vlan 2100-2102\n   switchport mode trunk\n!\n\nIf trunk negotiation is enabled on any interface, this is a finding.","cciIds":["CCI-000366"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-255980r991774_rule","stigId":"V-255980","groupId":"V-255980","title":"DPMS Target Arista MLS EOS 4.X L2S","severity":"CAT II","description":"It is possible that a disabled port that is assigned to a user or management VLAN becomes enabled by accident or by an attacker and as a result gains access to that VLAN as a member.","fixText":"Configure all Arista MLS switch ports not in use to be shut down and assigned to an unused VLAN.\n\nStep 1: Configure all unused ports to be shut down and assigned to an unused VLAN.\n\nswitch(config)#interface ethernet 9\nswitch(config-eth9)#shutdown\nswitch(config-eth9)# description this port is intentionally shutdown\nswitch(config-eth9)# switchport access vlan 999\n\nStep 2: Configure any trunk links to exclude the unused VLAN.\n\nswitch(config)# interface ethernet 10\nswitch(config-eth10)# switchport trunk native vlan 1000\nswitch(config-eth9)# switchport trunk allowed vlan 2-998, 1001-4094\nswitch(config-eth9)# switchport mode trunk","checkText":"Step 1: Review the switch configuration and examine all access switch ports. Verify the unused port is configured to be intentionally shut down and assigned to an inactive VLAN.\n\nswitch(config)#sh run int eth8\ninterface Ethernet8\n   description PORT IS INTENTIONALLY SHUTDOWN\n   switchport access vlan 999\n   shutdown\nswitch(config)# \n\nStep 2: Verify traffic from the inactive VLAN is not allowed on any trunk links as shown in the example below:\n\nswitch(config)#sh run int eth9\ninterface Ethernet9\n   switchport trunk native vlan 1000\n   switchport trunk allowed vlan 2-998, 1001-4094\n   switchport mode trunk\nswitch(config)# \n\nIf any access switch ports are not in use and not in an inactive shutdown, this is a finding.\n\nNote: Switch ports configured for 802.1x are exempt from this requirement.","cciIds":["CCI-004891"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-255981r991775_rule","stigId":"V-255981","groupId":"V-255981","title":"DPMS Target Arista MLS EOS 4.X L2S","severity":"CAT II","description":"In a VLAN-based network, switches use the default VLAN (i.e., VLAN 1) for in-band management and to communicate with other networking devices using Spanning-Tree Protocol (STP), Dynamic Trunking Protocol (DTP), VLAN Trunking Protocol (VTP), and Port Aggregation Protocol (PAgP)—all untagged traffic. As a consequence, the default VLAN may unwisely span the entire network if not appropriately pruned. If its scope is large enough, the risk of compromise can increase significantly.","fixText":"Configure the Arista MLS switch to remove the assignment of the default VLAN from all access switch ports.\n\nStep 1: Configure the Default VLAN 1 to shut down by using the following command:\n\nswitch:(config#)interface vlan 1\nswitch(config-int-vlan1)#shutdown\n\nStep 2: Configure all access switch ports to be placed in a VLAN other than the default (1):\n\nswitch(config)#interface ethernet 8\nswitch(config-eth8)#switchport access vlan 1000\nswitch(config-eth8)#exit","checkText":"Review the Arista MLS switch configurations and verify no access switch ports have been assigned membership to the default VLAN (i.e., VLAN 1).\n \nswitch(config)#sh vlan\nVLAN  Name                             Status    Ports\n----- -------------------------------- --------- -------------------------------\n1     default                                              \n8     VLAN0008                        active    Cpu\n25    VLAN0025                       active    Cpu\n100   VLAN0100                      active    Cpu\n1000  VLAN1000                     active    Eth1, Eth2\n\nIf access switch ports are assigned to the default VLAN, this is a finding.","cciIds":["CCI-004891"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-255982r991776_rule","stigId":"V-255982","groupId":"V-255982","title":"DPMS Target Arista MLS EOS 4.X L2S","severity":"CAT II","description":"The default VLAN (i.e., VLAN 1) is a special VLAN used for control plane traffic such as Spanning-Tree Protocol (STP), Dynamic Trunking Protocol (DTP), VLAN Trunking Protocol (VTP), and Port Aggregation Protocol (PAgP). VLAN 1 is enabled on all trunks and ports by default. With larger campus networks, care needs to be taken about the diameter of the STP domain for the default VLAN. Instability in one part of the network could affect the default VLAN, thereby influencing control-plane stability and therefore STP stability for all other VLANs.","fixText":"Best practice for VLAN-based networks is to configure Arista MLS switch to prune unnecessary trunk links from gaining access to the default VLAN and ensure frames belonging to the default VLAN do not traverse trunks not requiring frames from the VLAN.\n\nStep 1: Configure the Arista MLS switch to ensure VLAN1 is pruned from all trunk and access ports that do not require it by using the following commands:\n\nswitch(config)#vlan 1\nswitch(config-vlan-1)#show active\nswitch(config-vlan-1)#sh act\nvlan \n   !! STIG suspend vlan 1 #state suspend vlan 1\nswitch(config-vlan-1)#exit\n\nStep 2: Configure the Arista MLS switch to allow VLAN trunking except default VLAN 1 and configure Ethernet port 1 to change the native VLAN to 1000.\n\nswitch(config)#interface e10\nswitch(config-eth1o)#switchport trunk native vlan 1000\nswitch(config-eth1)#switchport trunk allowed vlan except 1\n \nStep 3: Alternatively, the Arista MLS switch can use trunk groups to determine which trunks service which VLANs:\n\nswitch(config)#vlan 1\nswitch(config-vlan-1)#trunk group DO_NOT_USE\nswitch(config-vlan-1)#sh act\nvlan \n   !! STIG suspend vlan 1 #state suspend vlan 1\n   trunk group DO_NOT_USE\nhss474.10:51:12(config-vlan-1)#\n\nStep 4: On Arista MLS switch, ensure any unnecessary trunk links have not gained access to default VLAN 1; this can be verified with the command \"show vlan brief\":\n\nswitch(config)#sh vlan brief\nVLAN Name                             Status    Ports\n----- -------------------------------- --------- -------------------------------\n1     default                             \n8     VLAN0008                         active    Cpu\n25    VLAN0025                        active    Cpu\n100   VLAN0100                       active    Cpu\n1000  VLAN1000                      active    Eth1, Eth15, Eth16, Eth17\n4090  VLAN4090                      active    Eth2, Eth20, Eth32","checkText":"Review the Arista MLS switch configuration and verify the default VLAN is pruned from trunk links that do not require it.\n\nStep 1: Review the Arista MLS switch configuration by using the following commands to ensure the default VLAN 1 state is suspended:\n\nswitch(config)#vlan 1\nswitch(config-vlan-1)#sh act\nvlan \n   !! STIG suspend vlan 1 #state suspend vlan 1\nswitch(config-vlan-1)#exit\n\nStep 2: Review the configuration to ensure default VLAN 1 is pruned from any trunk active links by using the command \"show vlan brief\":\n\nswitch(config-vlan-4090)#\nswitch(config-vlan-4090)#sh vlan brie\nVLAN  Name                             Status    Ports\n----- -------------------------------- --------- -------------------------------\n1     default                             \n8     VLAN0008                         active    Cpu\n25    VLAN0025                        active    Cpu\n100   VLAN0100                       active    Cpu\n1000  VLAN1000                      active    \n4090  VLAN4090                      active   \n\nIf the default VLAN state is not suspended and pruned from trunk links that should not be transporting frames for the VLAN, this is a finding.","cciIds":["CCI-004891"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-255983r991777_rule","stigId":"V-255983","groupId":"V-255983","title":"DPMS Target Arista MLS EOS 4.X L2S","severity":"CAT II","description":"Switches use the default VLAN (i.e., VLAN 1) for in-band management and to communicate with directly connected switches using Spanning-Tree Protocol (STP), Dynamic Trunking Protocol (DTP), VLAN Trunking Protocol (VTP), and Port Aggregation Protocol (PAgP)—all untagged traffic. As a consequence, the default VLAN may unwisely span the entire network if not appropriately pruned. If its scope is large enough, the risk of compromise can increase significantly.","fixText":"Step 1: Configure the Arista MLS switch for a VRF instance for Management Network access by using the following commands:\n\nswitch(config)#vrf instance Management_Network\nswitch(config-vrf-Management_Network)#exit\n\nStep 2: Configure the Ethernet port for VRF Management_Network and IP address for the management network traffic:\n\nswitch(config-if-Et12)#vrf Management_Network \nswitch(config-if-Et12)#ip address 10.10.40.254/30\nswitch(config-if-Et12)#exit","checkText":"Verify the Arista MLS configuration for a Management_Network VRF instance globally on the switch with the following example:\n\nswitch(config)#sh run | sec vrf\nip name-server vrf default 192.168.10.20\n!\nvrf instance Management_Network\n!\ninterface Ethernet12\n   description MANAGEMENT NETWORK PORT\n   no switchport\n   vrf Management_Network\n   ip address 10.10.40.254/30\n!\nip routing vrf Management_Network \n\nIf the VRF is not configured to prevent the default VLAN from being used to access the switch, this is a finding.","cciIds":["CCI-004931"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-255984r991778_rule","stigId":"V-255984","groupId":"V-255984","title":"DPMS Target Arista MLS EOS 4.X L2S","severity":"CAT II","description":"Double encapsulation can be initiated by an attacker who has access to a switch port belonging to the native VLAN of the trunk port. Knowing the victim's MAC address and with the victim attached to a different switch belonging to the same trunk group, thereby requiring the trunk link and frame tagging, the malicious user can begin the attack by sending frames with two sets of tags. The outer tag that will have the attacker's VLAN ID (probably the well-known and omnipresent default VLAN) is stripped off by the switch, and the inner tag that will have the victim's VLAN ID is used by the switch as the next hop and sent out the trunk port.","fixText":"Configure the Arista MLS switch to disable trunking on all user-facing or untrusted switch ports.\n\nswitch{config)#interface ethernet 13 - 15\nswitch(config-if-Et13-15)#description disable trunking untrusted ports\nswitch(config-if-Et13-15)#switchport mode access\nswitch(config-if-Et13-15)#exit","checkText":"Review the Arista MLS switch configurations and examine all user-facing or untrusted switch ports configured as access switch ports.\n\nswitch(config)# show run interface ethernet 13 - 15 \ninterface Ethernet13\n   switchport access vlan 100\ninterface Ethernet14\n   switchport access vlan 100\ninterface Ethernet14\n   switchport access vlan 100\n\nIf any of the user-facing switch ports are configured as a trunk, this is a finding.","cciIds":["CCI-004891"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-255985r991779_rule","stigId":"V-255985","groupId":"V-255985","title":"DPMS Target Arista MLS EOS 4.X L2S","severity":"CAT II","description":"VLAN hopping can be initiated by an attacker who has access to a switch port belonging to the same VLAN as the native VLAN of the trunk link connecting to another switch that the victim is connected to. If the attacker knows the victim’s MAC address, it can forge a frame with two 802.1q tags and a layer 2 header with the destination address of the victim. Since the frame will ingress the switch from a port belonging to its native VLAN, the trunk port connecting to the victim’s switch will simply remove the outer tag because native VLAN traffic is to be untagged. The switch will forward the frame on to the trunk link unaware of the inner tag with a VLAN ID of which the victim’s switch port is a member.","fixText":"Configure the interface trunk ports for the unique Native VLAN ID and configure the VLAN allowed by using the following commands:\n\nswitch(config)#interface Ethernet10\nswitch(config-eth10)#description #STIG VLAN 1 Pruning\nswitch(config-eth10)# switchport trunk native vlan 1000\nswitch(config-eth10)#switchport trunk allowed vlan 2-4094","checkText":"Review the Arista MLS switch configuration for all trunk ports to have a unique native VLAN ID that is not the default VLAN 1 by using the following example:\n\nswitch(config)#sh run | sec native vlan\ninterface Ethernet4\n   description STIG Disable_VLAN 1 and native vlan to 1000\n   switchport trunk native vlan 1000\n   switchport trunk allowed vlan 2-4094\n\nIf the native VLAN has the same VLAN ID as the default VLAN, this is a finding.","cciIds":["CCI-004891"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-255986r991780_rule","stigId":"V-255986","groupId":"V-255986","title":"DPMS Target Arista MLS EOS 4.X L2S","severity":"CAT III","description":"Double encapsulation can be initiated by an attacker who has access to a switch port belonging to the native VLAN of the trunk port. Knowing the victim’s MAC address and with the victim attached to a different switch belonging to the same trunk group, thereby requiring the trunk link and frame tagging, the malicious user can begin the attack by sending frames with two sets of tags. The outer tag that will have the attacker’s VLAN ID (probably the well-known and omnipresent default VLAN) is stripped off by the switch, and the inner tag that will have the victim’s VLAN ID is used by the switch as the next hop and sent out the trunk port.","fixText":"Configure the Arista MLS switch to ensure all access switch ports use a VLAN other than the native VLAN.\n\nConfigure all access switch ports to a VLAN other than the designated native VLAN by using the following example:\n\nswitch(config)#interface Ethernet 21\nswitch(config-Eth21)# switchport access vlan xxxx","checkText":"Review the configuration for all trunking ports to determine the native VLAN by using the following example (for vlan 1000):\n\nswitch(config-if-Et4)#sh run int eth4\ninterface Ethernet4\n   description STIG Disable_VLAN 1 and native vlan to 1000\n   switchport trunk native vlan 1000\n   switchport trunk allowed vlan 2-999,1001-4094\nswitch(config-if-Et4)#\n\nReview the configuration to ensure no access switch ports are configured in the native VLAN by using the following example (for vlan 1000):\n\nswtich#sh vlan brief\nVLAN  Name                             Status    Ports\n----- -------------------------------- --------- -------------------------------\n1     default                              \n8     VLAN0008                         active    Cpu\n25    VLAN0025                        active    Cpu\n100   VLAN0100                       active    Cpu\n1000  VLAN1000                      active   \n4090  VLAN4090                      active    \n\nIf any access switch ports have been assigned to the same VLAN ID as the native VLAN, this is a finding.","cciIds":["CCI-004891"],"status":"not_reviewed","findingDetails":"","comments":""}]}