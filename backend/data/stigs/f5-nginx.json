{"title":"F5 NGINX Security Technical Implementation Guide","description":"This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DOD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents. Comments or proposed revisions to this document should be sent via email to the following address: disa.stig_spt@mail.mil.","version":"1","releaseInfo":"Release: 1 Benchmark Date: 25 Nov 2025","rules":[{"id":"SV-278380r1172745_rule","stigId":"V-278380","groupId":"V-278380","title":"DPMS Target F5 NGINX","severity":"CAT II","description":"NGINX management includes the ability to control the number of users and user sessions that use an application. Limiting the number of allowed users and sessions per user is helpful in limiting risks related to denial-of-service (DoS) attacks. This requirement can be met via the application or by using information system session control provided by a web server with specialized session management capabilities. If it has been specified that this requirement will be handled by the application, the capability to limit the maximum number of concurrent single user sessions must be designed and built into the application. This requirement addresses concurrent sessions for information system accounts and does not address concurrent sessions by single users via multiple system accounts. The maximum number of concurrent sessions should be defined based upon mission needs and the operational environment for each system.","fixText":"Determine the path to NGINX config file(s):\n\nnginx -qT | grep \"# configuration\"\n# configuration file /etc/nginx/nginx.conf:\n\nNote: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\n\nAdd or modify the number of \"worker_connections\" based on the needs of the application.\n\nNote: By default, NGINX limits the number of concurrent connections to 512 per worker process, and the number of worker processes is equal the number of CPUs present. This results in a maximum number of connections equal to \"worker_connections\" multiplied by the number of \"worker_processes\". In a proxy configuration, NGINX will use a connection on both the client side and the server side. This results in two connections for each client side connection. \n\nRestart NGINX:\n\n   systemctl restart nginx","checkText":"Determine path to NGINX config file(s):\n\nnginx -qT | grep \"# configuration\"\n# configuration file /etc/nginx/nginx.conf:\n\nNote: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\n\nnginx -c <path to nginx config> -qT | grep worker_connections\n    worker_connections 512;\n\nVerify \"worker_connections\" is set in the configuration to an organization-defined number.\n\nIf the \"worker_connections\" is not set to an organization-defined number, this is a finding.","cciIds":["CCI-000054"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-278381r1171895_rule","stigId":"V-278381","groupId":"V-278381","title":"DPMS Target F5 NGINX","severity":"CAT I","description":"Using older unauthorized versions or incorrectly configuring protocol negotiation makes the gateway vulnerable to known and unknown attacks that exploit vulnerabilities in this protocol. This requirement applies to Transport Layer Security (TLS) gateways (also known as Secure Sockets Layer [SSL] gateways), web servers, and web applications and is not applicable to virtual private network (VPN) devices. Application protocols such as HTTPS and DNSSEC use TLS as the underlying security protocol and thus are in scope for this requirement. NIST SP 800-52 provides guidance for client negotiation on either DOD-only or on public-facing servers. Satisfies: SRG-APP-000014, SRG-APP-000015, SRG-APP-000560, SRG-APP-000565","fixText":"Specify the allowed TLS protocols by adding the following line to the server {} block:\n\n  ssl_protocols TLSv1.2 TLSv1.3;\n\nRestart NGINX with saved configuration:\n\nnginx -s reload","checkText":"Determine the path to NGINX config file(s):\n\nnginx -qT | grep \"# configuration\"\n# configuration file /etc/nginx/nginx.conf:\n\nNote: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\n\nVerify \"ssl_protocols\" are set to TLSv1.2 or higher:\n\nnginx -c <path to nginx config> -qT | grep ssl_protocols\n    ssl_protocols TLSv1.2 TLSv1.3;\n\nIf \"ssl_protocols\" does not exist or does not specify TLSv1.2 or greater, this is a finding","cciIds":["CCI-000068","CCI-001453"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-278382r1171898_rule","stigId":"V-278382","groupId":"V-278382","title":"DPMS Target F5 NGINX","severity":"CAT II","description":"To mitigate the risk of unauthorized access to sensitive information by entities that have been issued certificates by DOD-approved PKIs, all DOD systems (e.g., networks, web servers, and web portals) must be properly configured to incorporate access control methods that do not rely solely on the possession of a certificate for access. Successful authentication must not automatically give an entity access to an asset or security boundary. Authorization procedures and controls must be implemented to ensure each authenticated entity also has a validated and current authorization. Authorization is the process of determining whether an entity, once authenticated, is permitted to access a specific asset. Information systems use access control policies and enforcement mechanisms to implement this requirement. Access control policies include identity-based policies, role-based policies, and attribute-based policies. Access enforcement mechanisms include access control lists, access control matrices, and cryptography. These policies and mechanisms must be employed by the application to control access between users (or processes acting on behalf of users) and objects (e.g., devices, files, records, processes, programs, and domains) in the information system. This requirement is applicable to access control enforcement applications (e.g., authentication servers) and other applications that perform information and system access control functions.","fixText":"Set a nonlogin shell for the nginx user:\n\nsudo usermod -s /sbin/nologin nginx","checkText":"Determine the path to NGINX config file(s):\n\nnginx -qT | grep \"# configuration\"\n# configuration file /etc/nginx/nginx.conf:\n\nNote: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\n\nIdentify the NGINX runtime user:\n\ngrep -E '^\\s*user\\s+' /etc/nginx/nginx.conf\n\nExpected output (example):\n\nuser nginx;\n\nVerify the user has no login shell:\n\ngetent passwd nginx\n\nExpected output:\n\nnginx:x:998:998:Nginx user:/nonexistent:/sbin/nologin\n\nEnsure the shell is \"/sbin/nologin\", \"/usr/sbin/nologin\", or \"/bin/false\".\n\nIf the NGINX runtime user has shell access, this is a finding.","cciIds":["CCI-000213"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-278383r1171901_rule","stigId":"V-278383","groupId":"V-278383","title":"DPMS Target F5 NGINX","severity":"CAT II","description":"A mechanism to detect and prevent unauthorized communication flow must be configured or provided as part of the system design. If information flow is not enforced based on approved authorizations, the system may become compromised. Information flow control regulates where information is allowed to travel within a system and between interconnected systems. The flow of all system information must be monitored and controlled so it does not introduce any unacceptable risk to the systems or data. Application-specific examples of enforcement occur in systems that employ rule sets or establish configuration settings that restrict information system services, or message-filtering capability based on message content (e.g., implementing key word searches or using document characteristics). Applications providing information flow control must be able to enforce approved authorizations for controlling the flow of information within the system in accordance with applicable policy.","fixText":"Remove the user from privileged groups:\n\nsudo gpasswd -d nginx sudo\nsudo gpasswd -d nginx wheel\nsudo gpasswd -d nginx admin","checkText":"Determine the path to NGINX config file(s):\n\nnginx -qT | grep \"# configuration\"\n# configuration file /etc/nginx/nginx.conf:\n\nNote: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\n\nIdentify the NGINX runtime user:\n\ngrep -E '^\\s*user\\s+' /etc/nginx/nginx.conf\n\nExpected output (example):\n\nuser nginx;\n\nEnsure the user is not in a privileged group:\n\nid nginx\n\nExpected output:\n\nuid=980(nginx) gid=979(nginx) groups=979(nginx)\n\nThe user should not be a member of sudo, wheel, admin, or similar elevated groups.\n\nIf the NGINX runtime user is a member of an elevated group, this is a finding.","cciIds":["CCI-001368"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-278384r1171904_rule","stigId":"V-278384","groupId":"V-278384","title":"DPMS Target F5 NGINX","severity":"CAT II","description":"Display of the DOD-approved use notification before granting access to the application ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance. System use notifications are required only for access via logon interfaces with human users and are not required when such human interfaces do not exist. The banner must be formatted in accordance with DTM-08-060. Use the following verbiage for applications that can accommodate banners of 1300 characters: \"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions: -The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations. -At any time, the USG may inspect and seize data stored on this IS. -Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose. -This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy. -Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\" Use the following verbiage for operating systems that have severe limitations on the number of characters that can be displayed in the banner: \"I've read & consent to terms in IS user agreem't.\" Satisfies: SRG-APP-000068, SRG-APP-000069, SRG-APP-000070","fixText":"Note: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\n\nConfigure nginx.conf for a section that verifies that user consent has been given. Setting a cookie upon user acceptance after reading the banner and checking for the presence of that cookie is one way to accomplish this.\n\nAdd this block in nginx.conf under the http block:\n\n    # Define whether consent has been given based on the cookie\n    map $http_cookie $consent_given {\n        \"~*user_consent=1\" 1;\n        default 0;\n    }\n\nConfigure nginx.conf for a section that handles user consent and setting the cookie under the server block:\n\n    # Serve the consent banner page if consent is not given\n    location /consent {\n        default_type text/html;\n        return 200 \"<html><body>\n                        <h1>Consent Required</h1>\n                        <p>You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\n\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\n\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n\n-At any time, the USG may inspect and seize data stored on this IS.\n\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\n\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\n\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.</p>\n                        <a href='/set-consent'>I Accept</a>\n                    </body></html>\";\n    }\n\n    # Handle consent acceptance and set the cookie\n    location /set-consent {\n        add_header Set-Cookie \"user_consent=1; Path=/; Max-Age=31536000; HttpOnly\";\n        return 302 /;\n    }\n\n    location / {\n        # Redirect users to the consent page if they haven't given consent\n        if ($consent_given = 0) {\n                return 302 /consent;\n            }\n\nSave nginx.conf, test the config, and reload NGINX:\n\nnginx -t && nginx -s reload","checkText":"Note: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\n\nCheck nginx.conf for a section that verifies that user consent has been given. Setting a cookie upon user acceptance after reading the banner and checking for the presence of that cookie is one way to accomplish this.\n\nCheck for this block in nginx.conf under the http block:\n\n    # Define whether consent has been given based on the cookie\n    map $http_cookie $consent_given {\n        \"~*user_consent=1\" 1;\n        default 0;\n    }\n\nCheck nginx.conf for a section that handles user consent and setting the cookie under the server block:\n\n    # Serve the consent banner page if consent is not given\n    location /consent {\n        default_type text/html;\n        return 200 \"<html><body>\n                        <h1>Consent Required</h1>\n                        <p>You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\n\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\n\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n\n-At any time, the USG may inspect and seize data stored on this IS.\n\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\n\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\n\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.</p>\n                        <a href='/set-consent'>I Accept</a>\n                    </body></html>\";\n    }\n\n    # Handle consent acceptance and set the cookie\n    location /set-consent {\n        add_header Set-Cookie \"user_consent=1; Path=/; Max-Age=31536000; HttpOnly\";\n        return 302 /;\n    }\n\n    location / {\n        # Redirect users to the consent page if they haven't given consent\n        if ($consent_given = 0) {\n                return 302 /consent;\n            }\n\nIf NGINX is not configured to display the Standard Mandatory DOD Notice and Consent Banner before granting access to the application, this is a finding.","cciIds":["CCI-000048","CCI-000050","CCI-001384","CCI-001385","CCI-001386","CCI-001387","CCI-001388"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-278385r1171907_rule","stigId":"V-278385","groupId":"V-278385","title":"DPMS Target F5 NGINX","severity":"CAT II","description":"Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one. Audit records can be generated from various components within the application (e.g., process, module). Certain application functionalities may be audited as well. The list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system can generating audit records. DOD has defined the list of events for which NGINX will provide an audit record generation capability as the following: (i) Successful and unsuccessful attempts to access, modify, or delete privileges, security objects, security levels, or categories of information (e.g., classification levels); (ii) Access actions, such as successful and unsuccessful logon attempts, privileged activities or other system level access, starting and ending time for user access to the system, concurrent logons from different workstations, successful and unsuccessful accesses to objects, all program initiations, and all direct access to the information system; and (iii) All account creation, modification, disabling, and termination actions. Satisfies: SRG-APP-000089, SRG-APP-000080, SRG-APP-000091, SRG-APP-000095, SRG-APP-000096, SRG-APP-000097, SRG-APP-000098, SRG-APP-000099, SRG-APP-000100, SRG-APP-000374, SRG-APP-000375, SRG-APP-000492, SRG-APP-000493, SRG-APP-000494, SRG-APP-000495, SRG-APP-000496, SRG-APP-000497, SRG-APP-000498, SRG-APP-000499, SRG-APP-000500, SRG-APP-000501, SRG-APP-000502, SRG-APP-000507","fixText":"Determine the path to NGINX config file(s):\n\nnginx -qT | grep \"# configuration\"\n# configuration file /etc/nginx/nginx.conf:\n\nNote: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\n\nInclude the $server_name, $server_addr, $remote_addr, $remote_user, $time_local, $status, $request, $request_id, $http_user_agent, $http_x_forwarded_for, or any organization defined variable in any custom log_format directives.\n\nFor example:\n \n    log_format custom '$remote_addr - $remote_user [$time_local] \"$request\" '\n                      '$status $body_bytes_sent \"$http_referer\" '\n                      '\"$http_user_agent\" \"$http_x_forwarded_for\"';\n\nRestart NGINX:\n\nnginx -s reload","checkText":"Determine the path to NGINX config file(s):\n\nnginx -qT | grep \"# configuration\"\n# configuration file /etc/nginx/nginx.conf:\n\nNote: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\n\ncat <path to config>\n\nVerify that $server_name, $server_addr, $remote_addr, $remote_user, $time_local, $status, $request, $request_id, $http_user_agent, $http_x_forwarded_for, and/or any organization defined variables are included in any custom log_format directive.\n\nIf a custom log_format is defined and does not include a minimum of $server_name, $server_addr, $remote_addr, $remote_user, $time_local, $status, $request, $request_id, $http_user_agent, and $http_x_forwarded_for, this is a finding.","cciIds":["CCI-000169","CCI-000166","CCI-000172","CCI-000130","CCI-000131","CCI-000132","CCI-000133","CCI-000134","CCI-001487","CCI-001890","CCI-001889"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-278386r1171910_rule","stigId":"V-278386","groupId":"V-278386","title":"DPMS Target F5 NGINX","severity":"CAT II","description":"Without the capability to restrict which roles and individuals can select which events are audited, unauthorized personnel may be able to prevent the auditing of critical events. Misconfigured audits may degrade the system's performance by overwhelming the audit log. Misconfigured audits may also make it more difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one. The list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system can generating audit records.","fixText":"By default, nginx.conf has file permissions set to admins only. Performing the chmod command will set file permissions on nginx.conf.\n\n  sudo chmod 600 /etc/nginx/nginx.conf \n\nThis example command will set read/write permissions for the owner only.","checkText":"Check the current permissions of nginx.conf:\n\nls -l /etc/nginx/nginx.conf\n-rw-r--r-- 1 root root 0 May 23 15:04 /etc/nginx/nginx.conf\n\nIf file has write permissions for anyone other than the owner, this is a finding.","cciIds":["CCI-000171"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-278387r1172701_rule","stigId":"V-278387","groupId":"V-278387","title":"DPMS Target F5 NGINX","severity":"CAT II","description":"Decisions regarding the employment of mobile code within organizational information systems are based on the potential for the code to cause damage to the system if used maliciously. Mobile code is defined as software modules obtained from remote systems, transferred across a network, and then downloaded and executed on a local system without explicit installation or execution by the recipient. Actions enforced before executing mobile code include prompting users prior to opening email attachments and disabling automatic execution. Usage restrictions and implementation guidance apply to both the selection and using the mobile code installed, downloaded, or executed on all endpoints (e.g., servers, workstations, and smart phones). This requirement applies to applications that execute, evaluate, or otherwise process mobile code (e.g., web applications, browsers, and antivirus applications).","fixText":"Set permissions on directory containing external modules to read only for \"Other\" only.\n\nThe directory may be organizationally defined. The default path is /usr/lib/nginx/modules.\n\n# chmod o-wx /usr/lib/nginx/modules","checkText":"Check nginx.conf for external modules being loaded (grep load_module). \n\nIf additional modules are being loaded, confirm the directory does not include write or execute for other users.\n\nDetermine the path to nginx config file(s):\n\n# nginx -qT | grep \"# configuration\"\n# configuration file /etc/nginx/nginx.conf:\n\nNote: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\n\n# grep load_module /etc/nginx/nginx.conf\nload_module modules/ngx_http_app_protect_module.so;\n# ls -la /etc/nginx/modules\nlrwxrwxrwx 1 root root 22 Oct 10 2023 modules -> /usr/lib/nginx/modules\n# ls -la /usr/lib/nginx\ndrwxr-xr-x root root 4096 Jan 30 2024 modules\n\nIf directory where modules are loaded is writeable by other, this is a finding.","cciIds":["CCI-001695"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-278388r1171916_rule","stigId":"V-278388","groupId":"V-278388","title":"DPMS Target F5 NGINX","severity":"CAT II","description":"If audit data were to become compromised, then competent forensic analysis and discovery of the true source of potentially malicious system activity is difficult if not impossible to achieve. In addition, access to audit records provides information an attacker could potentially use to their advantage. To ensure the veracity of audit data, the information system and/or the application must protect audit information from any and all unauthorized access. This includes read, write, and copy access. This requirement can be achieved through multiple methods, which will depend upon system architecture and design. Commonly employed methods for protecting audit information include least privilege permissions as well as restricting the location and number of log file repositories. Additionally, applications with user interfaces to audit records must not allow for the unfettered manipulation of or access to those records via the application. If the application provides access to the audit data, the application becomes accountable for ensuring audit information is protected from unauthorized access. Audit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity. Satisfies: SRG-APP-000118, SRG-APP-000119, SRG-APP-000120, SRG-APP-000121, SRG-APP-000122, SRG-APP-000123, SRG-APP-000267","fixText":"Determine the path to NGINX config file(s):\n\nnginx -qT | grep \"# configuration\"\n# configuration file /etc/nginx/nginx.conf:\n\nNote: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\n\nDetermine the location of the access and error logs:\n\ngrep \"_log\" <path to config>\n\nSet appropriate permissions for the log files:\n\nchmod 644 <path to error.log>\nchmod 644 <path to access.log>","checkText":"Determine the path to NGINX config file(s):\n\nnginx -qT | grep \"# configuration\"\n# configuration file /etc/nginx/nginx.conf:\n\nNote: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\n\nDetermine the location of the access and error logs:\n\ngrep \"_log\" <path to config>\n\nDetermine the permissions for the log files:\n\nls -la <path to error.log>\n-rw-r--r-- 1 root root 0 May 23 15:04 /var/log/nginx/error.log\nls -la <path to access.log>\n-rw-r--r-- 1 root root 0 May 23 15:04 /var/log/nginx/access.log\n\nIf files have write permissions for anyone other than the owner, this is a finding.","cciIds":["CCI-000162","CCI-000163","CCI-000164","CCI-001493","CCI-001494","CCI-001495","CCI-001314"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-278389r1172704_rule","stigId":"V-278389","groupId":"V-278389","title":"DPMS Target F5 NGINX","severity":"CAT II","description":"Authenticity protection provides protection against man-in-the-middle attacks/session hijacking and the insertion of false information into sessions. Application communication sessions are protected using transport encryption protocols, such as TLS. TLS provides web applications with a means to be able to authenticate user sessions and encrypt application traffic. Session authentication can be single (one-way) or mutual (two-way) in nature. Single authentication authenticates the server for the client, whereas mutual authentication provides a means for both the client and the server to authenticate each other. This requirement applies to applications that use communications sessions. This includes, but is not limited to, web-based applications and service-oriented architectures (SOA). This requirement addresses communications protection at the application session, versus the network packet, and establishes grounds for confidence at both ends of communications sessions in ongoing identities of other parties and in the validity of information transmitted. Depending on the required degree of confidentiality and integrity, web services/SOA will require using TLS mutual authentication (two-way/bidirectional). Satisfies: SRG-APP-000142, SRG-APP-000141, SRG-APP-000383, SRG-APP-000645","fixText":"Edit the NGINX configuration file(s) and remove any unnecessary listen directives.\n\nOn listen directives that are organizationally defined to need TLS, ensure that the listen directive includes SSL and SSL redirection.\n\nAfter saving the configuration, reload NGINX:\n\n# nginx -s reload","checkText":"Determine the path to NGINX config file(s):\n\n# nginx -qT | grep \"# configuration\"\n# configuration file /etc/nginx/nginx.conf:\n\nNote: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\n\nReview the configurations looking for any listen directives.\n\nIf listen directives are enabled but unnecessary, this is a finding.\n\nVerify that listeners are using SSL and redirects to SSL-enabled listeners.\n\n# nginx -c <path to nginx config> -qT | grep -A5 listen\n    listen 192.168.0.254:80;\n    return 301 https://$host/$request_uri;\n    } \n\n`\n    listen 192.168.0.254:443 ssl default_server;\n    ...\n\nIf the listen directive does not include SSL and there is not a redirect to an SSL listener, this is a finding.","cciIds":["CCI-000382","CCI-000381","CCI-001762"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-278390r1172747_rule","stigId":"V-278390","groupId":"V-278390","title":"DPMS Target F5 NGINX","severity":"CAT II","description":"A replay attack may enable an unauthorized user to gain access to the application. Authentication sessions between the authenticator and the application validating the user credentials must not be vulnerable to a replay attack. Anti-replay is a cryptographically based mechanism; thus, it must use FIPS-approved algorithms. An authentication process resists replay attacks if it is impractical to achieve a successful authentication by recording and replaying a previous authentication message. Note that the anti-replay service is implicit when data contains monotonically increasing sequence numbers and data integrity is ensured. Using DOD PKI is inherently compliant with this requirement for user and device access. Using Transport Layer Security (TLS), including application protocols such as HTTPS and DNSSEC, is also compliant. Configure the information system to use the hash message authentication code (HMAC) algorithm for authentication services to Kerberos, SSH, web management tool, and any other access method.","fixText":"Implement a replay-resistant authentication method for any NGINX Plus resource that allows network access.\n\nOption A: JWT with expiration:\n\nConfigure NGINX to use JWT authentication:\n\nauth_jwt \"Protected\";\nauth_jwt_key_file /etc/nginx/keys/jwt_key.pub;\nauth_jwt_require exp iat;\n\nEnsure the token issuer includes a short-lived exp (e.g., less than five minutes) and iat claims.\n\nOption B: Mutual TLS:\n\nEnable client certificate authentication:\n\nssl_verify_client on;\nssl_client_certificate /etc/nginx/certs/client_ca.pem;","checkText":"Determine the path to NGINX config file(s):\n\nnginx -qT | grep \"# configuration\"\n# configuration file /etc/nginx/nginx.conf:\n\nNote: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\n\nIdentify authentication mechanism in use by checking whether NGINX is configured to protect access to administrative interfaces or APIs:\n\ngrep -Ri 'auth_' /etc/nginx/nginx.conf\ngrep -Ri 'proxy_pass' /etc/nginx/nginx.conf\ngrep -Ri 'ssl_verify_client' /etc/nginx/nginx.conf\n\nAlso inspect references to:\n\nauth_jwt\nauth_request\nssl_client_certificate\n\nIf JWT is in use, validate the config:\n\nauth_jwt_key_file /etc/nginx/jwt.pub;\nauth_jwt_require exp iat;\n\nEnsure the token includes expiration (exp) and ideally issued-at (iat) fields.\n\nIf using mutual TLS:\n\nssl_verify_client on;\nssl_client_certificate /etc/nginx/certs/ca.pem;\n\nEnsure client-side certificate verification is required and the certificate authority (CA) trust is defined.\n\nIf using auth_request:\n\nEnsure the upstream authentication server is enforcing replay resistance (such as nonce or short-lived tokens). Validate token behavior and session timeout logic.\n\nIf no replay-resistant mechanism is found for network-based access, this is a finding.","cciIds":["CCI-001941"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-278391r1171925_rule","stigId":"V-278391","groupId":"V-278391","title":"DPMS Target F5 NGINX","severity":"CAT II","description":"Without path validation, an informed trust decision by the relying party cannot be made when presented with any certificate not already explicitly trusted. To meet this requirement, the information system must create trusted channels between itself and remote trusted authorized IT product (e.g., syslog server) entities that protect the confidentiality and integrity of communications. The information system must create trusted paths between itself and remote administrators and users that protect the confidentiality and integrity of communications. A trust anchor is an authoritative entity represented via a public key and associated data. It is most often used in the context of public key infrastructures, X.509 digital certificates, and DNSSEC. However, applications that do not use a trusted path are not approved for nonlocal and remote management of DOD information systems. Use of SSHv2 to establish a trusted channel is approved. Use of FTP, TELNET, HTTP, and SNMPV1 is not approved since they violate the trusted channel rule set. Use of web management tools that are not validated by common criteria may also violate trusted channel rule set. When there is a chain of trust, usually the top entity to be trusted becomes the trust anchor; it can be, for example, a Certification Authority (CA). A certification path starts with the subject certificate and proceeds through a number of intermediate certificates up to a trusted root certificate, typically issued by a trusted CA. This requirement verifies that a certification path to an accepted trust anchor is used for certificate validation and that the path includes status information. Path validation is necessary for a relying party to make an informed trust decision when presented with any certificate not already explicitly trusted. Status information for certification paths includes certificate revocation lists or online certificate status protocol responses. Validation of the certificate status information is out of scope for this requirement. Satisfies: SRG-APP-000175, SRG-APP-000401","fixText":"If using OCSP for certificate revocation, this requirement is Not Applicable.\n\nDetermine path to NGINX config file:\n\n# nginx -qT | grep \"# configuration\"\n# configuration file /etc/nginx/nginx.conf:\n\nNote: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\n\n# cat <path to config>\n\nConfigure the following lines in the http { blocks using the example below.\n\nSet ssl_verify_client on.\nSet ssl_crl /etc/nginx/ssl/crl.pem to match the CRL file name.\n\nhttp {\n    server {\n        listen 443 ssl;\n        server_name example.com;\n\n        ssl_certificate /etc/nginx/ssl/server.crt;\n        ssl_certificate_key /etc/nginx/ssl/server.key;\n\n        ssl_client_certificate /etc/nginx/ssl/ca.crt;\n\n        ssl_verify_client on;\n\n        ssl_crl /etc/nginx/ssl/crl.pem;\n\n        ssl_ocsp on;\n        ssl_ocsp_responder http://ocsp.disa.mil;\n\nssl_stapling on;\nssl_stapling_verify on;\nssl_stapling_file /etc/nginx/ssl/ocsp_cache.pem;\nssl_stapling_responder_timeout 3s;  # Timeout for OCSP responder queries\nssl_stapling_responder_error_cache_time 300s;  # Cache time for responder errors\n\n        location / {\n            proxy_pass http://backend;\n        }\n    }\n}","checkText":"If using OCSP for certificate revocation, this requirement is Not Applicable.\n\nDetermine the path to NGINX config file:\n\n# nginx -qT | grep \"# configuration\"\n# configuration file /etc/nginx/nginx.conf:\n\nNote: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\n\n# cat <path to config>\n\nCheck the http { blocks for the following example:\n\nhttp {\n    server {\n        listen 443 ssl;\n        server_name example.com;\n\n        ssl_certificate /etc/nginx/ssl/server.crt;\n        ssl_certificate_key /etc/nginx/ssl/server.key;\n\n        ssl_client_certificate /etc/nginx/ssl/ca.crt;\n\n        ssl_verify_client on;\n\n        ssl_crl /etc/nginx/ssl/crl.pem;\n\n        ssl_ocsp on;\n        ssl_ocsp_responder http://ocsp.disa.mil;\n\nssl_stapling on;\nssl_stapling_verify on;\nssl_stapling_file /etc/nginx/ssl/ocsp_cache.pem;\nssl_stapling_responder_timeout 3s;  # Timeout for OCSP responder queries\nssl_stapling_responder_error_cache_time 300s;  # Cache time for responder errors\n\n        location / {\n            proxy_pass http://backend;\n        }\n    }\n}             \n\nCheck for certificate path validation. If \"ssl_verify_client on\" is not present in the configuration, this is a finding.\n\nCheck if a CRL file is configured. If \"ssl_crl <file>\" is not present in the configuration, this is a finding.","cciIds":["CCI-000185","CCI-004068"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-278392r1171928_rule","stigId":"V-278392","groupId":"V-278392","title":"DPMS Target F5 NGINX","severity":"CAT II","description":"If the private key is discovered, an attacker can use the key to authenticate as an authorized user and gain access to the network infrastructure. The cornerstone of the PKI is the private key used to encrypt or digitally sign information. If the private key is stolen, this will lead to the compromise of the authentication and nonrepudiation gained through PKI because the attacker can use the private key to digitally sign documents and pretend to be the authorized user. Both the holders of a digital certificate and the issuing authority must protect the computers, storage devices, or whatever they use to store private keys.","fixText":"Change permissions on any TLS keys used in NGINX configuration:\n\nnginx -qT | grep certificate_key\nchmod 600 <path to TLS key>\n\nExample:\n\nroot@e4a935153ece:/etc/ssl/nginx# nginx -qT | grep certificate_key\n    ssl_certificate_key /etc/ssl/nginx/server.key;\nroot@e4a935153ece:/etc/ssl/nginx# chmod 600 /etc/ssl/nginx/server.key\n\nRestart NGINX:\n\nnginx -s reload","checkText":"Determine the path to NGINX config file:\n\nnginx -qT | grep \"# configuration\"\n# configuration file /etc/nginx/nginx.conf:\n\nNote: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\n\ncat <path to config>\n\nVerify that private key(s) are only readable by the owner.\n\nExample:\n\nroot@e4a935153ece:/etc/ssl/nginx# nginx -qT | grep certificate_key\n    ssl_certificate_key /etc/ssl/nginx/server.key;\nroot@e4a935153ece:/etc/ssl/nginx# ls -la /etc/ssl/nginx/server.key\n-rw------- 1 root root 1704 Dec  4 18:31 /etc/ssl/nginx/server.key\n\nIf the private key(s) are readable anyone other than owner, this is a finding.","cciIds":["CCI-000186"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-278393r1171931_rule","stigId":"V-278393","groupId":"V-278393","title":"DPMS Target F5 NGINX","severity":"CAT II","description":"Decisions regarding the employment of mobile code within applications are based on the potential for the code to cause damage to the system if used maliciously. Mobile code is defined as software modules obtained from remote systems, transferred across a network, and then downloaded and executed on a local system without explicit installation or execution by the recipient. DOD has identified prohibited mobile code in DODI 8552.01 as: all Category 1X mobile code, unsigned Category 1A mobile code, Category 2 mobile code that violates usage requirements, all Emerging Technologies mobile code (all mobile code technologies, systems, platforms, or languages whose capabilities and threat level have not yet undergone a risk assessment and been assigned to a risk category), and all mobile code that downloads via an email body or email attachment that executes automatically when the user opens the email body or attachment. Usage restrictions and implementation guidance apply to both the selection and use of mobile code installed, downloaded, or executed on all endpoints (e.g., servers, workstations, and smart phones). This requirement applies to applications that execute, evaluate, or otherwise process mobile code (e.g., web applications, browsers, and antivirus applications). Satisfies: SRG-APP-000206, SRG-APP-000207, SRG-APP-000209, SRG-APP-000210","fixText":"Determine the path to NGINX config file(s):\n\n# nginx -qT | grep \"# configuration\"\n# configuration file /etc/nginx/nginx.conf:\n\nNote: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\n\nRemove any unnecessary or unpermitted modules from the configuration. \n\nAfter saving the configuration, reload NGINX:\n\n# nginx -s reload","checkText":"Determine the path to NGINX config file(s):\n\n# nginx -qT | grep \"# configuration\"\n# configuration file /etc/nginx/nginx.conf:\n\nNote: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\n\n# grep load_module /etc/nginx/nginx.conf\nload_module modules/ngx_http_app_protect_module.so;\n\nIf modules are loaded that are not required or known, this is a finding.","cciIds":["CCI-001166","CCI-001662","CCI-001169","CCI-001170"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-278394r1171934_rule","stigId":"V-278394","groupId":"V-278394","title":"DPMS Target F5 NGINX","severity":"CAT II","description":"DoS is a condition in which a resource is not available for legitimate users. When this occurs, the organization either cannot accomplish its mission or must operate at degraded capacity. Individuals of concern can include hostile insiders or external adversaries that have successfully breached the information system and are using the system as a platform to launch cyberattacks on third parties. Applications and application developers must take the steps needed to ensure users cannot use an authorized application to launch DoS attacks against other systems and networks. For example, applications may include mechanisms that throttle network traffic so users are not able to generate unlimited network traffic via the application. Limiting system resources allocated to any user to a bare minimum may also reduce the ability of users to launch some DoS attacks. The methods employed to counter this risk will be dependent upon the application layer methods that can be used to exploit it.","fixText":"Determine the path to NGINX config file(s):\n\n# nginx -qT | grep \"# configuration\"\n# configuration file /etc/nginx/nginx.conf:\n\nNote: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\n\nAdd or modify the client_body_timeout, client_header_timeout and send_timeout directives to have a value of 10 seconds or lower. Setting this value in the http context will cover everything unless overridden in subsequent server or location contexts.\n\n    client_body_timeout 10s;\n    client_header_timeout 10s;\n    send_timeout 10s;\n\nAfter saving the configuration, reload NGINX:\n\n# nginx -s reload","checkText":"Determine the path to NGINX config file(s):\n\n# nginx -qT | grep \"# configuration\"\n# configuration file /etc/nginx/nginx.conf:\n\nNote: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\n\nVerify timeouts and send timeouts exist in config file and the timeout value of 10 seconds (or less) has been configured for client headers and body. \n\nnginx -c <path to nginx config> -qT | grep timeout\n    client_body_timeout 10s;\n    client_header_timeout 10s;\n    send_timeout 10s;\n\nIf the client_header_timeout, client_body_timeout and send_timeout are unset or have values greater than 10, this is a finding.","cciIds":["CCI-001094"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-278395r1172748_rule","stigId":"V-278395","groupId":"V-278395","title":"DPMS Target F5 NGINX","severity":"CAT II","description":"Any application providing too much information in error messages risks compromising the data and security of the application and system. The structure and content of error messages must be carefully considered by the organization and development team. Organizations carefully consider the structure/content of error messages. The extent to which information systems are able to identify and handle error conditions is guided by organizational policy and operational requirements. Information that could be exploited by adversaries includes, for example, erroneous logon attempts with passwords entered by mistake such as the username, mission/business information that can be derived from (if not stated explicitly by) information recorded, and personal information, such as account numbers, social security numbers, and credit card numbers.","fixText":"Determine the path to NGINX config file(s):\n\n# nginx -qT | grep \"# configuration\"\n# configuration file /etc/nginx/nginx.conf:\n\nNote: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\n\nAdd or modify the \"server_tokens\" directive to set to \"off\" or set to a custom string without the version information.\n\nhttp {\nserver_tokens off;\n...\n}\n\nRestart nginx after modifying the configuration:\n\n# nginx -s reload","checkText":"Determine the path to NGINX config file(s):\n\n# nginx -qT | grep \"# configuration\"\n# configuration file /etc/nginx/nginx.conf:\n\nNote: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\n\nVerify that the \"server_tokens\" directive is present, is not set to \"on\", and is not set to a custom string that identifies version information.\n\nnginx -c <path to nginx config> -qT | grep server_tokens\n    server_tokens off;\n\nIf the \"server_tokens\" directive is missing, this is a finding.\n\nIf the \"server_tokens\" directive is set to \"on\", this is a finding.\n\nIf the \"server_tokens\" directive includes the version number, this is a finding.","cciIds":["CCI-001312"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-278396r1172699_rule","stigId":"V-278396","groupId":"V-278396","title":"DPMS Target F5 NGINX","severity":"CAT I","description":"Information stored in one location is vulnerable to accidental or incidental deletion or alteration. Off-loading is a common process in information systems with limited audit storage capacity. Satisfies: SRG-APP-000358, SRG-APP-000125, SRG-APP-000515","fixText":"Determine the path to NGINX config file(s):\n\n# nginx -qT | grep \"# configuration\"\n# configuration file /etc/nginx/nginx.conf:\n\nNote: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\n\nInclude the \"syslog:server= prefix\" (which can be a domain name, an IP address, or a UNIX-domain socket path. A domain name or IP address can be specified with a port to override the default port, 514. A UNIX-domain socket path can be specified after the unix: prefix:) in any log directives and configure the optional parameters (facility, tag, severity).\n\nAfter saving the configuration, reload NGINX:\n\n# nginx -s reload","checkText":"Determine the path to NGINX config file(s):\n\n# nginx -qT | grep \"# configuration\"\n# configuration file /etc/nginx/nginx.conf:\n\nNote: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\n\nVerify that \"syslog:server= prefix\" is included in any log directive:\n\n# cat <path to config>\n\nFind the \"error_log: or \"access_log\" directives and verify the syslog:server= prefix is included.\n\nIf \"error_log\" or \"access_log\" exists and does not include \"syslog:server=\", this is a finding.","cciIds":["CCI-001851","CCI-001348"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-278397r1171943_rule","stigId":"V-278397","groupId":"V-278397","title":"DPMS Target F5 NGINX","severity":"CAT II","description":"Failure to provide logical access restrictions associated with changes to application configuration may have significant effects on the overall security of the system. When dealing with access restrictions pertaining to change control, it must be noted that any changes to the hardware, software, and/or firmware components of the information system and/or application can potentially have significant effects on the overall security of the system. Accordingly, only qualified and authorized individuals must be allowed to obtain access to application components for the purposes of initiating changes, including upgrades and modifications. Logical access restrictions include, for example, controls that restrict access to workflow automation, media libraries, abstract layers (e.g., changes implemented into third-party interfaces rather than directly into information systems), and change windows (e.g., changes occur only during specified times, making unauthorized changes easy to discover). Satisfies: SRG-APP-000380, SRG-APP-000381","fixText":"Determine the path to NGINX config file(s):\n\nnginx -qT | grep \"# configuration\"\n# configuration file /etc/nginx/nginx.conf:\n\nNote: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\n\nEnsure permissions on the configuration directory do not allow write permissions for \"Other\":\n\n# chmod o-w /etc/nginx","checkText":"Determine the path to NGINX config file(s):\n\nnginx -qT | grep \"# configuration\"\n# configuration file /etc/nginx/nginx.conf:\n\nNote: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\n\nCheck the permissions on the directory:\n\n# ls -la /etc\ndrwxr-x-r-x 3 root root 4096 Sep 16 18:28 nginx\n\nIf permissions to write are allowed for \"Other\", this is a finding.","cciIds":["CCI-001813","CCI-003938"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-278398r1171946_rule","stigId":"V-278398","groupId":"V-278398","title":"DPMS Target F5 NGINX","severity":"CAT II","description":"Using an allowlist provides a configuration management method for allowing the execution of only authorized software. Using only authorized software decreases risk by limiting the number of potential vulnerabilities. The organization must identify authorized software programs and permit execution of authorized software. The process used to identify software programs that are authorized to execute on organizational information systems is commonly referred to as allowlisting. Verification of allowlisted software can occur either prior to execution or at system startup. This requirement applies to configuration management applications or similar types of applications designed to manage system processes and configurations (e.g., ESS and software wrappers). Satisfies: SRG-APP-000386, SRG-APP-000384","fixText":"Determine the path to NGINX config file(s):\n\n# nginx -qT | grep \"# configuration\"\n# configuration file /etc/nginx/nginx.conf:\n\nNote: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\n\nSet allow/deny according to organizational policy.\n\nRestart NGINX after modifying the configuration.\n\n# nginx -s reload","checkText":"Determine the path to NGINX config file(s):\n\n# nginx -qT | grep \"# configuration\"\n# configuration file /etc/nginx/nginx.conf:\n\nNote: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\n\nVerify allow/deny is set according to organizational policy:\n\nlocation / {\n  allow 192.168.0.0;\n  allow 10.0.0.0/16;\n  deny all;\n}\n\nIf allow or deny is not set to organizational policy, this is a finding.","cciIds":["CCI-001774","CCI-001764"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-278399r1172775_rule","stigId":"V-278399","groupId":"V-278399","title":"DPMS Target F5 NGINX","severity":"CAT II","description":"Without reauthentication, users may access resources or perform tasks for which they do not have authorization. When applications provide the capability to change security roles or escalate the functional capability of the application, it is critical the user reauthenticate. In addition to the reauthentication requirements associated with session locks, organizations may require reauthentication of individuals and/or devices in other situations, including (but not limited to) the following circumstances. (i) When authenticators change; (ii) When roles change; (iii) When security categories of information systems change; (iv) When the execution of privileged functions occurs; (v) After a fixed period of time; or (vi) Periodically. Within the DOD, the minimum circumstances requiring reauthentication are privilege escalation and role changes.","fixText":"Set the ssl_session_timeout directive to 15 or less.\n\nNote: The default setting is five minutes and meets the control, but this STIG explicitly sets the variable to not rely on a default which may change in future versions.","checkText":"Determine the path to NGINX config file(s):\r\n\r\nnginx -qT | grep \"# configuration\"\r\n# configuration file /etc/nginx/nginx.conf:\r\n\r\nNote: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\r\n\r\nExamine the SSL configuration settings:\r\n\r\ngrep -R 'ssl_' /etc/nginx/nginx.conf\r\n\r\nVerify that \"ssl_session_timeout\" is not set to greater than 15.\r\n\r\nIf \"ssl_session_timeout\" directive is missing or set to greater than 15, this is a finding.","cciIds":["CCI-002038"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-278400r1172752_rule","stigId":"V-278400","groupId":"V-278400","title":"DPMS Target F5 NGINX","severity":"CAT II","description":"Using PIV credentials facilitates standardization and reduces the risk of unauthorized access. DOD has mandated using the CAC to support identity management and personal authentication for systems covered under HSPD 12, as well as a primary component of layered protection for national security systems. Satisfies: SRG-APP-000391, SRG-APP-000392, SRG-APP-000402, SRG-APP-000403","fixText":"NGINX installs OpenSSL by default. If not installed, follow the OS documentation.\n\nInclude the following lines in the server {} block of nginx.conf:\n\n ssl_certificate /etc/nginx/ssl/server_cert.pem;\n ssl_certificate_key /etc/nginx/ssl/server_key.pem;\n # Enable client certificate verification\n ssl_client_certificate /etc/nginx/ca_cert.pem;\n ssl_verify_client on;\n # Optional: Set verification depth for client certificates\n ssl_verify_depth 2;\n location / {\n  proxy_pass http://backend_service;\n  # Restrict access to valid PIV credentials\n  if ($ssl_client_verify != SUCCESS) {\n   return 403;\n  }\n }\n\nSave and exit. Restart NGINX after modifying the configuration:\n\n# nginx -s reload","checkText":"Determine path to NGINX config file:\n\n# nginx -qT | grep \"# configuration\"\n# configuration file /etc/nginx/nginx.conf:\n\nNote: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\n\nCheck that the nginx.conf file has the SSL Certificate/Key installed, the SSL Client Certificate is present, and SSL Verify is configured.\n\nserver {\n listen 443 ssl;\n server_name example.com;\n ssl_certificate /etc/nginx/ssl/server_cert.pem;\n ssl_certificate_key /etc/nginx/ssl/server_key.pem;\n # Enable client certificate verification\n ssl_client_certificate /etc/nginx/ca_cert.pem;\n ssl_verify_client on;\n # Optional: Set verification depth for client certificates\n ssl_verify_depth 2;\n location / {\n  proxy_pass http://backend_service;\n  # Restrict access to valid PIV credentials\n  if ($ssl_client_verify != SUCCESS) {\n   return 403;\n   }\n  }\n }\n\nIf the certificates are not configured and ssl_verify is not enabled, this is a finding.","cciIds":["CCI-001953","CCI-001954","CCI-002009","CCI-002010"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-278401r1171955_rule","stigId":"V-278401","groupId":"V-278401","title":"DPMS Target F5 NGINX","severity":"CAT II","description":"If cached authentication information is out of date, the validity of the authentication information may be questionable.","fixText":"Determine path to NGINX config file:\n\n# nginx -qT | grep \"# configuration\"\n# configuration file /etc/nginx/nginx.conf:\n\nNote: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\n\nEdit the config and set a timeout on any keyval storing credentials:\n\nkeyval_zone zone=oidc_access_tokens:1M state=/var/lib/nginx/state/oidc_access_tokens.json timeout=1h;\n\nRestart NGINX:\n\nnginx -s reload","checkText":"If a keyval store is not used to store tokens, this is not applicable.\n\nDetermine path to NGINX config file:\n\n# nginx -qT | grep \"# configuration\"\n# configuration file /etc/nginx/nginx.conf:\n\nNote: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\n\nDetermine if a keyval store is used and no timeout is specified:\n\ngrep keyval <location of config>\n\nExample:\n\nkeyval_zone zone=oidc_access_tokens:1M state=/var/lib/nginx/state/oidc_access_tokens.json timeout=1h;\n\nIf a timeout is not specified to an organization defined timeout value, this is a finding.","cciIds":["CCI-002007"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-278402r1171958_rule","stigId":"V-278402","groupId":"V-278402","title":"DPMS Target F5 NGINX","severity":"CAT II","description":"If security attributes are not associated with the information being transmitted between components, then access control policies and information flows that depend on these security attributes will not function and unauthorized access may result. Security attributes are values associated with data content/structure and source/destination objects. These attributes are bound to the user and data objects and may include information about the data's purpose, creator, origin, access restrictions, access permissions, or classification. Specific security attributes used depend on the application or technology context. However, these attributes are used in information systems to implement security policy for access control and flow control for users, data, and traffic. Security attributes may be explicitly or implicitly associated with the information contained within the information system. This requirement applies to those applications that transmit or receive data between components. Information system components include, for example, mainframes, workstations, servers (e.g., database, email, authentication, web, proxy, file, domain name), input/output devices (e.g., scanners, copiers, printers), network components (e.g., firewalls, routers, gateways, voice and data switches, process controllers, wireless access points, network appliances, sensors), operating systems, virtual machines, middleware, and applications.","fixText":"Determine the path to NGINX config file(s):\n\nnginx -qT | grep \"# configuration\"\n# configuration file /etc/nginx/nginx.conf:\n\nNote: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\n\nInclude the \"proxy_pass\" service as well as the \"proxy_set_header\" values as required:\n\n proxy_pass http://backend_service;\n\n        proxy_set_header X-Security-Classification \"Confidential\";\n        proxy_set_header X-Data-Origin \"Internal-System\";\n        proxy_set_header X-Access-Permissions \"Read,Write\";\n\nAfter saving the configuration, reload NGINX:\n\n# nginx -s reload","checkText":"Determine the path to NGINX config file(s):\n\nnginx -qT | grep \"# configuration\"\n# configuration file /etc/nginx/nginx.conf:\n\nNote: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\n\nVerify the embedded security attributes are present as HTTP Headers:\n\nserver {\n    listen 443 ssl;\n    server_name secure-api.example.com;\n\n    location /data {\n        proxy_pass http://backend_service;\n\n        proxy_set_header X-Security-Classification \"Confidential\";\n        proxy_set_header X-Data-Origin \"Internal-System\";\n        proxy_set_header X-Access-Permissions \"Read,Write\";\n    }\n}\nIf the \"proxy_pass\" variable is not set nor the \"proxy_set_header\" is not set for the required headers, this is a finding.","cciIds":["CCI-002455"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-278403r1171961_rule","stigId":"V-278403","groupId":"V-278403","title":"DPMS Target F5 NGINX","severity":"CAT II","description":"Untrusted Certificate Authorities (CA) can issue certificates, but they may be issued by organizations or individuals that seek to compromise DOD systems or by organizations with insufficient security controls. If the CA used for verifying the certificate is not a DOD-approved CA, trust of this CA has not been established. The DOD will only accept PKI certificates obtained from a DOD-approved internal or external certificate authority. Reliance on CAs for the establishment of secure sessions includes, for example, using TLS certificates. This requirement focuses on communications protection for the application session rather than for the network packet. This requirement applies to applications that use communications sessions. This includes, but is not limited to, web-based applications and service-oriented architectures (SOAs). Satisfies: SRG-APP-000427, SRG-APP-000177, SRG-APP-000910","fixText":"Replace any non-DOD issued certificates with DOD-issued certificates.\n\nAfter replacing the certificates, reload NGINX:\n\n# nginx -s reload","checkText":"Determine the path to NGINX config file(s):\n\n# nginx -qT | grep \"# configuration\"\n# configuration file /etc/nginx/nginx.conf:\n\nNote: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\n\nFind any \"ssl_certificate\" ssl_client_certificate\" directives and verify they are DOD approved.\n\nIf the certificates are not DOD approved, this is a finding.","cciIds":["CCI-002470","CCI-000187","CCI-004909"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-278404r1171964_rule","stigId":"V-278404","groupId":"V-278404","title":"DPMS Target F5 NGINX","severity":"CAT II","description":"DoS is a condition when a resource is not available for legitimate users. When this occurs, the organization either cannot accomplish its mission or must operate at degraded capacity. This requirement addresses the configuration of applications to mitigate the impact of DoS attacks that have occurred or are ongoing on application availability. For each application, known and potential DoS attacks must be identified and solutions for each type implemented. A variety of technologies exist to limit or, in some cases, eliminate the effects of DoS attacks (e.g., limiting processes or restricting the number of sessions the application opens at one time). Employing increased capacity and bandwidth, combined with service redundancy, may reduce the susceptibility to some DoS attacks. Satisfies: SRG-APP-000435, SRG-APP-000247","fixText":"Define a connection limiting zone. \n\nOpen the NGINX configuration file in a text editor:\n\nsudo nano /etc/nginx/nginx.conf\n\nEstablish a shared memory zone to track and limit connections from each client.\n\nAdd this directive above the server block in the nginx.conf:\n\nlimit_conn_zone $binary_remote_addr zone=conn_limit_zone:10m;\n\n$binary_remote_addr: Uses the client's IP address for limiting.\n\nzone=conn_limit_zone:10m: Allocates 10MB of memory for tracking connections. Adjust size based on your needs.\n\nApply connection limiting in the server block. \n\nNow, apply connection limiting to the desired location block. Inside the location block, add the connection limiting directive:\n\nnginx\nCopy code\nserver {\n    location / {\n        limit_req zone=one burst=20 nodelay;\n        limit_conn conn_limit_zone 10;\n        proxy_pass http://backend;\n    }\n}\nlimit_conn conn_limit_zone 10: Limits the client to 10 concurrent connections.\n\nSave and exit the file. Restart NGINX:\n\n# nginx -s reload","checkText":"Check for the \"limit_req\" or \"limit_conn\" directives in the NGINX configuration files:\n\ngrep -R \"limit_req\\|limit_conn\" /etc/nginx/\n\nDetermine if NGINX App Protect is enabled:\n\ngrep -R \"app_protect_enable on\" /etc/nginx/\n\nIf the \"lmit_req\" or \"limit connections\" are not present, this is a finding.","cciIds":["CCI-002385","CCI-001095"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-278405r1171967_rule","stigId":"V-278405","groupId":"V-278405","title":"DPMS Target F5 NGINX","severity":"CAT II","description":"Without protection of the transmitted information, confidentiality and integrity may be compromised since unprotected communications can be intercepted and either read or altered. This requirement applies only to those applications that are either distributed or can allow access to data nonlocally. Use of this requirement will be limited to situations where the data owner has a strict requirement for ensuring data integrity and confidentiality is maintained at every step of the data transfer and handling process. When transmitting data, applications need to leverage transmission protection mechanisms, such as TLS, TLS VPNs, or IPsec. Communication paths outside the physical protection of a controlled boundary are exposed to the possibility of interception and modification. Protecting the confidentiality and integrity of organizational information can be accomplished by physical means (e.g., employing physical distribution systems) or by logical means (e.g., employing cryptographic techniques). If physical means of protection are employed, then logical means (cryptography) do not have to be employed, and vice versa. Satisfies: SRG-APP-000439, SRG-APP-000156, SRG-APP-000219, SRG-APP-000231, SRG-APP-000395, SRG-APP-000440, SRG-APP-000441, SRG-APP-000442, SRG-APP-000514, SRG-APP-000555, SRG-APP-000620","fixText":"Restrict TLS versions to FIPS-approved protocols:\n\nssl_protocols TLSv1.2 TLSv1.3;\n\nConfigure only FIPS compliant ciphers:\n\nssl_ciphers 'TLS_AES_256_GCM_SHA384:TLS_AES_128_GCM_SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256';\n\nDo not allow clients to select the ciphers:\n\nssl_prefer_server_ciphers on;\n\nRestart NGINX to apply changes:\n\nsudo nginx -t && sudo systemctl reload nginx","checkText":"Determine the path to NGINX config file(s):\n\nnginx -qT | grep \"# configuration\"\n# configuration file /etc/nginx/nginx.conf:\n\nNote: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\n\nExamine the SSL configuration settings:\n\ngrep -R 'ssl_' /etc/nginx/nginx.conf\n\nVerify TLS versions:\n\nssl_protocols TLSv1.2 TLSv1.3;\n\nVerify cipher suites:\n\nssl_ciphers 'TLS_AES_256_GCM_SHA384:TLS_AES_128_GCM_SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256';\nssl_prefer_server_ciphers on;\n\nNote: The cipher list can be more restrictive if defined by the organization.\n\nIf non-FIPS ciphers or weak protocols (e.g., TLSv1.0/1.1, RC4, MD5, 3DES) are present, this is a finding.","cciIds":["CCI-002418","CCI-001941","CCI-001184","CCI-001199","CCI-001967","CCI-002421","CCI-002420","CCI-002422","CCI-002450","CCI-003123"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-278406r1171970_rule","stigId":"V-278406","groupId":"V-278406","title":"DPMS Target F5 NGINX","severity":"CAT II","description":"A certificate's certification path is the path from the end entity certificate to a trusted root certification authority (CA). Certification path validation is necessary for a relying party to make an informed decision regarding acceptance of an end entity certificate. Certification path validation includes checks such as certificate issuer trust, time validity, and revocation status for each certificate in the certification path. Revocation status information for CA and subject certificates in a certification path is commonly provided via certificate revocation lists (CRLs) or OCSP responses. Satisfies: SRG-APP-000605, SRG-APP-000875","fixText":"Edit the NGINX configuration file.\n\nSet \"ssl_verify_client on\", \"ssl_ocsp on\", ssl_stapling_verify on\", and \"ssl_stapling on\" as shown in the example below.\n\nCreate a local cache for OCSP responses:\n\ntouch /etc/nginx/ssl/ocsp_cache.pem \nchmod 600 /etc/nginx/ssl/ocsp_cache.pem\n\nSet the \"ssl_stapling_file\" directive with the file created as shown in the example below.\n\nhttp {\n    server {\n        listen 443 ssl;\n        server_name example.com;\n\n        ssl_certificate /etc/nginx/ssl/server.crt;\n        ssl_certificate_key /etc/nginx/ssl/server.key;\n\n        ssl_client_certificate /etc/nginx/ssl/ca.crt;\n\n        ssl_verify_client on;\n\n        ssl_crl /etc/nginx/ssl/crl.pem;\n\n        ssl_ocsp on;\n        ssl_ocsp_responder https://ocsp.disa.mil;\n\nssl_stapling on;\nssl_stapling_verify on;\nssl_stapling_file /etc/nginx/ssl/ocsp_cache.pem;\nssl_stapling_responder_timeout 3s;  # Timeout for OCSP responder queries\nssl_stapling_responder_error_cache_time 300s;  # Cache time for responder errors\n\n        location / {\n            proxy_pass http://backend;\n        }\n    }\n}","checkText":"If using CRL for certificate revocation, this requirement is Not Applicable.\n\nDetermine the path to NGINX config file(s):\n\n# nginx -qT | grep \"# configuration\"\n# configuration file /etc/nginx/nginx.conf:\n\nNote: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\n\n# cat <path to config>\n\nCheck the http { blocks for the following example:\n\nhttp {\n    server {\n        listen 443 ssl;\n        server_name example.com;\n\n        ssl_certificate /etc/nginx/ssl/server.crt;\n        ssl_certificate_key /etc/nginx/ssl/server.key;\n\n        ssl_client_certificate /etc/nginx/ssl/ca.crt;\n\n        ssl_verify_client on;\n\n        ssl_crl /etc/nginx/ssl/crl.pem;\n\n        ssl_ocsp on;\n        ssl_ocsp_responder http://ocsp.disa.mil;\n\nssl_stapling on;\nssl_stapling_verify on;\nssl_stapling_file /etc/nginx/ssl/ocsp_cache.pem;\nssl_stapling_responder_timeout 3s;  # Timeout for OCSP responder queries\nssl_stapling_responder_error_cache_time 300s;  # Cache time for responder errors\n\n        location / {\n            proxy_pass http://backend;\n        }\n    }\n}             \n\nCheck for certificate path validation. If \"ssl_verify_client on\" is not in the configuration, this is a finding.\n\nCheck if OCSP is enabled. If \"ssl_ocsp on\" is not in the configuration, this is a finding.\n\nCheck if OCSP Stapling is configured. If \"ssl_stapling on\" or \"ssl_stapling_verify on\" is not in the configuration, this is a finding.\n\nIf \"ssl_stapling_file <file>\" is not present in the configuration, this is a finding.","cciIds":["CCI-000185","CCI-004068"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-278407r1172754_rule","stigId":"V-278407","groupId":"V-278407","title":"DPMS Target F5 NGINX","severity":"CAT II","description":"FIPS 140-2/140-3 precludes using invalidated cryptography for the cryptographic protection of sensitive or valuable data within federal systems. Unvalidated cryptography is viewed by NIST as providing no protection to the information or data. In effect, the data would be considered unprotected plaintext. If the agency specifies that the information or data be cryptographically protected, then FIPS 140-2/140-3 is applicable. In essence, if cryptography is required, it must be validated. Cryptographic modules that have been approved for classified use may be used in lieu of modules that have been validated against the FIPS 140-2/140-3 standard. The cryptographic module used must have at least one validated digital signature function. This validated hash algorithm must be used to generate digital signatures for all cryptographic security function within the product being evaluated. Satisfies: SRG-APP-000630, SRG-APP-000635","fixText":"FIPS must be enabled on the operating system.\n\nFollow the OS guidelines for installing FIPS mode.\n\nAfter installation, confirm that FIPS is enabled:\n\n# sudo sysctl a | grep fips\ncrypto.fips_enabled = 1\n\nInstall the FIPS-validated version of OpenSSL to the operating system.","checkText":"Verify NGINX is using OpenSSL with FIPS enabled.\n\nFor version 1.x:\n\n# nginx -V\n\nnginx version: nginx/1.15.2 (nginx-plus-r16)\nbuilt by gcc 4.8.5 20150623 (Red Hat 4.8.5-16) (GCC)\nbuilt with OpenSSL 1.0.2k-fips  26 Jan 2017\"\n\nIf the response does not include \"fips\" in the OpenSSL version, this is a finding.\n\nFor version 3.x:\n\n# openssl list -providers\n\n Providers:\n  base\n    name: OpenSSL Base Provider\n    version: 3.2.2\n    status: active\n  default\n    name: OpenSSL Default Provider\n    version: 3.2.2\n    status: active\n  fips\n    name: Red Hat Enterprise Linux 9 - OpenSSL FIPS Provider\n    version: 3.2.2-622cc79c634cbbef\n    status: active\n\nIf the response does not list a FIPS provider with a status of \"active\", this is a finding.","cciIds":["CCI-002450"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-278408r1171976_rule","stigId":"V-278408","groupId":"V-278408","title":"DPMS Target F5 NGINX","severity":"CAT II","description":"Password-based authentication applies to passwords regardless of whether they are used in single-factor or multifactor authentication. Long passwords or passphrases are preferable over shorter passwords. Enforced composition rules provide marginal security benefits while decreasing usability. However, organizations may choose to establish certain rules for password generation (e.g., minimum character length for long passwords) under certain circumstances and can enforce this requirement in IA-5(1)(h). Account recovery can occur, for example, in situations when a password is forgotten. Cryptographically protected passwords include salted one-way cryptographic hashes of passwords. The list of commonly used, compromised, or expected passwords includes passwords obtained from previous breach corpuses, dictionary words, and repetitive or sequential characters. The list includes context-specific words, such as the name of the service, username, and derivatives thereof.","fixText":"Lock the password for the NGINX user (if not already locked):\n\nsudo passwd -l nginx","checkText":"Determine path to NGINX config file(s):\n\nnginx -qT | grep \"# configuration\"\n# configuration file /etc/nginx/nginx.conf:\n\nNote: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\n\nIdentify the NGINX runtime user:\n\ngrep -E '^\\s*user\\s+' /etc/nginx/nginx.conf\n\nExpected output (example):\n\nuser nginx;\n\nConfirm the password is locked:\n\npasswd -S nginx\n\nExpected output (example):\n\nnginx LK 2025-05-21 -1 -1 -1 -1 (Password locked.)\n\nIf the NGINX runtime user account is not locked for password changes, this is a finding.","cciIds":["CCI-004066"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-278409r1171979_rule","stigId":"V-278409","groupId":"V-278409","title":"DPMS Target F5 NGINX","severity":"CAT II","description":"Nonlocal maintenance and diagnostic activities are conducted by individuals who communicate through either an external or internal network. Communications paths can be logically separated using encryption. Satisfies: SRG-APP-000880, SRG-APP-000039","fixText":"Configure the API directive to use a separate listen address from production traffic:\n\nhttp {\n    server {\n        listen 192.168.0.1:80;\n        location / {\n            proxy_pass http://backend;\n        }\n    }\n    server {\n        listen 10.0.0.1:80;\n        location /api {\n            api write=on;\n        }\n    }\n}             \n\nAfter saving the updated config, restart NGINX: \n\nnginx -s reload.","checkText":"If not using the NGINX API, this is Not Applicable.\n\nDetermine path to NGINX config file:\n\n# nginx -qT | grep \"# configuration\"\n# configuration file /etc/nginx/nginx.conf:\n\nNote: The default NGINX configuration is \"/etc/nginx/nginx.conf\", though various files may also be included.\n\nCheck that the nginx.conf file contains the API directive and a separate listen address:\n\nhttp {\n    server {\n        listen 192.168.0.1:80;\n        location / {\n            proxy_pass http://backend;\n        }\n        location /api {\n            api write=on;\n        }\n    }\n}             \n\nIf the API is running on the same network as production traffic, this is a finding.","cciIds":["CCI-004192","CCI-001414"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-278410r1172694_rule","stigId":"V-278410","groupId":"V-278410","title":"DPMS Target F5 NGINX","severity":"CAT II","description":"Identity assertions and access tokens are typically digitally signed. The private keys used to sign these assertions and tokens are protected commensurate with the impact of the system and information resources that can be accessed. Satisfies: SRG-APP-000965, SRG-APP-000970","fixText":"Set proper file permissions for SSL certificate and private key:\n\n# chmod 644 /home/ubuntu/nginx.com.crt\n# chmod 600 /home/ubuntu/nginx.com.key\n# chown nginx:nginx /home/ubuntu/nginx.com.crt\n# chown nginx:nginx /home/ubuntu/nginx.com.key\n\nMove certificates to secure location:\n\n# mkdir -p /etc/nginx/ssl\n# mv /home/ubuntu/dev.sports.com.* /etc/nginx/ssl/\n# chmod 700 /etc/nginx/ssl\n\nUpdate NGINX configuration to use secure certificate location:\n\nserver {\n    listen 443 ssl;\n    ssl_certificate     /etc/nginx/ssl/nginx.com.crt;\n    ssl_certificate_key /etc/nginx/ssl/nginx.com.key;\n    ssl_session_cache shared:SSL:10m;\n    ssl_dhparam /etc/nginx/ssl/dhparam.pem;\n}\n\nGenerate strong DH parameters if not present:\n\n# openssl dhparam -out /etc/nginx/ssl/dhparam.pem 2048\n# chmod 644 /etc/nginx/ssl/dhparam.pem","checkText":"Check SSL/TLS certificate and private key file permissions:\n\n# ls -la /home/ubuntu/nginx.com.crt\n# ls -la /home/ubuntu/nginx.com.key\n\nVerify:\n- Certificate file permissions are 644 or more restrictive.\n- Private key file permissions are 600 or more restrictive.\n- Files are owned by nginx user or root.\n- Files are not world-readable or group-writable.\n\nIf these permissions are not set, this is a finding.\n\nVerify certificate validity and strength:\n\n# openssl x509 -in /home/ubuntu/nginx.com.crt -text -noout\n\nVerify:\n- Certificate is not expired.\n- Uses RSA key length of 2048 bits minimum or ECDSA P-256 minimum.\n- Signature algorithm is SHA-256 or stronger (not SHA-1 or MD5).\n- Certificate chain is complete and valid.\n\nIf these values are not met, this is a finding.\n\nVerify private key strength and protection:\n\n# openssl rsa -in /home/ubuntu/nginx.com.key -text -noout -check\n\nVerify:\n- Key length is 2048 bits minimum.\n- Key is not encrypted with weak algorithms.\n- Key passes integrity check.\n\nIf these key values are not set, this is a finding.","cciIds":["CCI-005156","CCI-000366","CCI-005157"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-278411r1172756_rule","stigId":"V-278411","groupId":"V-278411","title":"DPMS Target F5 NGINX","severity":"CAT II","description":"An access token is a piece of data that represents the authorization granted to a user or NPE to access specific systems or information resources. Access tokens enable controlled access to services and resources. Properly managing the lifecycle of access tokens, including their issuance, validation, and revocation, is crucial to maintaining confidentiality of data and systems. Restricting token validity to a specific audience, e.g., an application or security domain, and restricting token validity lifetimes are important practices. Access tokens are revoked or invalidated if they are compromised, lost, or are no longer needed to mitigate the risks associated with stolen or misused tokens. Satisfies: SRG-APP-001020, SRG-APP-001025","fixText":"Configure NGINX Plus to enforce access token revocation mechanisms.\n\nEnable token revocation via introspection endpoint (OIDC/OAuth2):\n\nlocation = /token/introspect {\n    internal;\n    proxy_pass https://auth.example.mil/oauth2/introspect;\n    proxy_set_header Content-Type \"application/x-www-form-urlencoded\";\n    proxy_pass_request_body on;\n    proxy_set_body \"token=$http_authorization\";\n}\n\nFail-closed on invalid or revoked token:\n\nlocation /secure/ {\n    auth_request /token/introspect;\n    error_page 401 = @error_revoke;\n}\n\nlocation @error_revoke {\n    return 401 \"Access token revoked or invalid.\";\n}\n\nRevoke tokens during logout flows:\n\nRedirect logout requests to IdP to invalidate tokens:\n\nlocation = /logout {\n    return 302 https://auth.example.mil/logout?token=$http_authorization;\n}\n\nLog all token revocation events:\n\nlog_format token_revocation '$remote_addr - $remote_user [$time_local] '\n                            '\"$request\" status=$status '\n                            'token_id=\"$jwt_jti\" revoked=\"true\" ';\naccess_log /var/log/nginx/token_revocation.log token_revocation;","checkText":"Verify NGINX Plus revokes or invalidates access tokens:\n\nCheck support for token revocation enforcement:\n\n# grep -i \"introspect\\|revok\\|blacklist\\|logout\" /etc/nginx/conf.d/*.conf\n\nConfirm token validation includes checking revocation status using:\n- OAuth2 introspection endpoint.\n- Token revocation list.\n- Allowlist or deny-list implementation.\n- Explicit session logout propagation.\n\nInspect logout and session termination handling:\n\n# grep -i \"session_timeout\\|logout\\|revoke\" /etc/nginx/conf.d/*.conf\n\nEnsure sessions are invalidated upon:\n- User logout.\n- Token expiration.\n- Authentication source change (e.g., password reset).\n\nToken revocation events (manual or automatic) must be logged with user ID, reason, and timestamp.\n\nIf NGINX Plus does not support access token revocation or fails to enforce revocation upon compromise or logout, this is a finding.","cciIds":["CCI-005167","CCI-000366","CCI-005168"],"status":"not_reviewed","findingDetails":"","comments":""}]}