{"title":"VMware vSphere 8.0 vCenter Appliance Lookup Service Security Technical Implementation Guide","description":"This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DOD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents. Comments or proposed revisions to this document should be sent via email to the following address: disa.stig_spt@mail.mil.","version":"2","releaseInfo":"Release: 1 Benchmark Date: 01 Aug 2024","rules":[{"id":"SV-259037r960735_rule","stigId":"V-259037","groupId":"V-259037","title":"DPMS Target VMware vSphere 8.0 VCSA Lookup Service","severity":"CAT II","description":"Resource exhaustion can occur when an unlimited number of concurrent requests are allowed on a website, facilitating a denial-of-service attack. Unless the number of requests is controlled, the web server can consume enough system resources to cause a system crash. Mitigating this kind of attack will include limiting the number of concurrent HTTP/HTTPS requests. In Tomcat, each incoming request requires a thread for the duration of that request. If more simultaneous requests are received than can be handled by the currently available request processing threads, additional threads will be created up to the value of the maxThreads attribute. Satisfies: SRG-APP-000001-AS-000001, SRG-APP-000435-AS-000163","fixText":"Navigate to and open:\n\n/usr/lib/vmware-lookupsvc/conf/server.xml\n\nNavigate to the <Executor> node with the name of tomcatThreadPool and configure with the value \"maxThreads=\"300\"\".\n\nNote: The <Executor> node should be configured similar to the following:\n\n<Executor maxThreads=\"300\"\n                minSpareThreads=\"50\"\n                name=\"tomcatThreadPool\"\n                namePrefix=\"tomcat-http--\"/>\n\nRestart the service with the following command:\n\n# vmon-cli --restart lookupsvc","checkText":"At the command prompt, run the following command:\n\n# xmllint --xpath '/Server/Service/Executor[@name=\"tomcatThreadPool\"]/@maxThreads' /usr/lib/vmware-lookupsvc/conf/server.xml\n\nExpected result:\n\nmaxThreads=\"300\"\n\nIf the output does not match the expected result, this is a finding.","cciIds":["CCI-000054","CCI-002385"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-259038r960792_rule","stigId":"V-259038","groupId":"V-259038","title":"DPMS Target VMware vSphere 8.0 VCSA Lookup Service","severity":"CAT II","description":"The secure flag is an option that can be set by the application server when sending a new cookie to the user within an HTTP Response. The purpose of the secure flag is to prevent cookies from being observed by unauthorized parties due to the transmission of a cookie in clear text. By setting the secure flag, the browser will prevent the transmission of a cookie over an unencrypted channel.","fixText":"Navigate to and open:\n\n/usr/lib/vmware-lookupsvc/conf/web.xml\n\nNavigate to the <session-config> node and configure the <secure> setting as follows:\n\n<session-config>\n  <session-timeout>30</session-timeout>\n  <cookie-config>\n      <http-only>true</http-only>\n      <secure>true</secure>\n  </cookie-config>\n</session-config>\n\nRestart the service with the following command:\n\n# vmon-cli --restart lookupsvc","checkText":"At the command prompt, run the following command:\n\n# xmllint --format /usr/lib/vmware-lookupsvc/conf/web.xml | sed 's/xmlns=\".*\"//g' | xmllint --xpath '/web-app/session-config/cookie-config/secure' -\n\nExpected result:\n\n<secure>true</secure>\n\nIf the output of the command does not match the expected result, this is a finding.","cciIds":["CCI-000213"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-259039r960888_rule","stigId":"V-259039","groupId":"V-259039","title":"DPMS Target VMware vSphere 8.0 VCSA Lookup Service","severity":"CAT II","description":"Logging must be started as soon as possible when a service starts and as late as possible when a service is stopped. Many forms of suspicious actions can be detected by analyzing logs for unexpected service starts and stops. Also, by starting to log immediately after a service starts, it becomes more difficult for suspicious activity to go unlogged.","fixText":"Navigate to and open:\n\n/etc/vmware/vmware-vmon/svcCfgfiles/lookupsvc.json\n\nBelow the last line of the \"PreStartCommandArg\" block, add the following line:\n\n\"StreamRedirectFile\": \"%VMWARE_LOG_DIR%/vmware/lookupsvc/lookupsvc_stream.log\",\n\nRestart the service with the following command:\n\n# vmon-cli --restart lookupsvc","checkText":"At the command prompt, run the following command:\n\n# grep StreamRedirectFile /etc/vmware/vmware-vmon/svcCfgfiles/lookupsvc.json\n\nExpected output:\n\n\"StreamRedirectFile\": \"%VMWARE_LOG_DIR%/vmware/lookupsvc/lookupsvc_stream.log\",\n\nIf no log file is specified for the \"StreamRedirectFile\" setting, this is a finding.","cciIds":["CCI-001464"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-259040r960891_rule","stigId":"V-259040","groupId":"V-259040","title":"DPMS Target VMware vSphere 8.0 VCSA Lookup Service","severity":"CAT II","description":"Remote access can be exploited by an attacker to compromise the server. By recording all remote access activities, it will be possible to determine the attacker's location, intent, and degree of success. Tomcat can be configured with an \"AccessLogValve\", a component that can be inserted into the request processing pipeline to provide robust access logging. The \"AccessLogValve\" creates log files in the same format as those created by standard web servers. When \"AccessLogValve\" is properly configured, log files will contain all the forensic information necessary in the case of a security incident. Satisfies: SRG-APP-000095-AS-000056, SRG-APP-000016-AS-000013, SRG-APP-000096-AS-000059, SRG-APP-000097-AS-000060, SRG-APP-000098-AS-000061, SRG-APP-000099-AS-000062, SRG-APP-000100-AS-000063, SRG-APP-000080-AS-000045, SRG-APP-000089-AS-000050, SRG-APP-000090-AS-000051, SRG-APP-000091-AS-000052, SRG-APP-000343-AS-000030, SRG-APP-000375-AS-000211, SRG-APP-000495-AS-000220, SRG-APP-000499-AS-000224, SRG-APP-000503-AS-000228","fixText":"Navigate to and open:\n\n/usr/lib/vmware-lookupsvc/conf/server.xml\n\nInside the <Host> node, find the \"AccessLogValve\" <Valve> node and replace the \"pattern\" element as follows:\n\npattern=\"%t %I [Request] &quot;%{User-Agent}i&quot; %{X-Forwarded-For}i/%h:%{remote}p %l %u to local %{local}p - &quot;%r&quot; %H %m %U%q    [Response] %s - %b bytes    [Perf] process %Dms / commit %Fms / conn [%X]\"\n\nRestart the service with the following command:\n\n# vmon-cli --restart lookupsvc","checkText":"At the command prompt, run the following command:\n\n# xmllint --xpath '/Server/Service/Engine/Host/Valve[@className=\"org.apache.catalina.valves.AccessLogValve\"]/@pattern' /usr/lib/vmware-lookupsvc/conf/server.xml\n\nExample result:\n\npattern=\"%t %I [Request] &quot;%{User-Agent}i&quot; %{X-Forwarded-For}i/%h:%{remote}p %l %u to local %{local}p - &quot;%r&quot; %H %m %U%q    [Response] %s - %b bytes    [Perf] process %Dms / commit %Fms / conn [%X]\"\n\nRequired elements:\n\n%h %{X-Forwarded-For}i %l %t %u &quot;%r&quot; %s %b\n\nIf the log pattern does not contain the required elements in any order, this is a finding.","cciIds":["CCI-000067","CCI-000130","CCI-000131","CCI-000132","CCI-000133","CCI-000134","CCI-000166","CCI-000169","CCI-000171","CCI-000172","CCI-001487","CCI-001889","CCI-002234"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-259041r960930_rule","stigId":"V-259041","groupId":"V-259041","title":"DPMS Target VMware vSphere 8.0 VCSA Lookup Service","severity":"CAT II","description":"Log data is essential in the investigation of events. The accuracy of the information is always pertinent. One of the first steps an attacker will take is the modification or deletion of log records to cover tracks and prolong discovery. The web server must protect the log data from unauthorized modification. Satisfies: SRG-APP-000118-AS-000078, SRG-APP-000119-AS-000079, SRG-APP-000120-AS-000080","fixText":"At the command prompt, run the following commands:\n\n# chmod o-w <file>\n# chown lookupsvc:lookupsvc <file>\n\nNote: Substitute <file> with the listed file.","checkText":"At the command prompt, run the following command:\n\n# find /var/log/vmware/lookupsvc/ -xdev ! -name lookupsvc-init.log ! -name lookupsvc-prestart.log -type f -a '(' -perm -o+w -o -not -user lookupsvc -o -not -group lookupsvc ')' -exec ls -ld {} \\;\n\nIf any files are returned, this is a finding.","cciIds":["CCI-000162","CCI-000163","CCI-000164"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-259042r960960_rule","stigId":"V-259042","groupId":"V-259042","title":"DPMS Target VMware vSphere 8.0 VCSA Lookup Service","severity":"CAT II","description":"Application servers have the ability to specify that the hosted applications use shared libraries. The application server must have a capability to divide roles based upon duties wherein one project user (such as a developer) cannot modify the shared library code of another project user. The application server must also be able to specify that nonprivileged users cannot modify any shared library code at all. Ensuring the Security Lifecycle Listener element is uncommented and sets a minimum Umask value will allow the server to perform a number of security checks when starting and prevent the service from starting if they fail.","fixText":"Navigate to and open:\n\n/usr/lib/vmware-lookupsvc/conf/server.xml\n\nNavigate to the <Server> node and add or update the \"org.apache.catalina.security.SecurityListener\" as follows:\n\n<Listener className=\"org.apache.catalina.security.SecurityListener\"/>\n\nRestart the service with the following command:\n\n# vmon-cli --restart lookupsvc","checkText":"At the command prompt, run the following command:\n\n# xmllint --xpath '/Server/Listener[@className=\"org.apache.catalina.security.SecurityListener\"]' /usr/lib/vmware-lookupsvc/conf/server.xml\n\nExample result:\n\n<Listener className=\"org.apache.catalina.security.SecurityListener\"/>\n\nIf the \"org.apache.catalina.security.SecurityListener\" listener is not present, this is a finding.\n\nIf the \"org.apache.catalina.security.SecurityListener\" listener is configured with a \"minimumUmask\" and is not \"0007\", this is a finding.","cciIds":["CCI-001499"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-259043r960963_rule","stigId":"V-259043","groupId":"V-259043","title":"DPMS Target VMware vSphere 8.0 VCSA Lookup Service","severity":"CAT II","description":"Stack tracing provides debugging information from the application call stacks when a runtime error is encountered. If stack tracing is left enabled, Tomcat will provide this call stack information to the requestor, which could result in the loss of sensitive information or data that could be used to compromise the system.","fixText":"Navigate to and open:\n\n/usr/lib/vmware-lookupsvc/conf/server.xml\n\nNavigate to and locate:\n\n'allowTrace=\"true\"'\n\nRemove the 'allowTrace=\"true\"' setting.\n\nNote: If \"allowTrace\" is not present, it defaults to \"false\".\n\nRestart the service with the following command:\n\n# vmon-cli --restart lookupsvc","checkText":"At the command prompt, run the following command:\n\n# xmllint --xpath \"//Connector[@allowTrace = 'true']\" /usr/lib/vmware-lookupsvc/conf/server.xml\n\nExpected result:\n\nXPath set is empty\n\nIf any connectors are returned, this is a finding.","cciIds":["CCI-000381"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-259044r960966_rule","stigId":"V-259044","groupId":"V-259044","title":"DPMS Target VMware vSphere 8.0 VCSA Lookup Service","severity":"CAT II","description":"The server must be configured to listen on a specified IP address and port. Without specifying an IP address and port for server to use, the server will listen on all IP addresses available. Accessing the hosted application through an IP address normally used for nonapplication functions opens the possibility of user access to resources, utilities, files, ports, and protocols that are protected on the desired application IP address.","fixText":"Navigate to and open:\n\n/usr/lib/vmware-lookupsvc/conf/server.xml\n\nNavigate to the <Connector> node and configure the port and address as follows:\n\nport=\"${bio-custom.http.port}\"\naddress=\"localhost\"\n\nRestart the service with the following command:\n\n# vmon-cli --restart lookupsvc","checkText":"At the command prompt, run the following command:\n\n# xmllint --xpath \"//Connector[(@port = '0') or not(@address)]\" /usr/lib/vmware-lookupsvc/conf/server.xml\n\nExpected result:\n\nXPath set is empty\n\nIf any connectors are returned, this is a finding.","cciIds":["CCI-000382"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-259045r961116_rule","stigId":"V-259045","groupId":"V-259045","title":"DPMS Target VMware vSphere 8.0 VCSA Lookup Service","severity":"CAT II","description":"If RECYCLE_FACADES is true or if a security manager is in use, a new facade object will be created for each request. This reduces the chances that a bug in an application might expose data from one request to another.","fixText":"Navigate to and open:\n\n/usr/lib/vmware-lookupsvc/conf/catalina.properties\n\nUpdate or remove the following line:\n\norg.apache.catalina.connector.RECYCLE_FACADES=true\n\nRestart the service with the following command:\n\n# vmon-cli --restart lookupsvc","checkText":"At the command line, run the following command:\n\n# grep RECYCLE_FACADES /usr/lib/vmware-lookupsvc/conf/catalina.properties\n\nExample result:\n\norg.apache.catalina.connector.RECYCLE_FACADES=true\n\nIf \"org.apache.catalina.connector.RECYCLE_FACADES\" is not set to \"true\", this is a finding.\n\nIf the \"org.apache.catalina.connector.RECYCLE_FACADES\" setting does not exist, this is not a finding.","cciIds":["CCI-001664"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-259046r961122_rule","stigId":"V-259046","groupId":"V-259046","title":"DPMS Target VMware vSphere 8.0 VCSA Lookup Service","severity":"CAT II","description":"Determining a safe state for failure and weighing that against a potential denial of service for users depends on what type of application the web server is hosting. It is preferable that the service abort startup on any initialization failure rather than continuing in a degraded, and potentially insecure, state.","fixText":"Navigate to and open:\n\n/usr/lib/vmware-lookupsvc/conf/catalina.properties\n\nAdd or change the following line:\n\norg.apache.catalina.startup.EXIT_ON_INIT_FAILURE=true\n\nRestart the service with the following command:\n\n# vmon-cli --restart lookupsvc","checkText":"At the command line, run the following command:\n\n# grep EXIT_ON_INIT_FAILURE /usr/lib/vmware-lookupsvc/conf/catalina.properties\n\nExample result:\n\norg.apache.catalina.startup.EXIT_ON_INIT_FAILURE=true\n\nIf there are no results, or if the \"org.apache.catalina.startup.EXIT_ON_INIT_FAILURE\" is not set to \"true\", this is a finding.","cciIds":["CCI-001190"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-259047r961158_rule","stigId":"V-259047","groupId":"V-259047","title":"DPMS Target VMware vSphere 8.0 VCSA Lookup Service","severity":"CAT II","description":"Invalid user input occurs when a user inserts data or characters into a hosted application's data entry field and the hosted application is unprepared to process that data. This results in unanticipated application behavior, potentially leading to an application compromise. Invalid user input is one of the primary methods employed when attempting to compromise an application. An attacker can also enter Unicode characters into hosted applications in an effort to break out of the document home or root home directory or bypass security checks.","fixText":"Navigate to and open:\n\n/usr/lib/vmware-lookupsvc/conf/server.xml\n\nConfigure the <Connector> node with the value:\n\nURIEncoding=\"UTF-8\"\n\nRestart the service with the following command:\n\n# vmon-cli --restart lookupsvc","checkText":"At the command prompt, run the following command:\n\n# xmllint --xpath \"//Connector[@URIEncoding != 'UTF-8'] | //Connector[not[@URIEncoding]]\" /usr/lib/vmware-lookupsvc/conf/server.xml\n\nExpected result:\n\nXPath set is empty\n\nIf any connectors are returned, this is a finding.","cciIds":["CCI-001310"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-259048r961167_rule","stigId":"V-259048","groupId":"V-259048","title":"DPMS Target VMware vSphere 8.0 VCSA Lookup Service","severity":"CAT II","description":"The Error Report Valve is a simple error handler for HTTP status codes that will generate and return HTML error pages. It can also be configured to return predefined static HTML pages for specific status codes and/or exception types. Disabling \"showServerInfo\" will only return the HTTP status code and remove all CSS from the default nonerror-related HTTP responses.","fixText":"Navigate to and open:\n\n/usr/lib/vmware-lookupsvc/conf/server.xml\n\nLocate the following Host block:\n\n<Host ...>\n...\n</Host>\n\nInside this block, add or update the following on a new line:\n\n<Valve className=\"org.apache.catalina.valves.ErrorReportValve\" showServerInfo=\"false\" showReport=\"false\"/>\n\nRestart the service with the following command:\n\n# vmon-cli --restart lookupsvc","checkText":"At the command prompt, run the following command:\n\n# xmllint --xpath '/Server/Service/Engine/Host/Valve[@className=\"org.apache.catalina.valves.ErrorReportValve\"]' /usr/lib/vmware-lookupsvc/conf/server.xml\n\nExample result:\n\n<Valve className=\"org.apache.catalina.valves.ErrorReportValve\" showServerInfo=\"false\" showReport=\"false\"/>\n\nIf the \"ErrorReportValve\" element is not defined or \"showServerInfo\" is not set to \"false\", this is a finding.","cciIds":["CCI-001312"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-259049r1003620_rule","stigId":"V-259049","groupId":"V-259049","title":"DPMS Target VMware vSphere 8.0 VCSA Lookup Service","severity":"CAT II","description":"Leaving sessions open indefinitely is a major security risk. An attacker can easily use an already authenticated session to access the hosted application as the previously authenticated user. By closing sessions after a set period of inactivity, the web server can make certain that those sessions that are not closed through the user logging out of an application are eventually closed. Satisfies: SRG-APP-000295-AS-000263, SRG-APP-000389-AS-000253","fixText":"Navigate to and open:\n\n/usr/lib/vmware-lookupsvc/conf/web.xml\n\nNavigate to the <session-config> node and configure the <session-timeout> as follows:\n\n<session-config>\n  <session-timeout>30</session-timeout>\n  <cookie-config>\n      <http-only>true</http-only>\n      <secure>true</secure>\n  </cookie-config>\n</session-config>\n\nRestart the service with the following command:\n\n# vmon-cli --restart lookupsvc","checkText":"At the command prompt, run the following command:\n\n# xmllint --format /usr/lib/vmware-lookupsvc/conf/web.xml | sed 's/xmlns=\".*\"//g' | xmllint --xpath '/web-app/session-config/session-timeout' -\n\nExample result:\n\n<session-timeout>30</session-timeout>\n\nIf the value of \"session-timeout\" is not \"30\" or less, or is missing, this is a finding.","cciIds":["CCI-004895","CCI-002361"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-259050r961395_rule","stigId":"V-259050","groupId":"V-259050","title":"DPMS Target VMware vSphere 8.0 VCSA Lookup Service","severity":"CAT II","description":"Information system logging capability is critical for accurate forensic analysis. Log record content that may be necessary to satisfy the requirement of this control includes, but is not limited to, time stamps, source and destination IP addresses, user/process identifiers, event descriptions, application-specific events, success/fail indications, filenames involved, and access control or flow control rules invoked. Offloading is a common process in information systems with limited log storage capacity. Centralized management of log records provides for efficiency in maintenance and management of records, as well as the backup and archiving of those records. Application servers and their related components are required to offload log records onto a different system or media than the system being logged.","fixText":"Navigate to and open:\n\n/etc/vmware-syslog/vmware-services-lookupsvc.conf\n\nCreate the file if it does not exist.\n\nSet the contents of the file as follows:\n\n#catalina\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/lookupsvc/tomcat/catalina.*.log\"\n      Tag=\"lookupsvc-tc-catalina\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#localhost\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/lookupsvc/tomcat/localhost.*.log\"\n      Tag=\"lookupsvc-tc-localhost\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#localhost_access_log\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/lookupsvc/tomcat/localhost_access.log\"\n      Tag=\"lookupsvc-localhost_access\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#lookupsvc-init\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/lookupsvc/lookupsvc-init.log\"\n      Tag=\"lookupsvc-init\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#prestart\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/lookupsvc/lookupsvc-prestart.log\"\n      Tag=\"lookupsvc-prestart\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#health\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/lookupsvc/lookupsvc-health.log\"\n      Tag=\"lookupsvc-health\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#lookupserver-default\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/lookupsvc/lookupserver-default.log\"\n      Tag=\"lookupsvc-lookupserver-default\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#lookupsvc_stream.log.std\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/lookupsvc/lookupsvc_stream.log.std*\"\n      Tag=\"lookupsvc-std\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#ls-gc\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/lookupsvc/vmware-lookupsvc-gc.log.*.current\"\n      Tag=\"lookupsvc-gc\"\n      Severity=\"info\"\n      Facility=\"local0\")","checkText":"By default, a vmware-services-lookupsvc.conf rsyslog configuration file that includes the service logs when syslog is configured on vCenter, but it must be verified.\n\nAt the command prompt, run the following command:\n\n# cat /etc/vmware-syslog/vmware-services-lookupsvc.conf\n\nExpected result:\n\n#catalina\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/lookupsvc/tomcat/catalina.*.log\"\n      Tag=\"lookupsvc-tc-catalina\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#localhost\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/lookupsvc/tomcat/localhost.*.log\"\n      Tag=\"lookupsvc-tc-localhost\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#localhost_access_log\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/lookupsvc/tomcat/localhost_access.log\"\n      Tag=\"lookupsvc-localhost_access\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#lookupsvc-init\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/lookupsvc/lookupsvc-init.log\"\n      Tag=\"lookupsvc-init\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#prestart\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/lookupsvc/lookupsvc-prestart.log\"\n      Tag=\"lookupsvc-prestart\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#health\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/lookupsvc/lookupsvc-health.log\"\n      Tag=\"lookupsvc-health\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#lookupserver-default\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/lookupsvc/lookupserver-default.log\"\n      Tag=\"lookupsvc-lookupserver-default\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#lookupsvc_stream.log.std\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/lookupsvc/lookupsvc_stream.log.std*\"\n      Tag=\"lookupsvc-std\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#ls-gc\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/lookupsvc/vmware-lookupsvc-gc.log.*.current\"\n      Tag=\"lookupsvc-gc\"\n      Severity=\"info\"\n      Facility=\"local0\")\n\nIf the output does not match the expected result, this is a finding.","cciIds":["CCI-001851"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-259051r961863_rule","stigId":"V-259051","groupId":"V-259051","title":"DPMS Target VMware vSphere 8.0 VCSA Lookup Service","severity":"CAT II","description":"Strict Servlet Compliance forces Tomcat to adhere to standards specifications including but not limited to RFC2109. RFC2109 sets the standard for HTTP session management. This setting affects several other settings that primarily pertain to cookie headers, cookie values, and sessions. Cookies will be parsed for strict adherence to specifications. Note that changing a number of these default settings may break some systems, as some browsers are unable to correctly handle the cookie headers that result from a strict adherence to the specifications. This one setting changes the default values for the following settings: org.apache.catalina.core.ApplicationContext.GET_RESOURCE_REQUIRE_SLASH org.apache.catalina.core.ApplicationDispatcher.WRAP_SAME_OBJECT org.apache.catalina.core.StandardHostValve.ACCESS_SESSION org.apache.catalina.session.StandardSession.ACTIVITY_CHECK org.apache.catalina.session.StandardSession.LAST_ACCESS_AT_START org.apache.tomcat.util.http.ServerCookie.ALWAYS_ADD_EXPIRES org.apache.tomcat.util.http.ServerCookie.FWD_SLASH_IS_SEPARATOR org.apache.tomcat.util.http.ServerCookie.PRESERVE_COOKIE_HEADER org.apache.tomcat.util.http.ServerCookie.STRICT_NAMING The \"resourceOnlyServlets\" attribute of any Context element. The \"tldValidation\" attribute of any Context element. The \"useRelativeRedirects\" attribute of any Context element. The \"xmlNamespaceAware\" attribute of any Context element. The \"xmlValidation\" attribute of any Context element.","fixText":"Navigate to and open:\n\n/usr/lib/vmware-lookupsvc/conf/catalina.properties\n\nAdd or change the following line:\n\norg.apache.catalina.STRICT_SERVLET_COMPLIANCE=true\n\nRestart the service with the following command:\n\n# vmon-cli --restart lookupsvc","checkText":"At the command line, run the following command:\n\n# grep STRICT_SERVLET_COMPLIANCE /usr/lib/vmware-lookupsvc/conf/catalina.properties\n\nExample result:\n\norg.apache.catalina.STRICT_SERVLET_COMPLIANCE=true\n\nIf there are no results, or if the \"org.apache.catalina.STRICT_SERVLET_COMPLIANCE\" is not set to \"true\", this is a finding.","cciIds":["CCI-000366"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-259052r960735_rule","stigId":"V-259052","groupId":"V-259052","title":"DPMS Target VMware vSphere 8.0 VCSA Lookup Service","severity":"CAT II","description":"Denial of service (DoS) is one threat against web servers. Many DoS attacks attempt to consume web server resources in such a way that no more resources are available to satisfy legitimate requests. In Tomcat, the \"connectionTimeout\" attribute sets the number of milliseconds the server will wait after accepting a connection for the request Uniform Resource Identifier (URI) line to be presented. This timeout will also be used when reading the request body (if any). This prevents idle sockets that are not sending HTTP requests from consuming system resources and potentially denying new connections.","fixText":"Navigate to and open:\n\n/usr/lib/vmware-lookupsvc/conf/server.xml\n\nConfigure the <Connector> node with the value:\n\nconnectionTimeout=\"60000\"\n\nRestart the service with the following command:\n\n# vmon-cli --restart lookupsvc","checkText":"The connection timeout should not be disabled by setting it to \"-1\".\n\nAt the command prompt, run the following command:\n\n# xmllint --xpath \"//Connector[@connectionTimeout = '-1']\" /usr/lib/vmware-lookupsvc/conf/server.xml\n\nExpected result:\n\nXPath set is empty\n\nIf any connectors are returned, this is a finding.","cciIds":["CCI-000054"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-259053r960735_rule","stigId":"V-259053","groupId":"V-259053","title":"DPMS Target VMware vSphere 8.0 VCSA Lookup Service","severity":"CAT II","description":"KeepAlive provides long lived HTTP sessions that allow multiple requests to be sent over the same connection. Enabling KeepAlive mitigates the effects of several types of denial-of-service attacks. An advantage of KeepAlive is the reduced latency in subsequent requests (no handshaking). However, a disadvantage is that server resources are not available to handle other requests while a connection is maintained between the server and the client. Tomcat can be configured to limit the number of subsequent requests that one client can submit to the server over an established connection. This limit helps provide a balance between the advantages of KeepAlive, while not allowing any one connection being held too long by any one client.","fixText":"Navigate to and open:\n\n/usr/lib/vmware-lookupsvc/conf/server.xml\n\nConfigure the <Connector> node with the value:\n\nmaxKeepAliveRequests=\"50\"\n\nRestart the service with the following command:\n\n# vmon-cli --restart lookupsvc","checkText":"The connection timeout should not be unlimited by setting it to \"-1\".\n\nAt the command prompt, run the following command:\n\n# xmllint --xpath \"//Connector[@maxKeepAliveRequests = '-1']\" /usr/lib/vmware-lookupsvc/conf/server.xml\n\nExpected result:\n\nXPath set is empty\n\nIf any connectors are returned, this is a finding.","cciIds":["CCI-000054"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-259054r961158_rule","stigId":"V-259054","groupId":"V-259054","title":"DPMS Target VMware vSphere 8.0 VCSA Lookup Service","severity":"CAT II","description":"Invalid user input occurs when a user inserts data or characters into a hosted application's data entry field and the hosted application is unprepared to process that data. This results in unanticipated application behavior, potentially leading to an application compromise. Invalid user input is one of the primary methods employed when attempting to compromise an application. An attacker can also enter Unicode characters into hosted applications in an effort to break out of the document home or root home directory or to bypass security checks. VMware uses the standard Tomcat \"SetCharacterEncodingFilter\" to provide a layer of defense against character encoding attacks. Filters are Java objects that perform filtering tasks on the request to a resource (a servlet or static content), on the response from a resource, or both.","fixText":"Navigate to and open:\n\n/usr/lib/vmware-lookupsvc/conf/web.xml\n\nConfigure the <web-app> node with the child nodes listed below:\n\n<filter-mapping>\n  <filter-name>setCharacterEncodingFilter</filter-name>\n  <url-pattern>/*</url-pattern>\n</filter-mapping>\n\n<filter>\n  <filter-name>setCharacterEncodingFilter</filter-name>\n  <filter-class>org.apache.catalina.filters.SetCharacterEncodingFilter</filter-class>\n  <async-supported>true</async-supported>\n  <init-param>\n    <param-name>encoding</param-name>\n    <param-value>UTF-8</param-value>\n  </init-param>\n  <init-param>\n    <param-name>ignore</param-name>\n    <param-value>true</param-value>\n  </init-param>\n</filter>\n\nRestart the service with the following command:\n\n# vmon-cli --restart lookupsvc","checkText":"At the command prompt, run the following command:\n\n# xmllint --xpath \"//*[contains(text(), 'setCharacterEncodingFilter')]/parent::*\" /usr/lib/vmware-lookupsvc/conf/web.xml\n\nExpected result:\n\n<filter-mapping>\n  <filter-name>setCharacterEncodingFilter</filter-name>\n  <url-pattern>/*</url-pattern>\n</filter-mapping>\n<filter>\n  <filter-name>setCharacterEncodingFilter</filter-name>\n  <filter-class>org.apache.catalina.filters.SetCharacterEncodingFilter</filter-class>\n  <async-supported>true</async-supported>\n  <init-param>\n    <param-name>encoding</param-name>\n    <param-value>UTF-8</param-value>\n  </init-param>\n  <init-param>\n    <param-name>ignore</param-name>\n    <param-value>true</param-value>\n  </init-param>\n</filter>\n\nIf the output is does not match the expected result, this is a finding.","cciIds":["CCI-001310"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-259055r960792_rule","stigId":"V-259055","groupId":"V-259055","title":"DPMS Target VMware vSphere 8.0 VCSA Lookup Service","severity":"CAT II","description":"Cookies are a common way to save session state over the HTTP(S) protocol. If attackers can compromise session data stored in a cookie, they are better able to launch an attack against the server and its applications. When a cookie is tagged with the \"HttpOnly\" flag, it tells the browser this particular cookie should only be accessed by the originating server. Any attempt to access the cookie from client script is strictly forbidden.","fixText":"Navigate to and open:\n\n/usr/lib/vmware-lookupsvc/conf/web.xml\n\nNavigate to the <session-config> node and configure the <http-only> as follows:\n\n<session-config>\n  <session-timeout>30</session-timeout>\n  <cookie-config>\n      <http-only>true</http-only>\n      <secure>true</secure>\n  </cookie-config>\n</session-config>\n\nRestart the service with the following command:\n\n# vmon-cli --restart lookupsvc","checkText":"At the command prompt, run the following command:\n\n# xmllint --format /usr/lib/vmware-lookupsvc/conf/web.xml | sed 's/xmlns=\".*\"//g' | xmllint --xpath '/web-app/session-config/cookie-config/http-only' -\n\nExpected result:\n\n<http-only>true</http-only>\n\nIf the output does not match the expected result, this is a finding.","cciIds":["CCI-000213"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-259056r960792_rule","stigId":"V-259056","groupId":"V-259056","title":"DPMS Target VMware vSphere 8.0 VCSA Lookup Service","severity":"CAT II","description":"The default servlet (or DefaultServlet) is a special servlet provided with Tomcat that is called when no other suitable page is found in a particular folder. The DefaultServlet serves static resources as well as directory listings. The DefaultServlet is configured by default with the \"readonly\" parameter set to \"true\" where HTTP commands such as \"PUT\" and \"DELETE\" are rejected. Changing this to \"false\" allows clients to delete or modify static resources on the server and to upload new resources. DefaultServlet \"readonly\" must be set to \"true\", either literally or by absence (default).","fixText":"Navigate to and open:\n\n/usr/lib/vmware-lookupsvc/conf/web.xml\n\nNavigate to the /<web-apps>/<servlet>/<servlet-class>org.apache.catalina.servlets.DefaultServlet</servlet-class>/ node and remove the following node:\n\n<init-param>\n      <param-name>readonly</param-name>\n      <param-value>false</param-value>\n</init-param>\n\nRestart the service with the following command:\n\n# vmon-cli --restart lookupsvc","checkText":"At the command prompt, run the following command:\n\n# xmllint --xpath \"//*[contains(text(), 'DefaultServlet')]/parent::*\" /usr/lib/vmware-lookupsvc/conf/web.xml\n\nExample output:\n\n<servlet>\n      <description>File servlet</description>\n      <servlet-name>FileServlet</servlet-name>\n      <servlet-class>org.apache.catalina.servlets.DefaultServlet</servlet-class>\n</servlet>\n\nIf the \"readOnly\" param-value for the \"DefaultServlet\" servlet class is set to \"false\", this is a finding.\n\nIf the \"readOnly\" param-value does not exist, this is not a finding.","cciIds":["CCI-000213"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-259057r960963_rule","stigId":"V-259057","groupId":"V-259057","title":"DPMS Target VMware vSphere 8.0 VCSA Lookup Service","severity":"CAT II","description":"Tomcat by default listens on TCP port 8005 to accept shutdown requests. By connecting to this port and sending the SHUTDOWN command, all applications within Tomcat are halted. The shutdown port is not exposed to the network as it is bound to the loopback interface. Setting the port to \"-1\" in $CATALINA_BASE/conf/server.xml instructs Tomcat to not listen for the shutdown command.","fixText":"Navigate to and open:\n\n/usr/lib/vmware-lookupsvc/conf/catalina.properties\n\nAdd or modify the setting \"base.shutdown.port=-1\" in the \"catalina.properties\" file.\n\nNavigate to and open:\n\n/usr/lib/vmware-lookupsvc/conf/server.xml\n\nConfigure the <Server> node with the value:\n\nport=\"${base.shutdown.port}\"\n\nRestart the service with the following command:\n\n# vmon-cli --restart lookupsvc","checkText":"At the command prompt, run the following commands:\n\n# xmllint --xpath \"//Server/@port\" /usr/lib/vmware-lookupsvc/conf/server.xml\n# grep 'base.shutdown.port' /usr/lib/vmware-lookupsvc/conf/catalina.properties\n\nExample results:\n\nport=\"${base.shutdown.port}\"\nbase.shutdown.port=-1\n\nIf \"port\" does not equal \"${base.shutdown.port}\", this is a finding.\n\nIf \"base.shutdown.port\" does not equal \"-1\", this is a finding.","cciIds":["CCI-000381"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-259058r960963_rule","stigId":"V-259058","groupId":"V-259058","title":"DPMS Target VMware vSphere 8.0 VCSA Lookup Service","severity":"CAT II","description":"Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server and plug-ins or modules being used. When debugging or trace information is enabled in a production web server, information about the web server, such as web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage may be displayed. Because this information may be placed in logs and general messages during normal operation of the web server, an attacker does not need to cause an error condition to gain this information.","fixText":"Navigate to and open:\n\n/usr/lib/vmware-lookupsvc/conf/web.xml\n\nNavigate to all <debug> nodes that are not set to \"0\".\n\nSet the <param-value> to \"0\" in all <param-name>debug</param-name> nodes.\n\nNote: The debug setting should look like the following:\n\n<init-param>\n      <param-name>debug</param-name>\n      <param-value>0</param-value>\n</init-param>\n\nRestart the service with the following command:\n\n# vmon-cli --restart lookupsvc","checkText":"At the command prompt, run the following command:\n\n# xmllint --format /usr/lib/vmware-lookupsvc/conf/web.xml | sed 's/xmlns=\".*\"//g' | xmllint --xpath '//param-name[text()=\"debug\"]/parent::init-param' -\n\nExample result:\n\n<init-param>\n      <param-name>debug</param-name>\n      <param-value>0</param-value>\n</init-param>\n\nIf the \"debug\" parameter is specified and is not \"0\", this is a finding.\n\nIf the \"debug\" parameter does not exist, this is not a finding.","cciIds":["CCI-000381"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-259059r960963_rule","stigId":"V-259059","groupId":"V-259059","title":"DPMS Target VMware vSphere 8.0 VCSA Lookup Service","severity":"CAT II","description":"Enumeration techniques, such as URL parameter manipulation, rely on being able to obtain information about the web server's directory structure by locating directories without default pages. In this scenario, the web server will display to the user a listing of the files in the directory being accessed. Ensuring that directory listing is disabled is one approach to mitigating the vulnerability. In Tomcat, directory listing is disabled by default but can be enabled via the \"listings\" parameter. Ensure this node is not present to have the default effect.","fixText":"Navigate to and open:\n\n/usr/lib/vmware-lookupsvc/conf/web.xml\n\nFind and remove the entire block returned in the check.\n\nExample:\n\n<init-param>\n      <param-name>listings</param-name>\n      <param-value>true</param-value>\n</init-param>\n\nRestart the service with the following command:\n\n# vmon-cli --restart lookupsvc","checkText":"At the command prompt, run the following command:\n\n# xmllint --format /usr/lib/vmware-lookupsvc/conf/web.xml | sed 's/xmlns=\".*\"//g' | xmllint --xpath '//param-name[text()=\"listings\"]/parent::init-param' -\n\nExample result:\n\nXPath set is empty\n\nIf the \"listings\" parameter is specified and is not \"false\", this is a finding.\n\nIf the \"listings\" parameter does not exist, this is not a finding.","cciIds":["CCI-000381"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-259060r960963_rule","stigId":"V-259060","groupId":"V-259060","title":"DPMS Target VMware vSphere 8.0 VCSA Lookup Service","severity":"CAT II","description":"The Host element controls deployment. Automatic deployment allows for simpler management but also makes it easier for an attacker to deploy a malicious application. Automatic deployment is controlled by the autoDeploy and deployOnStartup attributes. If both are false, only Contexts defined in server.xml will be deployed, and any changes will require a Tomcat restart. In a hosted environment where web applications may not be trusted, set the deployXML attribute to \"false\" to ignore any context.xml packaged with the web application that may try to assign increased privileges to the web application. Note that if the security manager is enabled, the deployXML attribute will default to false.","fixText":"Navigate to and open:\n\n/usr/lib/vmware-lookupsvc/conf/server.xml\n\nNavigate to the <Host> node and configure with the value \"deployXML=\"false\"\".\n\nRestart the service with the following command:\n\n# vmon-cli --restart lookupsvc","checkText":"At the command prompt, run the following command:\n\n# xmllint --xpath \"//Host/@deployXML\" /usr/lib/vmware-lookupsvc/conf/server.xml\n\nExpected result:\n\ndeployXML=\"false\"\n\nIf \"deployXML\" does not equal \"false\", this is a finding.","cciIds":["CCI-000381"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-259061r960963_rule","stigId":"V-259061","groupId":"V-259061","title":"DPMS Target VMware vSphere 8.0 VCSA Lookup Service","severity":"CAT II","description":"Tomcat allows auto-deployment of applications while it is running. This can allow untested or malicious applications to be automatically loaded into production. Autodeploy must be disabled in production.","fixText":"Navigate to and open:\n\n/usr/lib/vmware-lookupsvc/conf/server.xml\n\nNavigate to the <Host> node and configure with the value \"autoDeploy=\"false\"\".\n\nRestart the service with the following command:\n\n# vmon-cli --restart lookupsvc","checkText":"At the command prompt, run the following command:\n\n# xmllint --xpath \"//Host/@autoDeploy\" /usr/lib/vmware-lookupsvc/conf/server.xml\n\nExpected result:\n\nautoDeploy=\"false\"\n\nIf \"autoDeploy\" does not equal \"false\", this is a finding.","cciIds":["CCI-000381"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-259062r960963_rule","stigId":"V-259062","groupId":"V-259062","title":"DPMS Target VMware vSphere 8.0 VCSA Lookup Service","severity":"CAT II","description":"Individual connectors can be configured to display the Tomcat information to clients. This information can be used to identify server versions that can be useful to attackers for identifying vulnerable versions of Tomcat. Individual connectors must be checked for the xpoweredBy attribute to ensure they do not pass server information to clients. The default value for xpoweredBy is \"false\".","fixText":"Navigate to and open:\n\n/usr/lib/vmware-lookupsvc/conf/server.xml\n\nNavigate to the <Connector> node and remove the \"xpoweredBy\" attribute.\n\nRestart the service with the following command:\n\n# vmon-cli --restart lookupsvc","checkText":"At the command prompt, run the following command:\n\n# xmllint --xpath \"//Connector/@xpoweredBy\" /usr/lib/vmware-lookupsvc/conf/server.xml\n\nExample result:\n\nXPath set is empty\n\nIf the \"xpoweredBy\" parameter is specified and is not \"false\", this is a finding.\n\nIf the \"xpoweredBy\" parameter does not exist, this is not a finding.","cciIds":["CCI-000381"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-259063r960963_rule","stigId":"V-259063","groupId":"V-259063","title":"DPMS Target VMware vSphere 8.0 VCSA Lookup Service","severity":"CAT II","description":"Tomcat provides example applications, documentation, and other directories in the default installation that do not serve a production use. These files must be deleted.","fixText":"At the command prompt, run the following command:\n\n# rm -rf /var/opt/apache-tomcat/webapps/examples","checkText":"At the command prompt, run the following command:\n\n# ls -l /var/opt/apache-tomcat/webapps/examples\n\nIf the examples folder exists or contains any content, this is a finding.","cciIds":["CCI-000381"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-259064r960963_rule","stigId":"V-259064","groupId":"V-259064","title":"DPMS Target VMware vSphere 8.0 VCSA Lookup Service","severity":"CAT II","description":"The default ROOT web application includes the version of Tomcat being used, links to Tomcat documentation, examples, FAQs, and mailing lists. The default ROOT web application must be removed from a publicly accessible instance and a more appropriate default page shown to users.","fixText":"At the command prompt, run the following command:\n\n# rm -rf /var/opt/apache-tomcat/webapps/ROOT/*","checkText":"At the command prompt, run the following command:\n\n# ls -l /var/opt/apache-tomcat/webapps/ROOT\n\nIf the ROOT web application contains any content, this is a finding.","cciIds":["CCI-000381"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-259065r960963_rule","stigId":"V-259065","groupId":"V-259065","title":"DPMS Target VMware vSphere 8.0 VCSA Lookup Service","severity":"CAT II","description":"Tomcat provides documentation and other directories in the default installation that do not serve a production use. These files must be deleted.","fixText":"At the command prompt, run the following command:\n\n# rm -rf /var/opt/apache-tomcat/webapps/docs","checkText":"At the command prompt, run the following command:\n\n# ls -l /var/opt/apache-tomcat/webapps/docs\n\nIf the \"docs\" folder exists or contains any content, this is a finding.","cciIds":["CCI-000381"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-259066r961461_rule","stigId":"V-259066","groupId":"V-259066","title":"DPMS Target VMware vSphere 8.0 VCSA Lookup Service","severity":"CAT II","description":"As a rule, accounts on a web server are to be kept to a minimum. Only administrators, web managers, developers, auditors, and web authors require accounts on the machine hosting the web server. The resources to which these accounts have access must also be closely monitored and controlled.","fixText":"At the command prompt, run the following commands:\n\n# chmod o-w <file>\n# chown root:root <file>\n\nNote: Substitute <file> with the listed file.","checkText":"At the command prompt, run the following command:\n\n# find /usr/lib/vmware-lookupsvc/ -xdev -type f -a '(' -perm -o+w -o -not -user root -o -not -group root ')' -exec ls -ld {} \\;\n\nIf any files are returned, this is a finding.","cciIds":["CCI-001813"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-259067r961863_rule","stigId":"V-259067","groupId":"V-259067","title":"DPMS Target VMware vSphere 8.0 VCSA Lookup Service","severity":"CAT II","description":"When Tomcat is installed behind a proxy configured to only allow access to certain contexts (web applications), an HTTP request containing \"/\\../\" may allow attackers to work around the proxy restrictions using directory traversal attack methods. If \"allow_backslash\" is \"true\", the \"\\\" character will be permitted as a path delimiter. The default value for the setting is \"false\", but Tomcat must always be configured as if no proxy restricting context access was used, and \"allow_backslash\" should be set to \"false\" to prevent directory-traversal-style attacks. This setting can create operability issues with noncompliant clients.","fixText":"Navigate to and open:\n\n/usr/lib/vmware-lookupsvc/conf/catalina.properties\n\nUpdate or remove the following line:\n\norg.apache.catalina.connector.ALLOW_BACKSLASH=false\n\nRestart the service with the following command:\n\n# vmon-cli --restart lookupsvc","checkText":"At the command line, run the following command:\n\n# grep ALLOW_BACKSLASH /usr/lib/vmware-lookupsvc/conf/catalina.properties\n\nExample result:\n\norg.apache.catalina.connector.ALLOW_BACKSLASH=false\n\nIf \"org.apache.catalina.connector.ALLOW_BACKSLASH\" is not set to \"false\", this is a finding.\n\nIf the \"org.apache.catalina.connector.ALLOW_BACKSLASH\" setting does not exist, this is not a finding.","cciIds":["CCI-000366"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-259068r961863_rule","stigId":"V-259068","groupId":"V-259068","title":"DPMS Target VMware vSphere 8.0 VCSA Lookup Service","severity":"CAT II","description":"Some clients try to guess the character encoding of text media when the mandated default of ISO-8859-1 should be used. Some browsers will interpret as UTF-7 when the characters are safe for ISO-8859-1. This can create the potential for a XSS attack. To defend against this, enforce_encoding_in_get_writer must be set to true.","fixText":"Navigate to and open:\n\n/usr/lib/vmware-lookupsvc/conf/catalina.properties\n\nUpdate or remove the following line:\n\norg.apache.catalina.connector.response.ENFORCE_ENCODING_IN_GET_WRITER=true\n\nRestart the service with the following command:\n\n# vmon-cli --restart lookupsvc","checkText":"At the command line, run the following command:\n\n# grep ENFORCE_ENCODING_IN_GET_WRITER /usr/lib/vmware-lookupsvc/conf/catalina.properties\n\nExample result:\n\norg.apache.catalina.connector.response.ENFORCE_ENCODING_IN_GET_WRITER=true\n\nIf \"org.apache.catalina.connector.response.ENFORCE_ENCODING_IN_GET_WRITER\" is not set to \"true\", this is a finding.\n\nIf the \"org.apache.catalina.connector.response.ENFORCE_ENCODING_IN_GET_WRITER\" setting does not exist, this is not a finding.","cciIds":["CCI-000366"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-259069r960963_rule","stigId":"V-259069","groupId":"V-259069","title":"DPMS Target VMware vSphere 8.0 VCSA Lookup Service","severity":"CAT II","description":"Tomcat provides management functionality through either a default manager webapp or through local editing of the configuration files. The manager webapp files must be deleted, and administration must be performed through the local editing of the configuration files.","fixText":"At the command prompt, run the following command:\n\n# rm -rf /var/opt/apache-tomcat/webapps/manager","checkText":"At the command prompt, run the following command:\n\n# ls -l /var/opt/apache-tomcat/webapps/manager\n\nIf the manager folder exists or contains any content, this is a finding.","cciIds":["CCI-000381"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-259070r1003622_rule","stigId":"V-259070","groupId":"V-259070","title":"DPMS Target VMware vSphere 8.0 VCSA Lookup Service","severity":"CAT II","description":"Tomcat provides host management functionality through either a default host-manager webapp or through local editing of the configuration files. The host-manager webapp files must be deleted, and administration must be performed through the local editing of the configuration files.","fixText":"At the command prompt, run the following command:\n\n# rm -rf /var/opt/apache-tomcat/webapps/host-manager","checkText":"At the command prompt, run the following command:\n\n# ls -l /var/opt/apache-tomcat/webapps/host-manager\n\nIf the host-manager folder exists or contains any content, this is a finding.","cciIds":["CCI-000381"],"status":"not_reviewed","findingDetails":"","comments":""}]}