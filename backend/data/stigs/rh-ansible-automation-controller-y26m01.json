{"title":"Red Hat Ansible Automation Controller Web Server Security Technical Implementation Guide","description":"This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DOD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents. Comments or proposed revisions to this document should be sent via email to the following address: disa.stig_spt@mail.mil.","version":"2","releaseInfo":"Release: 3 Benchmark Date: 05 Jan 2026","rules":[{"id":"SV-256940r960735_rule","stigId":"V-256940","groupId":"V-256940","title":"DPMS Target Red Hat Ansible Automation Controller Web Server","severity":"CAT II","description":"Session management on client and server is required to protect identity and authorization information. Sessions for the Automation Controller web server, if compromised, could lead to execution of jobs on remote endpoints as if authenticated. Satisfies: SRG-APP-000001-WSR-000002, SRG-APP-000001-WSR-000001, SRG-APP-000295-WSR-000012, SRG-APP-000295-WSR-000134","fixText":"Log in to Automation Controller as an administrator and navigate to Settings >> System >> Miscellaneous Authentication.\r\n\r\nClick \"Edit\".\r\n\r\nSet the following parameters:\r\n\r\nOAuth 2 Timeout Settings < 1800 seconds. \r\n\r\nThe maximum number of simultaneous logged session must equal 0 or the organizationally defined maximum.\r\n\r\nDisable the built-in authentication system = ON\r\n\r\nEnable HTTP Basic Auth = Off\r\n\r\nAccess Token Expiration = 31536000000\r\n\r\nAuthorization Code Expiration = 600\r\n\r\nRefresh Token Expiration = 2628000\r\n\r\nAllow External Users to Create OAuth2 Tokens = Off\r\n\r\nLogin redirect override URL = Not Configured or Blank\r\n\r\nSocial Auth Organization Map = Null\r\n\r\nSocial Auth Team Map = Null\r\n\r\nSocial Auth User Fields = Null\r\n\r\nClick \"Save\".","checkText":"Log in to Automation Controller as an administrator and navigate to Settings >> System >> Miscellaneous Authentication.\r\n\r\nThe following parameters must be set:\r\n\r\nOAuth 2 Timeout Settings < 1800 seconds (No more than 30 minutes). \r\n\r\nThe maximum number of simultaneous logged session must not be less than 0 (The default is -1) and must not match the organizationally defined maximum.\r\n\r\nDisable the built-in authentication system = ON\r\n\r\nEnable HTTP Basic Auth = Off\r\n\r\nOAuth 2 Timeout settings: \r\n\r\n\"ACCESS_TOKEN_EXPIRE_SECONDS\": 31536000000,\r\n \"AUTHORIZATION_CODE_EXPIRE_SECONDS\": 600,\r\n \"REFRESH_TOKEN_EXPIRE_SECONDS\": 2628000\r\n\r\nAllow External Users to Create OAuth2 Tokens = Off\r\n\r\nLogin redirect override URL = Not Configured or Blank\r\n\r\nSocial Auth Organization Map = Null\r\n\r\nSocial Auth Team Map = Null\r\n\r\nSocial Auth User Fields = Null\r\n\r\nIf any of these settings are incorrect, this is a finding.","cciIds":["CCI-000054","CCI-002361"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-256941r1155084_rule","stigId":"V-256941","groupId":"V-256941","title":"DPMS Target Red Hat Ansible Automation Controller Web Server","severity":"CAT II","description":"The Automation Controller communicates information about configuration of other information systems through its web interface and API, storing records about this information in a database. Although large portions are sanitized of sensitive information, due to the nature of this kind of information, it must always be maximally protected. Leaked details of configuration for DOD enterprise information systems could lead to compromise, so all access to and from the Automation Controller servers must be encrypted.","fixText":"Web Server TLS and Cipher Configuration\n\nAs a system administrator for each Automation Controller NGINX web server:\n\n1. Identify the active configuration file:\nNGINXCONF=$(nginx -V 2>&1 | tr ' ' '\\n' | sed -ne '/conf-path/{s/.*conf-path=\\(.*\\)/\\1/;p}')\n\n2. Edit the configuration:\nsudo -e \"$NGINXCONF\"\n\n3. Ensure the ssl_protocols line is configured as (note the leading spaces):\n\"        ssl_protocols TLSv1.2 TLSv1.3;\n\nIf the directive does not exist, add it immediately after the ssl_ciphers line.\n\n4. Ensure the ssl_ciphers line is configured as(note the leading spaces):\n\"        ssl_ciphers PROFILE=SYSTEM;\"\n\n5. Save the file and apply the changes:\nsudo nginx -t && sudo systemctl restart nginx\n\nDatabase TLS Configuration\n\n1. Edit the Ansible Automation Platform installer inventory file and set:\npg_sslmode='verify-full'\npostgres_use_ssl=true\n\n\n2. Reconfigure the controller:\nsudo ./setup.sh","checkText":"1. Web Server Must Enforce TLS 1.2 or Higher\n\nAs a system administrator for each Automation Controller NGINX web server, validate the effective TLS protocol configuration.\n\nObtain the active nginx.conf path:\nNGINXCONF=$(nginx -V 2>&1 | tr ' ' '\\n' | sed -ne '/conf-path/{s/.*conf-path=\\(.*\\)/\\1/;p}')\n\nExecute the following command:\nsudo grep -E '^[[:space:]]*ssl_protocols[[:space:]]+.*(TLSv1\\.2|TLSv1\\.3)' \"$NGINXCONF\" >/dev/null || echo \"FAILED\"\n\n\nPass condition: ssl_protocols includes TLSv1.2 or TLSv1.3.\nFail condition: ssl_protocols missing, or only legacy protocols configured.\n\nIf \"FAILED\" is displayed, this is a finding.\n\n\n2. Web Server Must Use Host OS–Provided Cipher Policy.\n\nValidate the cipher suite binding is set to the system crypto policy.\n\nObtain the active nginx.conf path:\nNGINXCONF=$(nginx -V 2>&1 | tr ' ' '\\n' | sed -ne '/conf-path/{s/.*conf-path=\\(.*\\)/\\1/;p}')\n\n\nExecute the following command:\n\nsudo grep -Eq '^[[:space:]]*ssl_ciphers[[:space:]]+PROFILE=SYSTEM[[:space:]]*;[[:space:]]*$' \"$NGINXCONF\" || echo \"FAILED\"\n\nPass condition: ssl_ciphers PROFILE=SYSTEM; (exact directive, whitespace-tolerant).\n\nIf \"FAILED\" is displayed, this is a finding.\n\n3. External Database Connections Must Use TLS With Certificate Verification.\n\nAutomation Controller may be configured to connect to PostgreSQL databases with or without TLS. The Administrator must check the contents of the file at /etc/tower/conf.d/postgres.py with root permissions to determine if pg_sslmode was configured with \"verify-full\" for any external databases at the time of installation.\n\n3.1 Client-Side\n\nExecute the following command:\nsudo python3 -c 'exec(open(\"/etc/tower/conf.d/postgres.py\").read()); import sys; bad=[n for n,c in DATABASES.items() if c.get(\"HOST\") not in (\"127.0.0.1\",\"localhost\",\"\") and c.get(\"OPTIONS\",{}).get(\"sslmode\")!=\"verify-full\"]; sys.exit(0 if not bad else 1)' || echo \"FAILED\"\n\n\nIf \"FAILED\" is displayed, this is a finding.\n\n3.2 Server-Side\n\nConfirm the database server negotiates TLS.\n\nGet DB host:port for the default connection:\nPGCON=$(sudo python3 -c 'exec(open(\"/etc/tower/conf.d/postgres.py\").read()); import sys; d=DATABASES.get(\"default\",{}); h=d.get(\"HOST\",\"\"); p=d.get(\"PORT\",\"\"); print(f\"{h}:{p}\" if h and p else \"\", end=\"\")')\n\n\nValidate SSL with psql (requires psql client):\n\ntest -n \"$PGCON\" && psql \"postgresql://${PGCON}/postgres?sslmode=require\" -qAt -c '\\conninfo' 2>/dev/null | grep -qi 'SSL connection' || echo \"FAILED\"\n\nIf \"FAILED\" is displayed, this is a finding.","cciIds":["CCI-000068"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-256942r960762_rule","stigId":"V-256942","groupId":"V-256942","title":"DPMS Target Red Hat Ansible Automation Controller Web Server","severity":"CAT II","description":"Nondisplayed data on a web page may expose information that could put the organization at risk and negatively affect data integrity. Automation Controller's web server must be configured such that all connections, regardless of their origin, between the server and the user are encrypted using cryptography.","fixText":"As a System Administrator, locate the inventory file used to install Ansible Automation Platform (usually in the installer directory). Edit this file and ensure the \"nginx_disable_https\" variable is absent or is set to \"false\".\n\nRun the setup.sh command in the installer directory to reconfigure the controller to use the new setting:\n\nsudo ./setup.sh","checkText":"As any user, execute the following command, substituting \"<controller_fqdn>\" for the hostname of the Automation Controller:\r\n\r\ncurl -s -w '%{redirect_url}\\n' -o /dev/null http://<controller_fqdn>/api/v2/ping/  | grep '^https' >/dev/null || echo FAILED\r\n\r\nIf \"FAILED\" is displayed, this is a finding.","cciIds":["CCI-001453"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-256943r960765_rule","stigId":"V-256943","groupId":"V-256943","title":"DPMS Target Red Hat Ansible Automation Controller Web Server","severity":"CAT II","description":"Automation Controller's web server must log all details related to user sessions in support of troubleshooting, debugging, and forensic analysis. Without a data logging feature, the organization loses an important auditing and analysis tool for event investigations. Satisfies: SRG-APP-000016-WSR-000005, SRG-APP-000095-WSR-000056, SRG-APP-000096-WSR-000057, SRG-APP-000097-WSR-000058, SRG-APP-000098-WSR-000059, SRG-APP-000098-WSR-000060, SRG-APP-000099-WSR-000061, SRG-APP-000100-WSR-000064","fixText":"As a System Administrator, for each Automation Controller host, navigate to console Settings >> System >> Miscellaneous System.\r\n\r\nClick \"Edit\".\r\n\r\nSet the following:\r\nEnable Activity Stream = On\r\n\r\nEnable Activity Stream for Inventory Sync = On\r\n\r\nOrganization Admins Can Manage Users and Teams = On\r\n\r\nAll Users Visible to Organization Admins = On\r\n\r\nClick \"Save\".","checkText":"For each Automation Controller host, determine whether the web server is logging all content related to user sessions.\n\nLog in to Automation Controller as an administrator and navigate to console Settings >> System >> Miscellaneous System.\n\nVerify the following settings:\n\nEnable Activity Stream = On\n\nEnable Activity Stream for Inventory Sync = On\n\nOrganization Admins Can Manage Users and Teams = On\n\nAll Users Visible to Organization Admins = On\n\nIf the configuration settings are not as above, this is a finding.","cciIds":["CCI-000067","CCI-000130","CCI-000131","CCI-000132","CCI-000133","CCI-000134","CCI-001487"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-256944r1016556_rule","stigId":"V-256944","groupId":"V-256944","title":"DPMS Target Red Hat Ansible Automation Controller Web Server","severity":"CAT I","description":"Being able to verify that a patch, upgrade, certificate, etc., being added to the web server is unchanged from the producer of the file is essential for file validation and nonrepudiation of the information. The Automation Controller NGINX web server host must have a mechanism to verify that files are valid prior to installation.","fixText":"As a System Administrator, for each Automation Controller NGINX web server host, check for existing or install AIDE:\n\nyum install -y aide\n\nCreate or update the AIDE database immediately after initial installation of each Automation Controller NGINX web server host:\n\naide --init && mv /var/lib/aide/aide.db.new.gz  /var/lib/aide/aide.db.gz\n\nAccept any expected changes to the host by updating the AIDE database:\n\naide --update\n\nThe output will provide checksums for the AIDE database. Save in a protected location.","checkText":"As a System Administrator, for each Automation Controller NGINX web server host, verify the integrity of the Automation Controller NGINX web server hosts files:\n\naide --check\n\nVerify the displayed checksums against previously reserved checksums of the Advanced Intrusion Detection Environment (AIDE) database.\n\nIf there are any unauthorized or unexplained changes against previous checksums, this is a finding.","cciIds":["CCI-003992","CCI-001749"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-256945r1016557_rule","stigId":"V-256945","groupId":"V-256945","title":"DPMS Target Red Hat Ansible Automation Controller Web Server","severity":"CAT II","description":"In the case of a production web server, areas for content development and testing will not exist, as this type of content is only permissible on a development website. The process of developing on a functional production website entails a degree of trial and error and repeated testing. This process is often accomplished in an environment where debugging, sequencing, and formatting of content are the main goals. The opportunity for a malicious user to obtain files that reveal business logic and login schemes is high in this situation. The existence of such immature content on a web server represents a significant security risk that is totally avoidable. The Automation Controller NGINX front-end web server must enforce, either internally or through an external utility, the signing of modules before they are implemented into a production environment. By signing modules, the author guarantees that the module has been reviewed and tested before production implementation.","fixText":"As a system administrator for each Automation Controller NGINX web server host, execute the following:\n\nNGINXCONF=`nginx -V 2>&1 | tr ' ' '\\n' | sed -ne '/conf-path/{s/.*conf-path=\\(.*\\)/\\1/;p}' `\nNGINXMODPATH=`nginx -V 2>&1 | tr ' ' '\\n' | grep modules-path | sed -ne '/modules-path/{s/.*modules-path=\\(.*\\)/\\1/;p}'`\nNGINXMODINC=`grep include /etc/nginx/nginx.conf | grep modules | awk '{print $2}' | xargs dirname`\nsudo rm -f ${NGINXMODPATH}/*\nsudo rm -f ${NGINXMODINC}/*\nsudo -e ${NGINXCONF}\n\nIn the editor, remove any lines that contain \"load_module\".\n\nSave the file and exit the text editor. Run the following command to apply the changes:\n\nsudo systemctl restart nginx","checkText":"The Automation Controller does not require any nginx dynamic expansion modules to function. Determine if any dynamic modules are specified in the nginx configuration.\n\nAs a system administrator for each Automation Controller NGINX web server host, execute the following:\n\nNGINXCONF=`nginx -V 2>&1 | tr ' ' '\\n' | sed -ne '/conf-path/{s/.*conf-path=\\(.*\\)/\\1/;p}' `\nNGINXMODPATH=`nginx -V 2>&1 | tr ' ' '\\n' | grep modules-path | sed -ne '/modules-path/{s/.*modules-path=\\(.*\\)/\\1/;p}'`\nNGINXMODINC=`grep include /etc/nginx/nginx.conf | grep modules | awk '{print $2}' | xargs dirname`\ngrep -q load_module ${NGINXCONF} && echo FAILED\n[ `ls -1 $NGINXMODPATH | wc -l` == 0 ]  || echo FAILED\n[ `ls -1 $NGINXMODINC | wc -l` == 0 ]  || echo FAILED\n\nIf \"FAILED\" is displayed, this is a finding.","cciIds":["CCI-003992","CCI-001749"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-256946r960963_rule","stigId":"V-256946","groupId":"V-256946","title":"DPMS Target Red Hat Ansible Automation Controller Web Server","severity":"CAT II","description":"Web servers require enterprise-wide user management capability in order to prevent unauthorized access, with features like attempt lockouts and password complexity requirements. Unauthorized access to the web server makes the web server and the organization vulnerable to attack. Note: The underlying NGINX web server does not perform user management or authentication. The Automation Controller includes user management and authentication capabilities. However, the user management controls built into Automation Controller may not be sufficient to enforce the appropriate level of password, sessions, and other policies required. It is strongly recommended that Automation Controller be configured to use the organization's Identity Management/Authentication Service. This may be an AD/LDAP service, OIDC, or other supported authentication service.","fixText":"As a system administrator for each Automation Controller NGINX web server host, navigate to Settings >> Authentication.\n\nConfigure the appropriate authentication service.","checkText":"As a system administrator for each Automation Controller NGINX web server host, navigate to Settings >> Authentication.\n\nReview the configuration and verify that the appropriate authentication service is configured.\n\nIf no authentication service is configured, this is a finding.","cciIds":["CCI-000381"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-256947r960963_rule","stigId":"V-256947","groupId":"V-256947","title":"DPMS Target Red Hat Ansible Automation Controller Web Server","severity":"CAT II","description":"The Automation Controller NGINX web server must be primarily a web server or a proxy server but not both, for the same reasons that other multi-use servers are not recommended. Scanning for web servers that will also proxy requests into an otherwise protected network is a very common anonymous attack. In a scenario where Automation Controller is still reachable without use of the proxy/load balancer or when the proxy does not validate the header, X-Forwarded-For can be spoofed fairly easily to fake the originating IP addresses. Using HTTP_X_FORWARDED_FOR in the REMOTE_HOST_HEADERS setting poses a vulnerability that essentially gives users access to certain resources that they must not have. Satisfies: SRG-APP-000141-WSR-000076, SRG-APP-000141-WSR-000083, SRG-APP-000141-WSR-000087","fixText":"As a System Administrator, remove any content present and served from the static content location (/var/lib/awx/public/static) that is not acceptable per organizationally defined policy.\n\nRun the setup.sh command in the Ansible Automation Platform installer directory to reconfigure the controller to the default state, which only contains the required configuration:\n\nsudo ./setup.sh","checkText":"As a system administrator for each Automation Controller NGINX web server host, ensure that the only upstream servers configured are for the Automation Controller ASGI and WSGI modules:\r\n\r\nNGINXCONF=`nginx -V 2>&1 | tr ' ' '\\n' | sed -ne '/conf-path/{s/.*conf-path=\\(.*\\)/\\1/;p}' `\r\nsudo grep -E 'proxy_pass|uwsgi_pass' $NGINXCONF | grep -Pqz '^\\s+proxy_pass http://daphne;\\n\\s+uwsgi_pass uwsgi;\\n$' || echo FAILED\r\n[ \"`sudo grep -Pzo 'upstream\\s+daphne\\s+{[^}]+}' $NGINXCONF | grep -a server | grep -v 'server unix:/var/run/tower/daphne.sock;'`\" == '' ] || echo FAILED\r\n[ \"`sudo grep -Pzo 'upstream\\s+uwsgi\\s+{[^}]+}' $NGINXCONF | grep -a server | grep -v 'server unix:/var/run/tower/uwsgi.sock;'`\" == '' ] || echo FAILED\r\n\r\nIf \"FAILED\" is displayed, this is a finding.\r\n\r\nEnsure all locations are served by either these upstream servers or other well-known content:\r\n\r\n[ \"`sudo grep location $NGINXCONF | grep -v '^\\s*#' | grep -Ev '^\\s+location\\s+/(favicon.ico|static|websocket)?\\s+{'`\" == \"\" ] || echo \"FAILED\"\r\nsudo grep -Eq 'location\\s+/favicon.ico\\s+{\\s+alias\\s+/var/lib/awx/public/static/media/favicon.ico;\\s+}' $NGINXCONF || echo \"FAILED\"\r\nsudo grep -Eq 'location\\s+/static\\s+{\\s+alias\\s+/var/lib/awx/public/static;\\s+}' $NGINXCONF || echo \"FAILED\"\r\nsudo grep -Pzo 'location\\s+/websocket\\s+({([^{}]|(?1))*})' $NGINXCONF | grep -Eq '^\\s+proxy_pass\\s+http://daphne;' || echo \"FAILED\"\r\nsudo grep -Pzo 'location\\s+/\\s+({([^{}]|(?1))*})' $NGINXCONF | grep -Eq '^\\s+uwsgi_pass\\s+uwsgi;' || echo \"FAILED\"\r\n\r\nIf \"FAILED\" is displayed, this is a finding.\r\n\r\nVerify the content present and served from the static content location (/var/lib/awx/public/static) is acceptable per organizationally defined policy.\r\n\r\nIf any content present in this location (or its subdirectories) is not acceptable per organizationally defined policy, this is a finding.","cciIds":["CCI-000381"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-256948r960963_rule","stigId":"V-256948","groupId":"V-256948","title":"DPMS Target Red Hat Ansible Automation Controller Web Server","severity":"CAT II","description":"If web server accounts are not being used, they must be deleted when the web server is uninstalled. This is because the accounts become stale over time and are not tended to. Best practice also dictates that if accounts are not going to be used, they must not be created for the same reason. Both situations create an opportunity for web server exploitation. When accounts used for web server features such as documentation, sample code, example applications, tutorials, utilities, and services are created, even though the feature is not installed, they become an exploitable threat to a web server. These accounts become inactive and are not monitored through regular use, and passwords for the accounts are not created or updated. An attacker can use these accounts to gain access to the web server and begin investigating ways to elevate the account privileges. The accounts used for all Automation Controller NGINX web server features not installed must not be created and must be deleted when these features are uninstalled.","fixText":"As a System Administrator for each Automation Controller NGINX web server, reinstall Automation Controller if no \"nginx\" users exist in /etc/passwd.\n\nReview all users enumerated in /etc/passwd, and remove any that are not attributable to RHEL or Automation Controller and/or organizationally disallowed.","checkText":"As a System Administrator for each Automation Controller NGINX web server, examine NGINX users in /etc/passwd.\n\nVerify a single user \"nginix\" exists using the command:\n\n[ `grep -c nginx /etc/passwd` == 1 ] || echo FAILED\n\nIf \"FAILED\" is displayed, this is a finding.","cciIds":["CCI-000381"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-256949r1155087_rule","stigId":"V-256949","groupId":"V-256949","title":"DPMS Target Red Hat Ansible Automation Controller Web Server","severity":"CAT II","description":"Controlling what a user of a hosted application can access is part of the security posture of the Automation Controller NGINX web server. Any time a user can access more functionality than is needed for the operation of the hosted application, it poses a security issue. A user with too much access can view information that is not needed for the user's job role, or the user could use the function in an unintentional manner. A MIME tells the Automation Controller NGINX web servers what type of program various file types and extensions are and what external utilities or programs are needed to execute the file type. A shell is a program that serves as the basic interface between the user and the operating system, so hosted application users must not have access to these programs. Shell programs may execute shell escapes and can then perform unauthorized activities that could damage the security posture of Automation Controller.","fixText":"As an SA for each Automation Controller NGINX web server, remove the disallowed mime types:\n\nNGINXCONF=`nginx -V 2>&1 | tr ' ' '\\n' | sed -ne '/conf-path/{s/.*conf-path=\\(.*\\)/\\1/;p}' ` ; \nMIME_TYPES=`grep mime $NGINXCONF | awk '{printf $2}' | sed 's/;$//' ` ;\n disallowed_mime_types=('application.*\\sbin' 'application.*\\sexe' 'application.*\\srpm' 'application.*\\smsi' 'application.*\\smsp application.*\\smsm') ; \necho \"${disallowed_mime_types[*]}\" | tr ' ' '\\n' >tempfile ; cat $MIME_TYPES | grep -vf tempfile >$MIME_TYPES; rm -f tempfile\n\nRestart NGINX.","checkText":"As a system administrator (SA) for each Automation Controller NGINX web server, check the allowed mime types and associated shell applications:\n\nNGINXCONF=`nginx -V 2>&1 | tr ' ' '\\n' | sed -ne '/conf-path/{s/.*conf-path=\\(.*\\)/\\1/;p}' ` ; MIME_TYPES=`grep mime $NGINXCONF | awk '{printf $2}' | sed 's/;$//' ` ; disallowed_mime_types=('application.*\\sbin' 'application.*\\sexe' 'application.*\\srpm' 'application.*\\smsi' 'application.*\\smsp application.*\\smsm' ) ; echo \"${disallowed_mime_types[*]}\" | tr ' ' '\\n' >tempfile ; cat $MIME_TYPES | grep -f tempfile 1>/dev/null && echo \"FAILED\"; rm -f tempfile\n\nIf \"FAILED\" is displayed, this is a finding.","cciIds":["CCI-000381"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-256950r960963_rule","stigId":"V-256950","groupId":"V-256950","title":"DPMS Target Red Hat Ansible Automation Controller Web Server","severity":"CAT II","description":"Automation Controller NGINX web servers can be installed with functionality that, just by its nature, is not secure. Web Distributed Authoring (WebDAV) is an extension to the HTTP protocol that, when developed, was meant to allow users to create, change, and move documents on a server, typically a web server or web share. Allowing this functionality, development, and deployment is much easier for web authors. WebDAV is not widely used and has serious security concerns because it may allow clients to modify unauthorized files on the web server.","fixText":"As a system administrator, for each Automation Controller nginx web server host, remove all WebDAV modules from the NGINX configuration file (nominally /etc/nginx/nginx.conf).\n\nReload the NGINX server configurations for all NGINX processes:\n\n$ pkill -HUP nginx","checkText":"As a system administrator, for each Automation Controller NGINX web server host, check the Automation Controller NGINX web server configuration for WebDAV modules:\n\ndisallowed_modules=(nginx-dav-ext-module headers-more-nginx-module) ; echo \"${disallowed_modules[*]}\" | tr ' ' '\\n' >tempfile ; nginx -V 2>&1 | grep module | tr ' ' '\\n' | grep module | grep -v modules-path | grep -Ff tempfile && echo \"FAILED\"; rm -f tempfile\n\nIf \"FAILED\" is displayed, this is a finding.\n\nCheck the Automation Controller NGINX web server configuration for WebDAV modules for disallowed WebDAV verbs, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK:\n\nNGINXCONF=`nginx -V 2>&1 | tr ' ' '\\n' | sed -ne '/conf-path/{s/.*conf-path=\\(.*\\)/\\1/;p}' ` ;\ngrep dev_(.*)methods $NGINXCONF | grep  'COPY|MOVE|MKCO|PROPFIND|PROPPATCH|LOCK|UNLOCK' && echo 'FAILED'\n\nIf \"FAILED\" is displayed, this is a finding.","cciIds":["CCI-000381"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-256951r960963_rule","stigId":"V-256951","groupId":"V-256951","title":"DPMS Target Red Hat Ansible Automation Controller Web Server","severity":"CAT III","description":"Automation Controller NGINX web servers may host too many applications. Each application will need certain system resources and privileged operations to operate correctly. The Automation Controller NGINX web servers must be configured to contain and control the applications and protect the system resources and privileged operations from those not needed by the application for operation. Not limiting the application will exacerbate the potential harm a compromised application could cause to a system.","fixText":"As a system administrator for each Automation Controller NGINX web server host, place the server in SELinux enforcing mode:\n\nsetenforce 1","checkText":"As a system administrator for each Automation Controller NGINX web server host, check if SELinux is enabled in enforcing mode:\n\ngetenforce | grep Enforcing  >/dev/null || echo FAILED\n\nIf \"FAILED\" is displayed, this is a finding.","cciIds":["CCI-000381"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-256952r1043177_rule","stigId":"V-256952","groupId":"V-256952","title":"DPMS Target Red Hat Ansible Automation Controller Web Server","severity":"CAT II","description":"From a security perspective, it is important that all Automation Controller NGINX web servers are configured to use a specified IP address and port because “listening” on all IP addresses poses a vulnerability to the web server. Not confining the web server to a specified IP address and port puts all web server content at risk of access by bad actors wanting to take advantage of those resources.","fixText":"As a System Administrator for each Automation Controller NGINX web server host, identify the allowed and/or designated IP address(es) for the Automation Controller system.\n\nReplace any wildcard or ranged IP address references in the NGINX configuration with IP addresses from the pool of allowed and/or designated address.\n\nReload the NGINX server configurations for all NGINX processes:\n\n$ pkill -HUP nginx","checkText":"As a System Administrator for each Automation Controller NGINX web server host, verify the web server is configured to use a static IP address and port.\r\n\r\nNGINXCONF=`nginx -V 2>&1 | tr ' ' '\\n' | sed -ne '/conf-path/{s/.*conf-path=\\(.*\\)/\\1/;p}' ` ; grep '^\\s*listen\\s*\\*\\|\\s*listen\\s*\\[.*\\]\\|\\s*listen\\s*0\\.0\\.0\\.0\\|\\s*listen\\s*\\[.*\\]|^\\s*listen\\s\\+.*:[^[:digit:]\\s]\\+.*' $NGINXCONF && echo FAILED\r\n\r\nIf \"FAILED\" is displayed, this is a finding.","cciIds":["CCI-000382"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-256953r961041_rule","stigId":"V-256953","groupId":"V-256953","title":"DPMS Target Red Hat Ansible Automation Controller Web Server","severity":"CAT II","description":"Each Automation Controller NGINX web server's private key is used to prove the identity of the server to clients and securely exchange the shared secret key used to encrypt communications between the Automation Controller NGINX web server and clients. By gaining access to the private key, an attacker can pretend to be an authorized server and decrypt the SSL traffic between a client and the Automation Controller NGINX web server.","fixText":"As a System Administrator for each Automation Controller NGINX web server host, set the permissions:\n\nNGINXCONF=`nginx -V 2>&1 | tr ' ' '\\n' | sed -ne '/conf-path/{s/.*conf-path=\\(.*\\)/\\1/;p}' `\nTOWER_KEY=`sed -n 's/^\\s*ssl_certificate_key\\s*\\(.*\\);/\\1/p' $NGINXCONF`\nsudo chown root:awx $TOWER_KEY\nsudo chmod 600 $TOWER_KEY","checkText":"As a System Administrator for each Automation Controller NGINX web server host, verify the location of the NGINX configuration:\r\n\r\nNGINXCONF=`nginx -V 2>&1 | tr ' ' '\\n' | sed -ne '/conf-path/{s/.*conf-path=\\(.*\\)/\\1/;p}' `\r\nTOWER_KEY=`sed -n 's/^\\s*ssl_certificate_key\\s*\\(.*\\);/\\1/p' $NGINXCONF`\r\nstat -c \"%a %U %G\" $TOWER_KEY| grep \"600 root awx\" || echo \"FAILED\" \r\n\r\nIf \"FAILED\" is displayed, this is a finding.","cciIds":["CCI-000186"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-256954r1138072_rule","stigId":"V-256954","groupId":"V-256954","title":"DPMS Target Red Hat Ansible Automation Controller Web Server","severity":"CAT II","description":"AIT is important to limit access to Automation Controller nginx web servers and provide access on a need-to-know basis. For example, only System Administrators must have access to all the system's capabilities, while the web administrator and associated staff require access and control of the web content and Automation Controller NGINX web server configuration files. Without close monitoring and control over access to the web server and its resources, there is the risk of unskilled personnel making mistakes, and a risk of characters performing malicious acts.","fixText":"As a System Administrator for each Automation Controller NGINX web server host, enumerate all (nonroot) privileged users on the system:\n\ngetent passwd | cut -f1 -d ':' | sudo xargs -L1 sudo -l -U | grep -v 'not allowed' | tail -n +3 | sed -n '/^User/s/User\\s*\\(\\w*\\).*/\\1/p' | grep -v root\n\nFor each user shown, perform one of the following actions:\n- Remove the indicated user from the system;\n- Remove the indicated user from any privileged groups (wheel);\n- Remove login access for the user;\n- Verify via organizationally defined procedures the indicated user is an authorized administrative account.","checkText":"As a system administrator for each Automation Controller NGINX web server host, enumerate all (nonroot) privileged users on the system:\r\n\r\nallowed_privileged_users=('root') ; echo \"${allowed_privileged_users}\" | tr ' ' '\\n' >/tmp/allowed_privileged_users ; getent passwd | cut -f1 -d ':' | sudo xargs -L1 sudo -l -U | grep -v 'not allowed' | tail -n +3 | sed -n '/^User/s/User\\s*\\(\\w*\\).*/\\1/p' | grep -v -f /tmp/allowed_privileged_users 1>/dev/null && echo \"FAILED\" ; rm -f /tmp/allowed_privileged_users\r\n\r\nIf \"FAILED\" is displayed, this is a finding.","cciIds":["CCI-001082"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-256955r1043180_rule","stigId":"V-256955","groupId":"V-256955","title":"DPMS Target Red Hat Ansible Automation Controller Web Server","severity":"CAT II","description":"It is important that cookies exchanged between any Automation Controller NGINX webserver and any client have security settings that do not allow cookie access outside the originating Automation Controller server and the hosted application. This is because exchanged cookies may have session information such as user credentials that enable the web server application and the client to maintain a persistent connection. If cookie access outside of the originating Automation Controller NGINX webserver and the hosted application are allowed, it puts the security of the server at risk of malicious acts by bad actors. Satisfies: SRG-APP-000223-WSR-000011, SRG-APP-000439-WSR-000154, SRG-APP-000439-WSR-000155","fixText":"As a System Administrator for each Automation Controller NGINX web server host, remove any local variable changes related to cookie properties:\n\nsudo grep -r -E '(CSRF|SESSION)_COOKIE_(HTTPONLY|SECURE|SAMESITE)' /etc/tower/settings.py /etc/tower/conf.d/\n\nFor each result, edit the relevant file. For example, if a variable is found in /etc/tower/settings.py, edit the file with the following command:\n\nsudo -e /etc/tower.settings.py\n\nRemove any line where the following variables are defined:\n\nSESSION_COOKIE_HTTPONLY\nSESSION_COOKIE_SECURE\nSESSION_COOKIE_SAMESITE\nCSRF_COOKIE_HTTPONLY\nCSRF_COOKIE_SECURE\nCSRF_COOKIE_SAMESITE\n\nExecute the following command to restart the Automation Controller service:\n\nsudo automation-controller-service restart","checkText":"The Automation Controller application configures cookie properties appropriately by default. Any local modifications to cookie-related settings must be located and removed.\n\nAs a System Administrator for each Automation Controller NGINX web server host, search for modified cookie variables in the Automation Controller configuration:\n\nsudo grep -r -E '(CSRF|SESSION)_COOKIE_(HTTPONLY|SECURE|SAMESITE)' /etc/tower/settings.py /etc/tower/conf.d/\n\nIf any output is shown, this is a finding.","cciIds":["CCI-001664","CCI-002418"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-256956r961131_rule","stigId":"V-256956","groupId":"V-256956","title":"DPMS Target Red Hat Ansible Automation Controller Web Server","severity":"CAT II","description":"It is important that Automation Controller NGINX web server restricts the ability of clients to launch denial-of-service (DoS) attacks against other information systems or networks by disallowing access to system files via document and system file partitioning. DoS attacks are an attempt to negatively affect the availability of the server to end users through directory traversal and URL manipulation. An attack could compromise the end user’s access to websites and applications, which could be critical. If a client is allowed to enable a DoS attack through access to system files, it means that the whole server or network could be shut down. In a best-case scenario, it could deny the user access to required websites and applications, which poses a threat to productivity as well as the need to spend time researching and resolving the attack. This is why it is important that Automation Controller NGINX web server does not allow access to any system files.","fixText":"As a System Administrator for each Automation Controller NGINX web server host, migrate the \"/var/lib/awx/public\" path onto a separate file system. No automated fix is available for this action.","checkText":"Automation Controller serves static public content from the directory /var/lib/awx/public.\r\n\r\nAs a System Administrator for each Automation Controller NGINX web server host, verify that a separate file system/partition has been created for /var/lib/awx/public:\r\n\r\n[[ $(sudo awk '$0~\"/var/lib/awx/public\" {print $2}' /etc/fstab) == \"/var/lib/awx/public\" ]] || echo \"FAILED\"\r\n\r\nIf \"FAILED\" is displayed, this is a finding.","cciIds":["CCI-001084"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-256957r1155090_rule","stigId":"V-256957","groupId":"V-256957","title":"DPMS Target Red Hat Ansible Automation Controller Web Server","severity":"CAT II","description":"It is important that Automation Controller NGINX web server limit the character set used for data entry and disallow Unicode use in hosted applications to avoid application compromise. Definition of the available character set for data entry can trap efforts to bypass security checks. The presence of nonstandard characters may cause the browser to interpret the content using a different character set than the defined one, because the system may interpret the content using a different CHARSET. Nonstandard encodings like UTF-7 can be used to bypass the application's defensive filters. If character sets for data entry are not defined, it leaves open the door for attackers to bypass security checks and make the server vulnerable to malicious attack.","fixText":"As an SA for each Automation Controller NGINX web server, verify the NGINX web server configuration file in use is located at '/etc/nginx/nginx.conf'\n\nNGINXCONF=`nginx -V 2>&1 | tr ' ' '\\n' | sed -ne '/conf-path/{s/.*conf-path=\\(.*\\)/\\1/;p}' ` ; \n\nAdd the directive to the NGINX configuration to force a required charset.\n\nsed -i  '/location/i charset_required; ' $NGINXCONF\n\nReload the NGINX server configurations for all NGINX processes.\n\n$ pkill -HUP nginx","checkText":"As a system administrator (SA) for each Automation Controller NGINX web server, verify the configuration requires a charset is mandatory.\n\ngrep 'charset_required' \"$(nginx -V 2>&1 | tr ' ' '\\n' | sed -ne '/conf-path/{s/.*conf-path=\\(.*\\)/\\1/;p}')\" || echo \"FAILED\"\n\nIf \"FAILED\" is displayed, this is a finding.","cciIds":["CCI-001310"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-256958r961167_rule","stigId":"V-256958","groupId":"V-256958","title":"DPMS Target Red Hat Ansible Automation Controller Web Server","severity":"CAT II","description":"It is important that Automation Controller NGINX web server display a default hosted application web paged and not a directory listing when a requested web page cannot be found, because the web server will be vulnerable to intrusion. For this reason, access to directory listings must be disabled. If a user or attacker have access to the website directory listing, they may have access to all the files in that folder. Additionally, they may be privy to specific details regarding the web server.","fixText":"As a System Administrator for each Automation Controller nginx web server host, remove any configuration that turns the autoindexing on:\n\nNGINXCONF=`nginx -V 2>&1 | tr ' ' '\\n' | sed -ne '/conf-path/{s/.*conf-path=\\(.*\\)/\\1/;p}' ` ;\nsed -Ei -e '/autoindex\\s+on/d;' $NGINXCONF\n\nTo apply these changes to the running service immediately, restart the NGINX service with the following command:\n\nsudo systemctl restart nginx","checkText":"For each Automation Controller NGINX web server, a system administrator must view to see whether autoindex is turned on or off (autoindex on/autoindex off):\r\n\r\nNGINXCONF=`nginx -V 2>&1 | tr ' ' '\\n' | sed -ne '/conf-path/{s/.*conf-path=\\(.*\\)/\\1/;p}' ` ; \r\ngrep -E 'autoindex\\s+on' $NGINXCONF && echo \"FAILED\"\r\n \r\nIf \"FAILED\" is displayed, this is a finding.","cciIds":["CCI-001312"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-256959r961167_rule","stigId":"V-256959","groupId":"V-256959","title":"DPMS Target Red Hat Ansible Automation Controller Web Server","severity":"CAT II","description":"It is important that Automation Controller NGINX web server debugging and trace information used to diagnose the web server is disabled, because debugging information can yield information about the Automation Controller NGINX webserver, like web server type, version, patches installed, plugins, modules, the hosted app’s code type. Back ends used for storage could be revealed, as well. An attacker would not need to cause an error condition to gain this information because they could reside in logs and general messages. If debugging/trace information is enabled, attackers could get the information from logs and general information, without drawing attention to themselves via an error message.","fixText":"For each Automation Controller NGINX web server, a system administrator must complete the following steps. \n\nVerify the NGINX configuration file in use:\n\nNGINXCONF=`nginx -V 2>&1 | tr ' ' '\\n' | sed -ne '/conf-path/{s/.*conf-path=\\(.*\\)/\\1/;p}' ` ;  echo $NGINXCONF\n\nRemove the error_log directive from the NGINX configuration file.\n\nCause NGINX to reload its configuration file:\n\npkill -HUP nginx","checkText":"For each Automation Controller NGINX web server, a system administrator must check to determine if any error or debug information is being logged or generated:\n\nNGINXCONF=`nginx -V 2>&1 | tr ' ' '\\n' | sed -ne '/conf-path/{s/.*conf-path=\\(.*\\)/\\1/;p}' ` ;  cat $NGINXCONF  | grep '^\\s*error_log' && echo FAILED\n\nIf \"FAILED\" is displayed, this is a finding.","cciIds":["CCI-001312"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-256960r961353_rule","stigId":"V-256960","groupId":"V-256960","title":"DPMS Target Red Hat Ansible Automation Controller Web Server","severity":"CAT II","description":"It is important that Automation Controller NGINX web server security features are separated from nonprivileged users. Special “privileged” roles need to be developed so that only they can have access to those features and administer the web server, when necessary. These privileged roles will be better trained in the security features and will limit loss of data for forensic analysis and limits accidental changes to the web server. Without isolating privileged users from nonprivileged users when administering to the web server, organizations run the risk of having limited access to forensic data, as well as increased risk of accidental changes, by nonprivileged and presumably less-trained individuals. Satisfies: SRG-APP-000340-WSR-000029, SRG-APP-000211-WSR-000031","fixText":"As a system administrator, for each Automation Controller NGINX web server host, set the permissions and owner of Automation Controller web server program configuration directory:\n\nsudo chown -R root:root /etc/nginx/\nsudo chmod 755 /etc/nginx /etc/nginx\nsudo chmod 755 /etc/nginx /etc/nginx/conf.d\nsudo chmod 644 /etc/nginx/nginx.conf\n \nAs a system administrator, for each Automation Controller NGINX web server program configuration files.\n\nsudo chown root:root /usr/lib/systemd/system/nginx.service\nsudo chmod 644 /usr/lib/systemd/system/nginx.service\n \nSet the permissions and owner of Automation Controller application content directory:\n\nsudo chmod 755 /var/lib/awx/public/static\nsudo chown root:awx /var/lib/awx/public/static","checkText":"As a system administrator, for each Automation Controller NGINX web server host, inspect the current permissions and owner of Tower's web server configuration directory:\r\n\r\nstat -c \"%a %U %G\" /etc/nginx | grep -q \"755 root root\" || echo \"FAILED\"\r\nstat -c \"%a %U %G\" /etc/nginx/conf.d | grep -q \"755 root root\" || echo \"FAILED\"\r\nstat -c \"%a %U %G\" /etc/nginx/nginx.conf | grep -q \"644 root root\" || echo \"FAILED\"\r\n \r\nIf \"FAILED\" is displayed, this is a finding.\r\n\r\nInspect the current permissions and owner of Automation Controller web server program configuration files:\r\n\r\nstat -c \"%a %U %G\" /usr/lib/systemd/system/nginx.service | grep -q \"644 root root\" || echo \"FAILED\"\r\n \r\nIf \"FAILED\" is displayed, this is a finding.\r\n \r\nInspect the current permissions and owner of Automation Controller application content directory:\r\n\r\nstat -c \"%a %U %G\" /var/lib/awx/public/static | grep -q \"755 root awx\" || echo \"FAILED\"\r\n \r\nIf \"FAILED\" is displayed, this is a finding.\r\n \r\nInspect the current permissions and owner of Automation Controller web server log directory:\r\n\r\nstat -c \"%a %U %G\" /var/log/nginx| grep -q \"770 nginx root\" || echo \"FAILED\"\r\n \r\nIf \"FAILED\" is displayed, this is a finding.","cciIds":["CCI-001082","CCI-002235"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-256961r961461_rule","stigId":"V-256961","groupId":"V-256961","title":"DPMS Target Red Hat Ansible Automation Controller Web Server","severity":"CAT II","description":"Automation Controller NGINX web servers can be modified through parameter modification, patch installation, upgrades to the web server or modules, and security parameter changes. With each of these changes, there is the potential for an adverse effect such as a DoS, web server instability, or hosted application instability. To limit changes to Automation Controller NGINX web servers and limit exposure to any adverse effects from the changes, files such as the web server application files, libraries, and configuration files must have permissions and ownership set properly to only allow privileged users access.","fixText":"As a System Administrator for each Automation Controller NGINX web server host, modify the file permissions for the web server components require privileged access:\n\nchmod -R 644 /etc/nginx && chown -R nginx /etc/nginx","checkText":"As a System Administrator for each Automation Controller NGINX web server host, check that the file permissions for the web server components require privileged access:\n\n$ [ `find /etc/nginx -type f -not -perm 644 | wc -l` -gt 0 ] && echo \"FAILED\"\n\nIf \"FAILED\" is displayed, this is a finding.","cciIds":["CCI-001813"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-256962r961620_rule","stigId":"V-256962","groupId":"V-256962","title":"DPMS Target Red Hat Ansible Automation Controller Web Server","severity":"CAT II","description":"An attacker has at least two reasons to stop an Automation Controller NGINX web server. The first is to cause a DoS, and the second is to put in place changes the attacker made to an Automation Controller NGINX web server configuration. To prohibit an attacker from stopping the Automation Controller NGINX web server, the process ID (PID) of the web server and the utilities used to start/stop the web server must be protected from access by nonprivileged users. By knowing the PID and having access to the Automation Controller NGINX web server utilities, a nonprivileged user has a greater capability of stopping the server, whether intentionally or unintentionally.","fixText":"As a System Administrator for each Automation Controller NGINX web server host, set the permissions correctly on the nginx service file:\n\nsudo chown root:root /usr/lib/systemd/system/nginx.service\nsudo chmod 644 /usr/lib/systemd/system/nginx.service\n\nReset the Ansible Automation Platform configuration to the defaults, which meet the requirements for the supervisord and automation-controller services.\n\nLocate the inventory file used to install Ansible Automation Platform (usually in the installer directory).\n\nRun the setup.sh command in the installer directory to reconfigure the controller to use the new setting:\n\nsudo ./setup.sh","checkText":"As a System Administrator for each Automation Controller NGINX web server host, verify required service definition is protected from unprivileged users:\r\n\r\nstat -c \"%a %U %G\" /usr/lib/systemd/system/automation-controller.service | grep -q \"644 root root\" || echo \"FAILED\"\r\nstat -c \"%a %U %G\" /usr/lib/systemd/system/supervisord.service | grep -q \"644 root root\" || echo \"FAILED\"\r\nstat -c \"%a %U %G\"  /usr/lib/systemd/system/nginx.service | grep -q \"644 root root\" || echo \"FAILED\"\r\n\r\nIf \"FAILED\" is displayed, this is a finding.\r\n\r\nVerify the required services are enabled:\r\n\r\nsystemctl is-enabled automation-controller.service >/dev/null || echo FAILED\r\nsystemctl is-enabled supervisord.service >/dev/null || echo FAILED\r\nsystemctl is-enabled nginx.service >/dev/null || echo FAILED\r\n\r\nIf \"FAILED\" is displayed, this is a finding.\r\n\r\nVerify application services are correctly managed by supervisord. Verify protection of and capture supervisord configuration.\r\n\r\nstat -c \"%a %U %G\" /etc/supervisord.d/*.ini | grep -q \"644 root root\" || echo \"FAILED\"\r\ncat  /etc/supervisord.d/*.ini | sed -n -E \"/^\\[.*\\]/{s/\\[(.*)\\]/\\1/;h;n;};/^[a-zA-Z]/{s/#.*//;G;s/([^ ]*) *= *(.*)\\n(.*)/\\3_\\1='\\2'/;p;}\" > /tmp/supervisord.parsed.conf\r\n\r\nVerify specific start and restart properties for application services:\r\n\r\napplication_services=(program:awx-dispatcher_autostart program:awx-dispatcher_autorestart program:awx-wsbroadcast_autostart program:awx-wsbroadcast_autorestart program:awx-uwsgi_autostart program:awx-uwsgi_autorestart program:awx-daphne_autostart program:awx-daphne_autorestart program:awx-rsyslogd_autostart program:awx-rsyslogd_autorestart) \r\nfor SUPERVISOR_CHECK in ${application_services[@]}; do grep $SUPERVISOR_CHECK /tmp/supervisord.parsed.conf | grep -q true || echo \"FAILED\" ; done\r\nrm /tmp/supervisord.parsed.conf\r\n\r\nIf \"FAILED\" is displayed, this is a finding.","cciIds":["CCI-002385"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-256963r1016551_rule","stigId":"V-256963","groupId":"V-256963","title":"DPMS Target Red Hat Ansible Automation Controller Web Server","severity":"CAT I","description":"Preventing the disclosure of transmitted information requires that the Automation Controller web server take measures to employ some form of cryptographic mechanism in order to protect the information during transmission. This is usually achieved through the use of Transport Layer Security (TLS). Transmission of data can take place between the web server and a large number of devices/applications external to the web server. Examples are a web client used by a user, a backend database, an audit server, or other web servers in a web cluster. If data is transmitted unencrypted, the data then becomes vulnerable to disclosure. The disclosure may reveal user identifier/password combinations, website code revealing business logic, or other user personal information. Satisfies: SRG-APP-000439-WSR-000151, SRG-APP-000439-WSR-000152, SRG-APP-000442-WSR-000182, SRG-APP-000429-WSR-000113","fixText":"As a System Administrator for each Automation Controller NGINX web server host, for each available server connection that is not handled or upgraded to SSL via an organizationally approved method, perform one of the following actions:\n\nRemove the available server connections.\nOR\nUpgrade the connection via redirect to an SSL server connection.\nOR\nRewrite the connection URL to an HTTPS server connection.\nOR\nOther organizationally defined handling method.\n\nReload the NGINX server configuration by executing the following:\npkill -HUP nginx\n\n(Alternatively, reinstall Automation Controller for each web server host.)","checkText":"As a System Administrator for each Automation Controller NGINX web server host, enumerate all available server connections:\n\nNGINXCONF=$(nginx -V 2>&1 | tr ' ' '\\n' | sed -ne '/conf-path/{s/.*conf-path=\\(.*\\)/\\1/;p}')\ngrep '\\s*listen'\nNGINXCONF | grep -v ssl\n\nEnsure each available server connection that does not use SSL upgrades this connection to use SSL via an allowed method:\n\n- is redirected to an SSL server connection, e.g., \"return 301 https://$host:443$request_uri\";\n- is rewritten to an SSL server URL, e.g., \"rewrite ^ https://$host$request_uri? permanent;\";\n- is dropped silently;\n- or used other organizationally approved connection handling.\n\nExamine the NGINX configuration, for example:\n\nvi $NGINXCONF\n\nIf any available server connection is not handled or upgraded to SSL via an organizationally approved method, this is a finding.\nvi $NGINXCONF\n\nIf any available server connection is not handled or upgraded to SSL via an organizationally approved method, this is a finding.","cciIds":["CCI-002418","CCI-002422","CCI-002476"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-256964r961632_rule","stigId":"V-256964","groupId":"V-256964","title":"DPMS Target Red Hat Ansible Automation Controller Web Server","severity":"CAT II","description":"Transport Layer Security (TLS) is a required transmission protocol for a web server hosting controlled information. The use of TLS provides confidentiality of data in transit between the web server and client. FIPS 140-2 approved TLS versions must be enabled and non-FIPS-approved SSL versions must be disabled. NIST SP 800-52 defines the approved TLS versions for government applications.","fixText":"As a System Administrator for each Automation Controller Web Server, reconfigure the TLS versions or ciphers used in Automation Controller's web server:\n\nNGINXCONF=`nginx -V 2>&1 | tr ' ' '\\n' | sed -ne '/conf-path/{s/.*conf-path=\\(.*\\)/\\1/;p}' `\nsudo -e ${NGINXCONF}\n\nReplace the line beginning with \"ssl_protocols\" to match (note the leading spaces):\n\"        ssl_protocols TLSv1.2;\"\n\nIf the \"ssl_protocols\" variable does not exist, add it after the line beginning with \"ssl_ciphers\".\n\nSave the file and exit the text editor. To apply these changes to the running service immediately, restart the NGINX service with the following command:\n\nsudo systemctl restart nginx","checkText":"As a System Administrator, for each Automation Controller NGINX web server, a TLS Configuration Check validates the TLS version used by the server:\n\nNGINXCONF=`nginx -V 2>&1 | tr ' ' '\\n' | sed -ne '/conf-path/{s/.*conf-path=\\(.*\\)/\\1/;p}' `\nsudo grep ssl_protocols ${NGINXCONF} | grep -E 'ssl_protocols\\s+TLSv1.2;' || echo \"FAILED\"\n\nIf \"FAILED\" is displayed, this is a finding.","cciIds":["CCI-002418"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-256965r1155093_rule","stigId":"V-256965","groupId":"V-256965","title":"DPMS Target Red Hat Ansible Automation Controller Web Server","severity":"CAT II","description":"Information can be either unintentionally or maliciously disclosed or modified during preparation for transmission, including, for example, during aggregation, at protocol transformation points, and during packing/unpacking. These unauthorized disclosures or modifications compromise the confidentiality or integrity of the information. An example of this would be an SMTP queue. This queue may be added to a web server through an SMTP module to enhance error reporting or to allow developers to add SMTP functionality to their applications. Any modules used by the web server that queue data before transmission must maintain the confidentiality and integrity of the information before the data is transmitted.","fixText":"As an SA for each Automation Controller NGINX web server host, verify the NGINX web server configuration file in use is located at \"/etc/nginx/nginx.conf\":\n\nNGINXCONF=`nginx -V 2>&1 | tr ' ' '\\n' | sed -ne '/conf-path/{s/.*conf-path=\\(.*\\)/\\1/;p}' ` ; \n\nVerify the location of the NGINX modules libraries:\n\npushd `nginx -V 2>&1 | grep module | tr ' ' '\\n' | grep module | sed -n 's/.*modules-path.*=\\s*\\(.*\\)/\\1/p'`\n\nRemove all modules that violate organizationally defined policy.\nExamine runtime loaded modules:\n\ngrep load_module nginx.conf.test | sed -n 's/^\\s*load_module\\s*\\(.*\\)/\\1/p'\n\nRemove all modules that violate organizationally defined policy.\nExamine the remainder of the modules:\n\nnginx -V 2>&1 | grep module | tr ' ' '\\n' | grep module | grep -v modules-path \n\nThese modules are compiled into the core NGINX binaries are cannot be removed. Use of any these modules that violate organizationally defined policy must be mitigated.\n\nTo apply these changes to the running service immediately, restart the NGINX service with the following command:\n\nsudo systemctl restart nginx\n\nAlternatively, reinstall Automation Controller for each web server host.","checkText":"As a system administrator (SA) for each Automation Controller NGINX web server host, verify the NGINX web server configuration file in use is located at \"/etc/nginx/nginx.conf\":\n\nNGINXCONF=`nginx -V 2>&1 | tr ' ' '\\n' | sed -ne '/conf-path/{s/.*conf-path=\\(.*\\)/\\1/;p}' ` \n\nIf the file does not exist, this is a finding.\n\nVerify the use of only dynamic modules witch are allowed by organizational policy:\n\nallowed_modules=(ssl_module http_v2_module http_realip_module http_addition_module http_xslt_module=dynamic http_image_filter_module=dynamic http_sub_module http_dav_module  http_mp4_module http_gunzip_module http_gzip_static_module http_random_index_module http_secure_link_module http_degradation_module http_slice_module http_stub_status_module http_perl_module=dynamic http_auth_request_module mail_ssl_module stream_ssl_preread_module http_flv_module) ; echo \"${allowed_modules[*]}\" | tr ' ' '\\n' >/tmp/allowed_modules ; nginx -V 2>&1 | grep module | tr ' ' '\\n' | grep module | grep -v modules-path | grep -v -Ff /tmp/allowed_modules && echo \"FAILED\";\n\nVerify the use of only runtime modules which are allowed by organizational policy:\n\ngrep load_module $NGINXCONF  | sed -n 's/^\\s*load_module\\s*\\(.*\\)/\\1/p' | grep -v -Ff /tmp/allowed_modules && echo \"FAILED\" ; rm -f /tmp/allowed_modules\n\nIf the output shows \"FAILED\", this is a finding.","cciIds":["CCI-002420"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-256966r1138080_rule","stigId":"V-256966","groupId":"V-256966","title":"DPMS Target Red Hat Ansible Automation Controller Web Server","severity":"CAT II","description":"Security flaws with software applications are discovered daily. Red Hat constantly updates and patches Automation Controller to address newly discovered security vulnerabilities. Organizations (including any contractor to the organization) are required to promptly install security-relevant software updates (e.g., patches, service packs, and hot fixes). Flaws discovered during security assessments, continuous monitoring, incident response activities, or information system error handling must also be addressed expeditiously. The Automation Controller NGINX web server will be configured to check for and install security-relevant software updates from an authoritative source within an organizationally identified time period from the availability of the update. By default, this time period will be every 24 hours.","fixText":"As a system administrator, for each Automation Controller NGINX web server host, perform the following:\r\n\r\n1. Either configure update repositories in accordance with organizationally defined requirements or subscribe to Red Hat update repositories for the underlying operating system.\r\n\r\n2. Execute an update from these repositories:\r\n\r\n$ yum update -y\r\n\r\n3. Perform one of the following:\r\n\r\n3.1. Schedule an update to occur every 30 days, or in accordance with organizationally defined policy:\r\n\r\n$ yum install -y dnf-automatic  && sed -i '/apply_updates/s/no/yes/' /etc/dnf/automatic.conf && sed -i '/OnCalendar/s/^OnCalendar\\s*=.*/OnCalendar=*-1-* 6:00/' /usr/lib/systemd/system/dnf-automatic.timer && systemctl enable --now dnf-automatic.timer\r\n\r\n3.2. Schedule manual updates to occur at least every 30 days, or in accordance with organizationally defined policy. \r\n\r\n4. Restart the Automation Controller NGINX web server host.","checkText":"As a System Administrator for each Automation Controller NGINX web server host, verify the system is configured to receive updates from an organizationally defined source for authoritative system updates:\n\nyum -v repolist\n\nIf each URL is not valid and consistent with organizationally defined requirements, this is a finding.\n\nIf each repository is not enabled in accordance with organizationally defined requirements, this is a finding.\n\nIf the system is not configured to automatically receive and apply system updates from this source at least every 30 days, or manually receive and apply updates at least every 30 days, this is a finding.","cciIds":["CCI-002605"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-256967r961863_rule","stigId":"V-256967","groupId":"V-256967","title":"DPMS Target Red Hat Ansible Automation Controller Web Server","severity":"CAT II","description":"During installation of the Automation Controller NGINX web server software, accounts are created for the web server to operate properly. The accounts installed can have either no password installed or a default password, which will be known and documented by the vendor and the user community. The first thing an attacker will try when presented with a login screen are the default user identifiers with default passwords. Installed applications may also install accounts with no password, making the login even easier. Once the Automation Controller NGINX web server is installed, the passwords for any created accounts must be changed and documented. The new passwords must meet the requirements for all passwords (i.e., upper/lower characters, numbers, special characters, time until change, reuse policy, etc.). Service accounts or system accounts that have no login capability do not need to have passwords set or changed.","fixText":"As a System Administrator for each Automation Controller NGINX web server host, change the NGINX account to disallow interactive login:\n\n$ usermod -s /sbin/nologin nginx","checkText":"As a System Administrator for each Automation Controller NGINX web server host, verify the NGINX account is configured to disallow interactive login\"\r\n\r\ngrep '^nginx.*\\(/sbin/nologin$\\|/bin/false$\\)' /etc/passwd\r\n\r\nIf \"FAILED\" is displayed, this is a finding.","cciIds":["CCI-000366"],"status":"not_reviewed","findingDetails":"","comments":""}]}