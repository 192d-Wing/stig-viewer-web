{"title":"Palo Alto Networks Prisma Cloud Compute Security Technical Implementation Guide","description":"This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DOD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents. Comments or proposed revisions to this document should be sent via email to the following address: disa.stig_spt@mail.mil.","version":"2","releaseInfo":"Release: 2 Benchmark Date: 30 Jan 2025","rules":[{"id":"SV-253522r960759_rule","stigId":"V-253522","groupId":"V-253522","title":"DPMS Target Palo Alto Networks Prisma Cloud Compute","severity":"CAT I","description":"Communication to Prisma Cloud Compute Console's User Interface (UI) and API is protected by TLS v1.2+ (HTTPS). By default, only HTTPS communication to the Console's UI and API endpoints is enabled. Prisma Cloud Compute TCP port usage is configurable. Default configuration: TCP 8081 Console user interface and API (HTTP) - disabled by default. TCP 8083 Console user interface and API TLS v1.2 (HTTPS) TCP 8084 Console-to-Defender communication via mutual TLS v1.2 WebSocket session. Satisfies: SRG-APP-000014-CTR-000040, SRG-APP-000142-CTR-000325, SRG-APP-000185-CTR-000490, SRG-APP-000645-CTR-001410","fixText":"For Kubernetes deployment:\n\nEdit the deployment.apps/twistlock-console.\n\nFind the - name: MANAGEMENT_PORT_HTTP setting\n\nRemove the value assignment (e.g., 8081):\n        - name: MANAGEMENT_PORT_HTTP\n          value: \"8081\" \n\nSave and exit the editing session. The Console will restart automatically.\n\nFor Docker deployment:\n\nModify the twistlock.cfg located in the extracted release tar directory.\n\nRemove the value assignment for the MANAGEMENT_PORT_HTTP= variable.\n\nRedeploy the Console using the twistlock.sh script located in the extracted release tar directory.\n\n$ sudo ./twisltock.sh -sy onebox","checkText":"For Kubernetes deployment:\n\nQuery the ports used by the twistlock-console service:\n$ kubectl describe svc twistlock-console -n twistlock\n\nIf the TargetPort management-port-http exists and has a port assignment, this is a finding.\nPort: management-port-http  8081/TCP\nTargetPort: 8081/TCP\n\nFor Docker deployment:\n\nDetermine the name of the Console container:\ndocker ps|grep console\n\nFor example, the Console container is: ad8b41a2fec9 \n   twistlock/private:console_22_01_840\n\nInspect the container's PortBindings:\ndocker inspect ad8b41a2fec9|grep PortBindings -A 20\n\nIf port 8081 is listed, this is a finding.","cciIds":["CCI-000068","CCI-000382","CCI-000877"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-253523r1043176_rule","stigId":"V-253523","groupId":"V-253523","title":"DPMS Target Palo Alto Networks Prisma Cloud Compute","severity":"CAT II","description":"Integration with an organization's existing identity management policies technologies reduces the threat of account compromise and misuse. Centralized authentication services provide additional functionality to fulfill security requirements: - Multifactor authentication. - Disabling users after a period of time. - Encrypted storage and transmission of secure information. - Secure authentication protocols such as LDAP over TLS or LDAPS using FIPS 140-2 approved encryption modules. - PKI-based authentication. Satisfies: SRG-APP-000023-CTR-000055, SRG-APP-000024-CTR-000060, SRG-APP-000025-CTR-000065, SRG-APP-000033-CTR-000095, SRG-APP-000065-CTR-000115, SRG-APP-000068-CTR-000120, SRG-APP-000069-CTR-000125, SRG-APP-000149-CTR-000355, SRG-APP-000150-CTR-000360, SRG-APP-000151-CTR-000365, SRG-APP-000152-CTR-000370, SRG-APP-000163-CTR-000395, SRG-APP-000165-CTR-000405, SRG-APP-000170-CTR-000430, SRG-APP-000173-CTR-000445, SRG-APP-000174-CTR-000450, SRG-APP-000291-CTR-000675, SRG-APP-000292-CTR-000680, SRG-APP-000293-CTR-000685, SRG-APP-000294-CTR-000690, SRG-APP-000317-CTR-000735, SRG-APP-000318-CTR-000740, SRG-APP-000345-CTR-000785, SRG-APP-000397-CTR-000955","fixText":"Configure Prisma Cloud Console for SAML-based authentication in which the SAML IdP enforces multifactor authentication (e.g., x509/smartcard authentication). \n\nNavigate to Prisma Cloud Compute Console's Manage >> Authentication >> Identity Providers:\n- Click \"Add provider\".\n- For Protocol, select \"SAML\".\n- For Identity provider, select provider. \n- Configure the settings and click \"Save\".\n  SAML settings = Enabled \n \nConfigure an SAML identity provider that enforces privileged account multifactor authentication for the Prisma Cloud Compute service provider.","checkText":"Confirm the Prisma Cloud Console has been configured from SAML-based authentication.\n\nNavigate to Prisma Cloud Compute Console's Manage >> Authentication >> Identity Providers tab. \n\nVerify SAML settings are \"Enabled\" and an identity provider has been configured.\n\nIf SAML settings are not enabled and an identity provider has not been configured, this is a finding.","cciIds":["CCI-000015","CCI-000016","CCI-000017","CCI-000044","CCI-000048","CCI-000050","CCI-004066","CCI-004061","CCI-000213","CCI-000765","CCI-000766","CCI-003627","CCI-004045","CCI-002145","CCI-002238","CCI-000195","CCI-000198","CCI-000199","CCI-000767","CCI-000768","CCI-000795","CCI-001683","CCI-001684","CCI-001685","CCI-001686","CCI-002142"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-253524r960792_rule","stigId":"V-253524","groupId":"V-253524","title":"DPMS Target Palo Alto Networks Prisma Cloud Compute","severity":"CAT II","description":"The container platform keystore is used to store credentials that are used to build a trust between the container platform and an external source. This trust relationship is authorized by the organization. If a malicious user were to have access to the container platform keystore, two negative scenarios could develop: 1. Keys not approved could be introduced. 2. Approved keys could be deleted, leading to the introduction of container images from sources the organization never approved. To thwart this threat, it is important to protect the container platform keystore and give access to only individuals and roles approved by the organization. Satisfies: SRG-APP-000033-CTR-000100, SRG-APP-000118-CTR-000240, SRG-APP-000121-CTR-000255, SRG-APP-000133-CTR-000300, SRG-APP-000211-CTR-000530, SRG-APP-000233-CTR-000585, SRG-APP-000340-CTR-000770, SRG-APP-000380-CTR-000900","fixText":"Navigate to Prisma Cloud Compute Console's >> Manage >> Authentication >> Users tab. \n\n- Set the users' role assignments to the ones who have the authority to review the audit data.\n- Assign roles to all users and groups. \n- Assign administrator and operator roles only to the users requiring the rights to modify the Prisma Cloud Compute's Credential Store. \n- Remove the Administrator or Operator role for users who do not require access. \n\nNavigate to Prisma Cloud Compute Console's >> Manage >> Authentication >> Groups tab.\n\n- Set the groups' role assignments to the ones who have the authority to review audit data.\n- Assign roles to all users and groups. \n- Set the groups' Administrator and Operator role assignments to only to the groups requiring the rights to modify the Prisma Cloud Compute's Credential Store.\n\nAdjust user, group, and Collection assignments to align with organizational policies.","checkText":"Navigate to Prisma Cloud Compute Console's >> Manage >> Authentication >> Users tab. \n\nInspect the users' role assignments:\n- Review role assigned to users. If role and/or the Collection assignment is incorrect, this is a finding.\n- If a user is not assigned a role, this is a finding. \n- Review users assigned the administrator role. If a user has the administrator role and does not require access, this is a finding.\n\nNavigate to Prisma Cloud Compute Console's >> Manage >> Authentication >> Groups tab.\n\n(Only the Administrator, Operator Prisma Cloud Compute roles have the ability to create/modify policy that could affect runtime behaviors.)\n\nInspect the groups' role assignments:\n- If any users or groups are assigned the Auditor or higher role and do not require access to audit information, this is a finding.\n- If a group is not assigned a role, this is a finding. \n- If role and/or Collection assignment is incorrect, this is a finding.\n- Review groups assigned the Administrator or Operator role. If a group has the Administrator or Operator role and does not require access to Prisma Cloud Compute's Credential Store, this is a finding.","cciIds":["CCI-000162","CCI-000213","CCI-001082","CCI-001084","CCI-001493","CCI-001499","CCI-001813","CCI-002235"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-253525r960801_rule","stigId":"V-253525","groupId":"V-253525","title":"DPMS Target Palo Alto Networks Prisma Cloud Compute","severity":"CAT II","description":"Prisma Cloud Compute Collections are used to scope rules to target specific resources in an environment, partition views, and enforce which views specific users and groups can access. Collections can control access to data on a need-to-know basis.","fixText":"Navigate to Prisma Cloud Compute Console's >> Manage >> Collections and Tags >> Collections tab.\n\nCreate a collection:\n- Click \"Add Collection\".\n- Enter a name and description and then specify a filter to target specific resources.\n- Click \"Save\".","checkText":"Navigate to Prisma Cloud Compute Console's >> Manage >> Collections and Tags >> Collections tab.\n\nReview the Collections according to organizational policy. \n\nIf no organizational-specific Collections are defined, this is a finding.","cciIds":["CCI-001368"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-253526r960804_rule","stigId":"V-253526","groupId":"V-253526","title":"DPMS Target Palo Alto Networks Prisma Cloud Compute","severity":"CAT I","description":"Network segmentation and compartmentalization are important parts of a comprehensive defense-in-depth strategy. CNNF works as an east-west firewall for containers. It limits damage by preventing attackers from moving laterally through the environment when they have already compromised the perimeter. Satisfies: SRG-APP-000039-CTR-000110, SRG-APP-000384-CTR-000915","fixText":"Navigate to Prisma Cloud Compute Console's >> Radars >> Settings. \n\nSet Container network monitoring to \"enabled\".\n\nSet Host network monitoring to \"enabled\".","checkText":"Navigate to Prisma Cloud Compute Console's >> Radars >> Settings. \n\nIf Container network monitoring is disabled, this is a finding.\n\nIf Host network monitoring is disabled, this is a finding.","cciIds":["CCI-000381","CCI-001414"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-253527r960897_rule","stigId":"V-253527","groupId":"V-253527","title":"DPMS Target Palo Alto Networks Prisma Cloud Compute","severity":"CAT II","description":"Container platforms distribute workloads across several nodes. The ability to uniquely identify an event within an environment is critical. Prisma Cloud Compute Container Runtime audits record the time, container, corresponding image, and node where the event occurred. Satisfies: SRG-APP-000097-CTR-000180, SRG-APP-000100-CTR-000200","fixText":"Navigate to Prisma Cloud Compute Console's >> Manage >> Defenders >> Manage tab. \n\nDeploy Defender to containerization node:\n- Select the method of Defender deployment.\n- Configure the Defender policy.","checkText":"Navigate to Prisma Cloud Compute Console's >> Manage >> Defenders >> Manage tab. \n\nVerify Prisma Cloud Compute Defenders have been deployed to all container runtime nodes to be monitored.\n\nReview the list of deployed Defenders. If a Defender is missing, this is a finding.","cciIds":["CCI-000132","CCI-001487"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-253528r960903_rule","stigId":"V-253528","groupId":"V-253528","title":"DPMS Target Palo Alto Networks Prisma Cloud Compute","severity":"CAT II","description":"Prisma Cloud Compute correlates raw audit data to actionable security intelligence, enabling a more rapid and effective response to incidents. This reduces the manual, time-consuming task of correlating data. Prisma Cloud Forensics is a lightweight distributed data recorder that runs alongside all containers in the environment. Prisma Cloud continuously collects detailed runtime information to help incident response teams understand what happened before, during, and after a breach. Forensic data consists of additional supplemental runtime events that complement the data (audits) already captured by Prisma Cloud's runtime sensors. It provides additional context when trying to identify the root cause of an incident. Satisfies: SRG-APP-000099-CTR-000190, SRG-APP-000409-CTR-000990","fixText":"Navigate to Prisma Cloud Compute Console's >> Manage >> System >> Forensics tab. \n\nSet \"Forensics data collection\" to \"enabled\".","checkText":"Navigate to Prisma Cloud Compute Console's >> Manage >> System >> Forensics tab. \n\nIf \"Forensics data collection\" is disabled, this is a finding.","cciIds":["CCI-000134","CCI-002884"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-253529r960909_rule","stigId":"V-253529","groupId":"V-253529","title":"DPMS Target Palo Alto Networks Prisma Cloud Compute","severity":"CAT I","description":"Prisma Cloud Compute's runtime defense is the set of features that provides both predictive and threat-based active protection for running containers. Consistent application of Prisma Cloud Compute runtime policies ensures the continual application of policies and the associated effects. Prisma Cloud Compute's configurations must be monitored for configuration drift and addressed according to organizational policy. Satisfies: SRG-APP-000101-CTR-000205, SRG-APP-000384-CTR-000915, SRG-APP-000447-CTR-001100, SRG-APP-000450-CTR-001105, SRG-APP-000507-CTR-001295, SRG-APP-000508-CTR-001300","fixText":"Enable runtime policies. \n\nNavigate to Prisma Cloud Compute Console's Defend >> Runtime. \n\nClick the tab to be edited.\n\nTo add policy (for Host or App-Embedded policy):\n- Click \"Add rule\". \n- Enter rule name.\n  Scope = All\n- Accept the defaults and click \"Save\".\n\nTo enable policy:\n- Click the rule's three-dot menu. \n- Set to \"Enable\".\n\nTo change scope, click the rule row:\n- Change the policy scope to \"All\".\n- Click \"Save\".\n\nTo add container policy:\n- Select the \"Container policy\" tab. \n- Set \"Enable automatic runtime learning\" to \"On\". \n\nTo create a new runtime rule:\n- Click \"Add rule\". \n- Configure the following settings:\n  Enter rule name\n  Scope = All\n\nSelect the \"Anti-malware\" tab.\nSet the following:\n- Prisma Cloud advanced threat protection = on\n- Kubernetes attacks = on\n- Suspicious queries to cloud provider APIs = on\n\nSelect the \"Process\" tab.\nSet the following:\nProcess monitoring = enabled\n\nSelect the \"Network\" tab.\nSet the following:\nIP connectivity = enabled\n\nSelect the \"File system\" tab.\nSet the following:\n- File system monitoring = enabled\n- Accept the defaults and click \"Save\".\n\nSelect the \"App-Embedded policy\" tab.\n- Click the rule's three-dot menu. Set to \"Enable\".\n- Click the rule name row.\n- Change the scope to \"All\".\n- Click \"Save\".\n\nCreate a new runtime rule:\n- Click \"add rule.\" \n- Enter rule name.\n- Scope = All\n- Accept the defaults and click \"Save\".\n\nSelect the \"Host policy\" tab.\n- Click the rule's three-dot menu. Set to \"Enable\".\n- Click the rule name row.\n- Change the scope to \"All\".\n- Click \"Save\".\n\n- Click \"Add rule\". \n- Enter rule name.\n- Scope = All\n- Select the \"Activities\" tab.\n- Set the following:\n  Host activity monitoring =\"Enabled\"\n  Docker commands = \"On\"\n  New sessions spawned by sshd = \"On\"\n  Commands run with sudo or su = \"On\"\n  Log activity from background apps = \"On\"\n  Track SSH events = \"On\"\n- Accept the defaults and click \"Save\".","checkText":"Verify runtime policies are enabled. \n\nNavigate to Prisma Cloud Compute Console's Defend >> Runtime. \n\nSelect \"Container policy\".\n- If a rule does not exist, this is a finding. \n- If \"Enable automatic runtime learning\" is set to \"off\", this is a finding. \n- Click the three dots in the \"Actions\" column for the rule. \n- If the policy is disabled, this is a finding.\n- Click the Container runtime policy. \n- If the policy is not scoped to \"All\", this is a finding.\n\nSelect the \"App-Embedded policy\" tab.\n- If a rule does not exist, this is a finding.\n- Click the three dots in the \"Actions\" column for rule \"Default - alert on suspicious runtime behavior\". \n- If the policy is disabled, this is a finding.\n- Click the \"Default - alert on suspicious runtime behavior\" policy row. \n- If the \"Default - alert on suspicious runtime behavior\" policy is not scoped to \"All\", this is a finding.\n\nSelect the \"Host policy\" tab. \n- If a rule does not exist, this is a finding. \n- Click the three dots in the \"Actions\" column for the rule. \n- If the policy is disabled, this is a finding.\n- Click the Host runtime policy. \n- If the policy is not scoped to \"All\", this is a finding.","cciIds":["CCI-000135","CCI-000172","CCI-001764","CCI-002754","CCI-002824"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-253530r960918_rule","stigId":"V-253530","groupId":"V-253530","title":"DPMS Target Palo Alto Networks Prisma Cloud Compute","severity":"CAT II","description":"Event log collection is critical in ensuring the security of a containerized environment due to the ephemeral nature of the workloads. In an environment that is continually in flux, audit logs must be properly collected and secured. Prisma Cloud Compute can be configured to send audit events to the host node's syslog in RFC5424-compliant format. Satisfies: SRG-APP-000111-CTR-000220, SRG-APP-000181-CTR-000485, SRG-APP-000358-CTR-000805, SRG-APP-000474-CTR-001180, SRG-APP-000516-CTR-000790","fixText":"Navigate to Prisma Cloud Compute Console's >> Manage >> Alerts >> Logging tab. \n\nSet Syslog to \"enabled\".\n\nSelect the \"Manage\" tab.\n\nClick \"Add profile\".\n\nComplete the form based on the organization. At a minimum, the following Alert triggers must be selected:\n- Host vulnerabilities.\n- Image vulnerabilities.\n\nClick \"Save\".","checkText":"Navigate to Prisma Cloud Compute Console's >> Manage >> Alerts >> Logging tab. \n\nIf the Syslog setting is \"disabled\", this is a finding.\n\nSelect the \"Manage\" tab.\n\nIf no Alert Providers are configured, this is a finding.","cciIds":["CCI-000154","CCI-000366","CCI-001851","CCI-001876","CCI-002702"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-253531r960960_rule","stigId":"V-253531","groupId":"V-253531","title":"DPMS Target Palo Alto Networks Prisma Cloud Compute","severity":"CAT I","description":"Consistent application of Prisma Cloud Compute compliance policies ensures the continual application of policies and the associated effects. Satisfies: SRG-APP-000133-CTR-000295, SRG-APP-000133-CTR-000310, SRG-APP-000141-CTR-000315, SRG-APP-000384-CTR-000915","fixText":"Navigate to Prisma Cloud Compute Console's >> Defend >> Compliance >> Hosts tab >> Running hosts tab.\n\nAdd Rule:\n- Click \"Add rule\".\n  Name = \"Default - alert on critical and high\"\n  Scope = \"All\"\n- Change Action to the values shown below (Change Action).\n- Accept the other defaults and click \"Save\".\n\nChange Action:\n- Click \"Rule name\".\n<Filter on Rule ID>\n\nID = 8112 - Description (--anonymous-auth argument is set to false (kube-apiserver) - master node)\n- Change Action to \"Alert\" or \"Block\" (based on organizational needs).\n- Click \"Save\".\n\nID = 8212 - Description (--anonymous-auth argument is set to false (kubelet) - worker node)\n- Change Action to \"Alert\" or \"Block\" (based on organizational needs).\n- Click \"Save\".\n\nID = 8311 - Description (--anonymous-auth argument is set to false (federation-apiserver)).\n- Change Action to \"Alert\" or \"Block\" (based on organizational needs).\n- Click \"Save\".\n\nID = 81427 - Description (Kubernetes PKI directory and file ownership is set to root:root).\n- Change Action to \"Alert\" or \"Block\" (based on organizational needs).\n- Click \"Save\".\n\nID = 81428 - Description (Kubernetes PKI certificate file permissions are set to 644 or more restrictive).\n- Change Action to \"Alert\" or \"Block\" (based on organizational needs).\n- Click \"Save\".\n\nID = 8214 - Description (--client-ca-file argument is set as appropriate (kubelet)).\n- Change Action to \"Alert\" or \"Block\" (based on organizational needs).\n- Click \"Save\".\n\nID = 8227 - Description (certificate authorities file permissions are set to 644 or more restrictive (kubelet)).\n- Change Action to \"Alert\" or \"Block\" (based on organizational needs).\n- Click \"Save\".\n\nID = 8115 - Description (--kubelet-https argument is set to true (kube-apiserver))\n- Change Action to \"Alert\" or \"Block\" (based on organizational needs).\n- Click \"Save\".\n\nID = 8116 - Description (--insecure-bind-address argument is not set (kube-apiserver)).\n- Change Action to \"Alert\" or \"Block\" (based on organizational needs).\n- Click \"Save\".\n\nID = 8117 - Description (--insecure-port argument is set to 0 (kube-apiserver) can determine if the Kubernetes API is configured to only listen on the TLS enabled port (TCP 6443)).\n- Change Action to \"Alert\" or \"Block\" (based on organizational needs).\n- Click \"Save\".\n\nID = 8118 - Description (--secure-port argument is not set to 0 (kube-apiserver)).\n- Change Action to \"Alert\" or \"Block\" (based on organizational needs).\n- Click \"Save\".\n\nID = 81122 - Description (--kubelet-certificate-authority argument is set as appropriate (kube-apiserver)).\n- Change Action to \"Alert\" or \"Block\" (based on organizational needs).\n- Click \"Save\".\n\nID = 81123 - Description (--kubelet-client-certificate and --kubelet-client-key arguments are set as appropriate (kube-apiserver)).\nID = 81129 - Description (--tls-cert-file and --tls-private-key-file arguments are set as appropriate (kube-apiserver)).\n- Change Action to \"Alert\" or \"Block\" (based on organizational needs).\n- Click \"Save\".\n\nID = 82112 - Description (--tls-cert-file and --tls-private-key-file arguments are set as appropriate (kubelet)).\n- Change Action to \"Alert\" or \"Block\" (based on organizational needs).\n- Click \"Save\".\n\nID = 81141 - Description (--authorization-mode argument includes RBAC (kube-apiserver)).\n- Change Action to \"Alert\" or \"Block\" (based on organizational needs).\n- Click \"Save\".","checkText":"Navigate to Prisma Cloud Compute Console's >> Defend >> Compliance >> Hosts tab >> Running hosts tab.\n\nIf a \"Default - alert on critical and high\" rule does not exist, this is a finding. \n\nCheck all the rules to verify the following Actions are not set to \"Ignore\". (Click \"Rule name\".)\n\n<Filter on Rule ID>\n\nID = 8112 - Verify the --anonymous-auth argument is set to false (kube-apiserver) - master node.\n\nID = 8212 - Verify the --anonymous-auth argument is set to false (kubelet) - worker node.\n\nID = 8311 - Verify the --anonymous-auth argument is set to false (federation-apiserver). \n\nID = 81427 - Verify the Kubernetes PKI directory and file ownership are set to root:root.\n\nID = 81428 - Verify the Kubernetes PKI certificate file permissions are set to 644 or more restrictive.\n\nID = 8214 - Verify the --client-ca-file argument is set as appropriate (kubelet).\n\nID = 8227 - Verify the certificate authorities file permissions are set to 644 or more restrictive (kubelet).\n\nID = 8115 - Verify the --kubelet-https argument is set to true (kube-apiserver).\n\nID = 8116 - Verify the --insecure-bind-address argument is not set (kube-apiserver).\n\nID = 8117 - Verify the --insecure-port argument is set to 0 (kube-apiserver) can determine if the Kubernetes API is configured to only listen on the TLS-enabled port (TCP 6443).\n\nID = 8118 - Verify the --secure-port argument is not set to 0 (kube-apiserver).\n\nID = 81122 - Verify the --kubelet-certificate-authority argument is set as appropriate (kube-apiserver).\n\nID = 81123 - Verify the --kubelet-client-certificate and --kubelet-client-key arguments are set as appropriate (kube-apiserver).\n\nID = 81129 - Verify the --tls-cert-file and --tls-private-key-file arguments are set as appropriate (kube-apiserver).\n\nID = 82112 - Verify the --tls-cert-file and --tls-private-key-file arguments are set as appropriate (kubelet).\n\nID = 81141 - Verify the --authorization-mode argument includes RBAC (kube-apiserver).\n\nIf any of these checks are set to \"Ignore\", to all host nodes within the intended monitored environment, this is a finding.","cciIds":["CCI-000381","CCI-001499","CCI-001764"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-253532r960960_rule","stigId":"V-253532","groupId":"V-253532","title":"DPMS Target Palo Alto Networks Prisma Cloud Compute","severity":"CAT I","description":"Consistent application of Prisma Cloud Compute compliance policies ensures the continual application of policies and the associated effects. Prisma Cloud Compute's configurations must be monitored for configuration drift and addressed according to organizational policy. Satisfies: SRG-APP-000133-CTR-000305, SRG-APP-000384-CTR-000915, SRG-APP-000435-CTR-001070, SRG-APP-000472-CTR-001170","fixText":"Enable compliance policies.\n\nNavigate to Prisma Cloud Compute Console's Defend >> Compliance and click tab to be edited.\n\nTo add rule:\n- Click \"Add rule.\" \n- Enter rule name.\n  Scope = All\n- Accept the defaults and click \"Save\".\n\nClick the rule's three-dot menu. Set to \"Enable\".\n\nClick the rule row.\n- Change the policy scope to \"All\".\n- Click \"Save\".","checkText":"Verify compliance policies are enabled.\n \nNavigate to Prisma Cloud Compute Console's Defend >> Compliance. \n\nSelect the \"Code repositories\" tab.\nSelect the \"Repositories\" and \"CI\" tab.\n- If \"Default – alert all components\" does not exist, this is a finding. \n- Click the three dots in the \"Actions\" column for rule \"Default - alert all components\". \n- If the policy is disabled, this is a finding.\n- Click the \"Default – alert all components\" policy row.\n- If the \"Default - alert on critical and high\" policy is not scoped to \"All\", this is a finding. \n\nSelect the \"Containers and images\" tab.\nFor the \"Deployed\" and \"CI\" tab:\n- If the \"Default - alert on critical and high\" does not exist, this is a finding. \n- Click the three dots in the \"Actions\" column for rule \"Default - alert on critical and high\". \n- If the policy is disabled, this is a finding.\n- Click the \"Default - alert on critical and high\" policy row.\n- If the \"Default - alert on critical and high\" policy is not scoped to \"All\", this is a finding. \n\nSelect the \"Hosts\" tab.\nFor the \"Running hosts\" and \"VM images\" tab:\n- If the \"Default - alert on critical and high\" does not exist, this is a finding. \n- Click the three dots in the \"Actions\" column for rule \"Default - alert on critical and high\". \n- If the policy is disabled, this is a finding.\n- Click the \"Default - alert on critical and high\" policy row.\n- If the \"Default - alert on critical and high\" policy is not scoped to \"All\", this is a finding. \n\nSelect the \"Functions\" tab.\nFor the \"Functions\" and \"CI\" tab:\n- If the \"Default – alert all components\" does not exist, this is a finding. \n- Click the three dots in the \"Actions\" column for rule \"Default -alert all components\". \n- If the policy is disabled, this is a finding.\n- Click the \"Default - alert all components\" policy row.\n- If the \"Default - alert on critical and high\" policy is not scoped to \"All\", this is a finding.","cciIds":["CCI-001499","CCI-001764","CCI-002385","CCI-002696"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-253533r960963_rule","stigId":"V-253533","groupId":"V-253533","title":"DPMS Target Palo Alto Networks Prisma Cloud Compute","severity":"CAT II","description":"The Prisma Cloud Compute Trusted Images feature allows the declaration, by policy, of which registries, repositories, and images to trust and how to respond when untrusted images are started in the organization's environment. Satisfies: SRG-APP-000141-CTR-000320, SRG-APP-000386-CTR-000920","fixText":"Navigate to Prisma Cloud Compute Console's >> Defend >> Compliance >> Trusted Images tab.  \n\nSelect the \"Trust groups\" tab.\n\nCreate a trusted group:\n- Click \"Add Group\".\n  Name: \"IronBank\"\n- Specify a registry or repository: https://ironbank.dso.mil\n- Click \"Add to group\".\n- Specify a registry or repository: https://registry1.dso.mil/\n(There are two group images total.)\n- Click \"Save\".\n\nSelect the \"Policy\" tab.\n\nSet the Trusted Images Rules to \"on\".\n\nIf a rule does not exist:\n- Click \"Add rule\".\n  Rule name = \"IronBank\"\n  Scope = \"All\"\n\nAllowed:\n- Click \"Select groups\".\n- Select \"IronBank\".\n- Click \"Apply\".\n- Keep all defaults and click \"Save\".\n\nEnable policy:\n- Click the \"Default - alert all components\" policy three-dot menu. \n- Set to \"Enable\".\n\nPolicy row scope:\n- Click the policy rows.\n- Change the policy scope to all images and containers within the intended monitored environment.\n- Click \"Save\".","checkText":"Navigate to Prisma Cloud Compute Console's >> Defend >> Compliance Trusted Images tab. \n\nSelect the \"Trust groups\" tab.\nIf there is no Group, this is a finding. \n\nSelect the \"Policy\" tab.\nIf the Trusted Images Rules is set to \"off\", this is a finding.\n\nIf a rule does not exist, this is a finding.\n\nClick the three dots in the \"Actions\" column for rule. \nIf the policy is disabled, this is a finding.\n\nClick the policy row.\nIf the policy is not scoped to \"All\", this is a finding.","cciIds":["CCI-000381","CCI-001774"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-253534r1043177_rule","stigId":"V-253534","groupId":"V-253534","title":"DPMS Target Palo Alto Networks Prisma Cloud Compute","severity":"CAT II","description":"Privileged ports are ports below 1024 that require system privileges for their use. If containers are able to use these ports, the container must be run as a privileged user. The container platform must stop containers that try to map to these ports directly. Allowing nonprivileged ports to be mapped to the container-privileged port is the allowable method when a certain port is needed. Prisma Cloud Compute default TCP ports are 8083 (Console UI and API) and 8084 (Console-to-Defender communication). To use TCP ports below 1024, the Console would have to be configured to use privileged ports.","fixText":"For Kubernetes deployment:\n\nEdit the deployment.apps/twistlock-console.\n\nFind the - name: TargetPorts below 1024.\n\nChange to port number above 1024.\n\nSave and exit the editing session. The Console will restart automatically.\n\nFor Docker deployment:\n\nModify the twistlock.cfg located in the extracted release tar directory.\n\nChange any port assignment below 1024 to above 1024:\nMANAGEMENT_PORT_HTTP=\nMANAGEMENT_PORT_HTTPS=8083\nCOMMUNICATION_PORT=8084\n\nRedeploy the Console using the twistlock.sh script in the extracted release tar directory:\n$ sudo ./twisltock.sh -sy onebox","checkText":"For Kubernetes deployment:\n\nQuery the ports used by the twistlock-console service:\n$ kubectl describe svc twistlock-console -n twistlock\n\nIf any port number is below 1024, this is a finding.\n\nFor Docker deployment:\n\nDetermine the name of the Console container:\ndocker ps|grep console\n\nFor example, the Console container is: ad8b41a2fec9 \nad8b41a2fec9\ntwistlock/private:console_22_01_840\n\nInspect the container's PortBindings:\ndocker inspect ad8b41a2fec9|grep PortBindings -A 20\n\nIf the port is below 1024, this is a finding.","cciIds":["CCI-000382"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-253535r1051115_rule","stigId":"V-253535","groupId":"V-253535","title":"DPMS Target Palo Alto Networks Prisma Cloud Compute","severity":"CAT II","description":"Prisma Cloud Compute does not have a default account. During installation, the installer creates an administrator. This account can be removed once other accounts have been added. To ensure accountability and prevent unauthenticated access, users must be identified and authenticated to prevent potential misuse and compromise of the system.","fixText":"Navigate to Prisma Cloud Compute Console's >> Manage >> Authentication >> Users tab.\n\nEnsure only the break glass administrator account is a \"local\" account. \n\nDelete all other local accounts and use the SAML identity provider for all authentication and authorization to the Prisma Cloud Compute Console.","checkText":"Confirm there is only one \"break glass\" local administrative account. \n\nNavigate to Prisma Cloud Compute Console's Manage >> Authentication >> Users tab. \n\nOnly the administrative break glass account is allowed to have Authentication Method = Local. \n\nFor all other accounts, Authentication Method = SAML.\n\nIf any local account, except the administrative break glass account, has Authentication Method set to other than \"SAML\", this is a finding.","cciIds":["CCI-000764"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-253536r1051115_rule","stigId":"V-253536","groupId":"V-253536","title":"DPMS Target Palo Alto Networks Prisma Cloud Compute","severity":"CAT II","description":"Containers not requiring root-level permissions must run as a unique user account. To ensure accountability and prevent unauthenticated access to containers, the user the container is using to execute must be uniquely identified and authenticated to prevent potential misuse and compromise of the system.","fixText":"In the root directory of the extracted release tar file, modify the twistlock.cfg file's line:\nRUN_CONSOLE_AS_ROOT=false\n\nFor Kubernetes deployment, perform these additional steps:\n\nWhen generating the twistlock_console.yaml deployment file, supply the --run-as-user flag.\n\nLinux/twistcli console export kubernetes --service-type ClusterIP --run-as-user 2674\n\nModify the resulting twistlock_console.yaml file to include fsGroup: 2674 within the Deployment pod specification's securityContext:\nsecurityContext: fsGroup: 2674\n\nAdd runAsGroup: 2674 to the container specification's securityContext:\nsecurityContext: runAsUser: 2674\nrunAsGroup: 2674","checkText":"Locate the node in which the Prisma Cloud Compute Console container is running. \n\nDetermine the process owner for \"app/server\".\n\nExecute: \"ps -aux | grep \"/app/server\"\n\nIf the process is owned by root, this is a finding.","cciIds":["CCI-000764"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-253537r1015785_rule","stigId":"V-253537","groupId":"V-253537","title":"DPMS Target Palo Alto Networks Prisma Cloud Compute","severity":"CAT II","description":"Sharing accounts, such as group accounts, reduces the accountability and integrity of Prisma Cloud Compute.","fixText":"Navigate to Prisma Cloud Compute Console's Manage >> Authentication >> Users tab.\n\nDelete shared accounts and create a unique account for every Prisma Cloud Compute user.\n\nDelete shared accounts:\n- Click the three-dot menu. \n- Click \"Delete\" and confirm \"Delete User\".\n\nCreate a local user account where the local user account is unique:\n- Click \"+Add user\".\n- Complete the form and click \"Save\".","checkText":"Navigate to Prisma Cloud Compute Console's >> Manage >> Authentication >> Users tab. \n\nReview the accounts for uniqueness. If there are shared local accounts, this is a finding.","cciIds":["CCI-004045","CCI-000770"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-253538r1015786_rule","stigId":"V-253538","groupId":"V-253538","title":"DPMS Target Palo Alto Networks Prisma Cloud Compute","severity":"CAT II","description":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password complexity is one factor of several that determine how long it takes to crack a password. The more complex the password is, the greater the number of possible combinations that must be tested before the password is compromised. Satisfies: SRG-APP-000164-CTR-000400, SRG-APP-000166-CTR-000410, SRG-APP-000167-CTR-000415, SRG-APP-000168-CTR-000420, SRG-APP-000169-CTR-000425, SRG-APP-000389-CTR-000925, SRG-APP-000391-CTR-000935, SRG-APP-000400-CTR-000960","fixText":"Navigate to Prisma Cloud Compute Console's >> Manage >> Authentication >>\nLogon tab. \n\n- Set \"Token validity period\" to 15 or less.\n- Set \"Enable context sensitive help and single sign on to the Prisma Cloud Support site\" to \"off\".\n- Set \"Disable basic authentication for the API\" to \"on\".\n- Set \"Require strong passwords for local accounts\" to \"on\".\n- Set \"Require strict certificate validation in Defender installation links\" to \"off\".\n- Click \"Save\" and \"Restart\".","checkText":"Navigate to Prisma Cloud Compute Console's >> Manage >> Authentication >> Logon tab. \n\n- If \"Token validity period\" is greater than 15, this is a finding. \n- If \"Enable context sensitive help and single sign on to the Prisma Cloud Support site\" is set to \"on\", this is a finding. \n- If \"Disable basic authentication for the API\" is set to \"off\", this is a finding.\n- If \"Require strong passwords for local accounts\" is set to \"off\", this is a finding.\n- If \"Require strict certificate validation in Defender installation links\" is set to \"on\", this is a finding.","cciIds":["CCI-004066","CCI-001953","CCI-002007","CCI-000192","CCI-000193","CCI-000194","CCI-000205","CCI-001619","CCI-002038"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-253539r1015787_rule","stigId":"V-253539","groupId":"V-253539","title":"DPMS Target Palo Alto Networks Prisma Cloud Compute","severity":"CAT II","description":"Without the use of multifactor authentication, the ease of access to privileged functions is greatly increased. Multifactor authentication requires using two or more factors to achieve authentication. Factors include: (i) something a user knows (e.g., password/PIN); (ii) something a user has (e.g., cryptographic identification device, token); or (iii) something a user is (e.g., biometric). User access to Prisma Cloud Compute must use multifactor (x.509 based) authentication. Satisfies: SRG-APP-000177-CTR-000465, SRG-APP-000391-CTR-000935, SRG-APP-000401-CTR-000965, SRG-APP-000402-CTR-000970, SRG-APP-000605-CTR-001380","fixText":"Navigate to Prisma Cloud Compute Console's >> Manage >> Authentication >> System Certificate tab.\n\nRevocation block: Set \"Enable certificate revocation checking\" to \"On\" and click \"Save\".\n\nIn the \"Certificate-based authentication to Console\" block, import the smart card's issuing CA's chain of trust to the Console CA certificate(s) field. Click \"Save\".\n\nClick the \"Users\" tab. (Accounts cannot be edited. They must be removed and recreated correctly.)\n\nDelete account:\n- Click the three-dot menu. \n- Click \"Delete\" and confirm \"Delete User\".\n\nCreate a local user account where the local user account name matches the user's x.509 certificate's subjectName or subject alternative name's PrincipalName value:\n- Click \"+Add user\".\n  Authentication Source = Local\n  Username = subject alternative name's PrincipalName value\n  Password = random password that is not given to the user\n- Assign Role.\n- Click \"Save\".","checkText":"Navigate to Prisma Cloud Compute Console's >> Manage >> Authentication >> System Certificate tab. \n\nIf not performing direct smart card authentication to the console, this is not a finding.\n\nIf performing direct smart card authentication to the console:\n\nRevocation block: If \"Enable certificate revocation checking\" is set to \"Off\", this is a finding.\n\nShow Advanced certificate configuration:\n- In the \"Certificate-based authentication to Console\" block, verify the issuing CA(s) of the end users' certificates are within the Console CA certificate(s) field. \n- If there is no users' certificates, this is a finding. \n\nClick the \"Users\" tab.\n\nReview accounts with Authentication method \"Local\".\n\nIf the local user account's name does not match the user's x.509 certificate's subjectName or the subject alternative name's PrincipalName value, this is a finding.","cciIds":["CCI-000187","CCI-001857","CCI-001953","CCI-004068","CCI-002009","CCI-001991"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-253540r961149_rule","stigId":"V-253540","groupId":"V-253540","title":"DPMS Target Palo Alto Networks Prisma Cloud Compute","severity":"CAT II","description":"Prisma Cloud Compute Compliance policies must be enabled to ensure running containers do not access privileged resources. Satisfies: SRG-APP-000243-CTR-000595, SRG-APP-000243-CTR-000600, SRG-APP-000246-CTR-000605, SRG-APP-000342-CTR-000775","fixText":"Navigate to Prisma Cloud Compute Console's Defend >> Compliance >> Containers and images tab >> Deployed tab. \n\nChange action:\n(Click the rule name)\n<Filter on Rule ID>\n\nID = 54 - Description (Do not use privileged container)\nChange Action to \"Alert\" or \"Block\" (based on organizational needs).\nClick \"Save\".\n\nID = 5525 - Description (Restrict container from acquiring additional privileges are not configured)\nChange Action to \"Alert\" or \"Block\" (based on organizational needs).\nClick \"Save\".\n\nID = 59 - Description (Do not share the host's network namespace)\nChange Action to \"Alert\" or \"Block\" (based on organizational needs).\nClick \"Save\".\n\nID = 515 - Description (Do not share the host's process namespace)\nChange Action to \"Alert\" or \"Block\" (based on organizational needs).\nClick \"Save\".\n\nID = 516 - Description (Do not share the host's IPC namespace)\nChange Action to \"Alert\" or \"Block\" (based on organizational needs).\nClick \"Save\".\n\nID = 517 - Description (Do not directly expose host devices to containers)\nChange Action to \"Alert\" or \"Block\" (based on organizational needs).\nClick \"Save\".\n\nID = 520 - Description (Do not share the host's UTS namespace)\nChange Action to \"Alert\" or \"Block\" (based on organizational needs).\nClick \"Save\".\n\nID = 530 - Description (Do not share the host's user namespaces)\nChange Action to \"Alert\" or \"Block\" (based on organizational needs).\nClick \"Save\".\n\nID = 55 - Description (Do not mount sensitive host system directories on containers)\nChange Action to \"Alert\" or \"Block\" (based on organizational needs).\nClick \"Save\".\n\nID = 57 - Description (Do not map privileged ports within containers)\nChange Action to \"Alert\" or \"Block\" (based on organizational needs).\nClick \"Save\".\n\nID = 5510 - Description (Limit memory usage for container)\nChange Action to \"Alert\" or \"Block\" (based on organizational needs).\nClick \"Save\".\n\nID = 5511 - Description (Set container CPU priority appropriately)\nChange Action to \"Alert\" or \"Block\" (based on organizational needs).\nClick \"Save\".\n\nID = 599 - Description (Container is running as root)\nChange Action to \"Alert\" or \"Block\" (based on organizational needs).\nClick \"Save\".\n\nID = 41 - Description (Image should be created with a non-root user)\nChange Action to \"Alert\" or \"Block\" (based on organizational needs).\nClick \"Save\".","checkText":"Navigate to Prisma Cloud Compute Console's Defend >> Compliance >> Containers and images tab >> Deployed tab. \n\nFor each rule name, click the rule and confirm the following checks:\n(Filter on ID)\nID = 54: Do not use privileged container\nID = 5525: Restrict container from acquiring additional privileges are not configured\nID = 59: Do not share the host's network namespace\nID = 515: Do not share the host's process namespace\nID = 516: Do not share the host's IPC namespace\nID = 517: Do not directly expose host devices to containers\nID = 520: Do not share the host's UTS namespace\nID = 530: Do not share the host's user namespaces\nID = 55: Do not mount sensitive host system directories on containers\nID = 57: Do not map privileged ports within containers\nID = 5510: Limit memory usage for container\nID = 5511: Set container CPU priority appropriately\nID = 599: Container is running as root\nID = 41 Image should be created with a non-root user\n\nIf the action for each rule is set to \"Ignore\", this is a finding.","cciIds":["CCI-001090","CCI-001094","CCI-002233"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-253541r961167_rule","stigId":"V-253541","groupId":"V-253541","title":"DPMS Target Palo Alto Networks Prisma Cloud Compute","severity":"CAT II","description":"The determination of what is sensitive data varies from organization to organization. The organization must ensure the recipients for the event log information have a need to know and the log is sanitized based on the audience.","fixText":"Navigate to Prisma Cloud Compute Console's >> Manage >> System >> General tab. \n\nIn the Log Scrubbing section, set \"Automatically scrub secrets from runtime events\" to \"on\" and click \"Save\".","checkText":"Navigate to Prisma Cloud Compute Console's >> Manage >> System >> General tab. \n\nInspect the Log Scrubbing section. If \"Automatically scrub secrets from runtime events\" is \"off\", this is a finding.","cciIds":["CCI-001312"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-253542r961392_rule","stigId":"V-253542","groupId":"V-253542","title":"DPMS Target Palo Alto Networks Prisma Cloud Compute","severity":"CAT II","description":"To ensure sufficient storage capacity in which to write the audit logs, Prisma Cloud compute must be able to allocate audit record storage capacity.","fixText":"When deploying the Prisma Cloud Console, specify the size of the persistent volume with the \"—persistent-volume-storage\" parameter.","checkText":"When deploying Prisma Cloud Compute within a Kubernetes cluster, the Console's persistent value is by default 100GB. \n\nThe logs are stored within this persistent volume. Within the Kubernetes cluster, issue the command \"kubectl get pv\".\n\nIf the twistlock/twistlock-console claim's capacity is not 100GB or greater, this is a finding.","cciIds":["CCI-001849"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-253543r961473_rule","stigId":"V-253543","groupId":"V-253543","title":"DPMS Target Palo Alto Networks Prisma Cloud Compute","severity":"CAT I","description":"Prisma Cloud Compute's vulnerabilities defense is the set of features that provides both predictive and threat-based active protection for running containers. Consistent application of Prisma Cloud Compute vulnerabilities policies ensures the continual application of policies and the associated effects. Prisma Cloud Compute's configurations must be monitored for configuration drift and addressed according to organizational policy. Satisfies: SRG-APP-000384-CTR-000915, SRG-APP-000384-CTR-000915, SRG-APP-000456-CTR-001125, SRG-APP-000516-CTR-001335","fixText":"To enable vulnerabilities policies, navigate to Prisma Cloud Compute Console's Defend >> Vulnerabilities. Click tab to be edited.\n\nTo add rule:\n- Click \"Add rule\". \n- Enter rule name.\n  Scope = All\n- Accept the defaults and click \"Save\".\n\nClick the rule three-dot menu. Set to \"Enable\".\n\nClick the rule row:\n- Change the policy scope to \"All\".\n- Click \"Save\".","checkText":"To verify that vulnerabilities policies are enabled, navigate to Prisma Cloud Compute Console's Defend >> Vulnerabilities. \n\nSelect the \"Code repositories\" tab.\nFor the \"Repositories\" and \"CI\" tab:\n- If \"Default - alert all components\" does not exist, this is a finding. \n- Click the three dots in the \"Actions\" column for rule \"Default - alert all components\". \n- If the policy is disabled, this is a finding.\n- Click the \"Default - alert all components\" policy row. \n- If \"Default - alert all components\" is not scoped to \"All\", this is a finding. \n\nSelect the \"Images\" tab.\nFor the \"CI\" and \"Deployed\" tab:\n- If \"Default - alert all components\" does not exist, this is a finding. \n- Click the three dots in the \"Actions\" column for rule \"Default - alert all components\". \n- If the policy is disabled, this is a finding.\n- Click the \"Default - alert all components\" policy row. \n- If \"Default - alert all components\" is not scoped to \"All\", this is a finding.\n\nSelect the \"Hosts\" tab.\nFor the \"Running hosts\" and \"VM images\" tab:\n- If the \"Default - alert all components\" does not exist, this is a finding. \n- Click the three dots in the \"Actions\" column for rule \"Default - alert all components\". \n- If the policy is disabled, this is a finding.\n- Click the \"Default - alert all components\" policy row.\n- If \"Default - alert all components\" is not scoped to \"All\", this is a finding. \n\nSelect the \"Functions\" tab.\nFor the \"Functions\" and \"CI\" tab:\n- If the \"Default - alert all components\" does not exist, this is a finding. \n- Click the three dots in the \"Actions\" column for rule \"Default - alert all components\".\n- If the policy is disabled, this is a finding.\n- Click the \"Default - alert all components\" policy row.\n- If \"Default - alert all components\" is not scoped to \"All\", this is a finding.","cciIds":["CCI-000366","CCI-001764","CCI-002605"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-253544r961473_rule","stigId":"V-253544","groupId":"V-253544","title":"DPMS Target Palo Alto Networks Prisma Cloud Compute","severity":"CAT I","description":"Prisma Cloud Compute ships with \"only scan images with running containers\" set to \"on\". To meet the requirements, \"only scan images with running containers\" must be set to \"off\" to disable or remove components that are not required.","fixText":"Navigate to Prisma Cloud Compute Console's >> Manage >> System >> Scan tab. \n\nFor Running images:\n- Set \"Only scan images with running containers\" = \"Off\".\n- Click \"Save\".","checkText":"Navigate to Prisma Cloud Compute Console's >> Manage >> System >> Scan tab. \n\nVerify that for Running images, For Running images, \"Only scan images with running containers\" is set to \"Off\".\n\nIf \"Only scan images with running containers\" is set to \"On\", this is a finding.","cciIds":["CCI-000381"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-253545r986174_rule","stigId":"V-253545","groupId":"V-253545","title":"DPMS Target Palo Alto Networks Prisma Cloud Compute","severity":"CAT II","description":"When the secure WebSocket session between the Prisma Cloud Compute Console and Defenders is disconnected, the Defender will continually attempt to reestablish the session. Without reauthentication, unidentified or unknown devices may be introduced; thereby facilitating malicious activity. The Console must be configured to remove a Defender that has not established a connection in a specified period of days.","fixText":"Navigate to Prisma Cloud Compute's Manage >> Defenders. \n\nSelect the \"Manage\" tab. Select the \"Defenders\" tab.\n\nClick \"Advanced Settings\".\n\nSet the \"Automatically remove disconnected Defenders after (days)\" value to the organization's defined period.","checkText":"Navigate to Prisma Cloud Compute Console's >> Manage >> Defenders.\n \nSelect the \"Manage\" tab. Select the \"Defenders\" tab.\n\nClick \"Advanced Settings\".\n\nIf \"Automatically remove disconnected Defenders after (days)\" is not configured to the organization's policies, this is a finding.","cciIds":["CCI-002036"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-253546r1050656_rule","stigId":"V-253546","groupId":"V-253546","title":"DPMS Target Palo Alto Networks Prisma Cloud Compute","severity":"CAT II","description":"In certain situations, the nature of the vulnerability scanning may be more intrusive, or the container platform component that is the subject of the scanning may contain highly sensitive information. To protect the sensitive nature of such scanning, Prisma Cloud Compute Defenders perform the vulnerability scanning function. The Defender container must run as root and not privileged.","fixText":"Redeploy the Defender with appropriate rights by setting \"Run Defenders as privileged\" to \"On\".\n\nDelete the old twistlock-defender-ds daemonSet and redeploy daemonSet with the new yaml in which the securityContext - privileged = \"on\".","checkText":"Verify that when deploying the Defender via daemonSet, \"Run Defenders as privileged\" is set to \"On\".\n\nVerify the Defender containers were deployed using the daemonSet.yaml in which the securityContext is privileged (privileged = \"on\").\n\nIf \"Run Defenders as privileged\" is not set to \"On\" or the Defender containers were not deployed using the daemonSet.yaml in which the securityContext - privileged = \"on\", this is a finding.","cciIds":["CCI-001067"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-253547r961608_rule","stigId":"V-253547","groupId":"V-253547","title":"DPMS Target Palo Alto Networks Prisma Cloud Compute","severity":"CAT II","description":"Namespaces are a key boundary for network policies, orchestrator access control restrictions, and other important security controls. Prisma Cloud Compute containers running within a separate and exclusive namespace will inherit the namespace's security features. Separating workloads into namespaces can help contain attacks and limit the impact of mistakes or destructive actions by authorized users.","fixText":"Deploy the Prisma Cloud Compute Console and Defender containers within a distinct namespace.","checkText":"Inspect the Kubernetes namespace in which Prisma Cloud Compute is deployed:\n\n$ kubectl get pods -n twistlock\nNAME                                                           READY   STATUS    RESTARTS   AGE\ntwistlock-console-855744b66b-xs9cm     1/1       Running          0           4d6h\ntwistlock-defender-ds-99zj7                       1/1       Running          0           58d\ntwistlock-defender-ds-drsh8                      1/1       Running          0           58d\n\nInspect the list of pods.\n\nIf a non-Prisma Cloud Compute (does not start with \"twistlock\") pod is running in the same namespace, this is a finding.","cciIds":["CCI-002530"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-253548r961632_rule","stigId":"V-253548","groupId":"V-253548","title":"DPMS Target Palo Alto Networks Prisma Cloud Compute","severity":"CAT I","description":"Without protection of the transmitted information, confidentiality and integrity may be compromised since unprotected communications can be intercepted and either read or altered. Communication paths outside the physical protection of a controlled boundary are exposed to the possibility of interception and modification. Protecting the confidentiality and integrity of organizational information can be accomplished by physical means (e.g., employing physical distribution systems) or by logical means (e.g., employing cryptographic techniques). If physical means of protection are employed, then logical means (cryptography) do not have to be employed, and vice versa.","fixText":"Navigate to Prisma Cloud Compute Console's >> Manage >> System >> General tab. \n\nIn the Telemetry section:\n\nSet \"Share telemetry on product usage with Palo Alto Networks\" to \"Off\". \n\nSet \"Allow admins and operators to upload logs to Customer Support directly from Console UI\" to \"Off\". \n\nClick \"Save\".","checkText":"Navigate to Prisma Cloud Compute Console's >> Manage >> System >> General tab. \n\nInspect the Telemetry section.\n\nIf \"Share telemetry on product usage with Palo Alto Networks\" is \"On\", this is a finding.\n\nIf \"Allow admins and operators to upload logs to Customer Support directly from Console UI\" is \"On\", this is a finding.","cciIds":["CCI-002418"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-253549r961677_rule","stigId":"V-253549","groupId":"V-253549","title":"DPMS Target Palo Alto Networks Prisma Cloud Compute","severity":"CAT II","description":"Prisma Cloud Compute releases are distributed as Docker images. Each release updates or removes components as needed based on the vulnerabilities associated with the component or the functional need of the component.","fixText":"Upgrade the Prisma Cloud Compute Console and Defenders according to published procedures.\n\nhttps://docs.twistlock.com/docs/compute_edition/upgrade/upgrade_process_self_hosted.html","checkText":"Navigate to the Prisma Cloud Compute Console. \n\nIn the top right corner, click the bell icon. A banner with the version will display. \n\nIf there is a newer version, this is a finding.","cciIds":["CCI-002617"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-253550r961683_rule","stigId":"V-253550","groupId":"V-253550","title":"DPMS Target Palo Alto Networks Prisma Cloud Compute","severity":"CAT II","description":"The Prisma Cloud Compute Console pulls the latest vulnerability and threat information from the Intelligence Stream (intelligence.twistlock.com). The Prisma Cloud Intelligence Stream provides timely vulnerability data collected and processed from a variety of certified upstream sources.","fixText":"Prisma Cloud Compute Console's ability to communicate with the Intelligence Stream endpoint (https://intelligence.twistlock.com) dictates the method of vulnerability updates.\n\nIf the Console is able to communicate with the internet, ensure that intelligence.twistlock.com is resolvable, routable, and can establish a TLS session on TCP port 443.\n\nIf the Console is in an isolated environment and is unable to communicate with the internet, configure the Console to receive Intelligence Stream updates using one of the following methods:\n- Manual import.\n- Central console.\n- HTTP/S distribution point.\n\nhttps://docs.paloaltonetworks.com/prisma/prisma-cloud/22-01/prisma-cloud-compute-edition-admin/tools/update_intel_stream_offline.html","checkText":"Navigate to Prisma Cloud Compute Console's >> Manage >> System >> Intelligence tab. \n\nIf the \"Last streams update\" date is older than 36 hours, this is a finding.","cciIds":["CCI-002605"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-253551r961734_rule","stigId":"V-253551","groupId":"V-253551","title":"DPMS Target Palo Alto Networks Prisma Cloud Compute","severity":"CAT II","description":"Prisma Cloud Compute's configuration of Defender deployment must be monitored to ensure monitoring and protection of the environment is in accordance with organizational policy.","fixText":"Navigate to Prisma Cloud Compute Console's >> Manage >> Defenders.\n\nSelect the \"Manage\" tab. Select the \"Defenders\" tab.\n\nDeploy Defender to containerization node. Select the method of Defender deployment.\n\nhttps://docs.paloaltonetworks.com/prisma/prisma-cloud/22-01/prisma-cloud-compute-edition-admin/install/defender_types.html","checkText":"Navigate to Prisma Cloud Compute Console's >> Manage >> Defenders.\n\nSelect the \"Manage\" tab. Select the \"Defenders\" tab.\n\nDetermine the deployment status of the Defenders.\n\nIf a Defender is not deployed to intended workload(s) to be protected, this is a finding.","cciIds":["CCI-002699"],"status":"not_reviewed","findingDetails":"","comments":""},{"id":"SV-253552r961896_rule","stigId":"V-253552","groupId":"V-253552","title":"DPMS Target Palo Alto Networks Prisma Cloud Compute","severity":"CAT II","description":"Each Prisma Cloud Compute release's tar file has an associated SHA-256 digest hash value to ensure the components have not been modified.","fixText":"Deploy the latest version from https://support.paloaltonetworks.com.","checkText":"Offline Intelligence Stream:\n\nIf using Iron Bank distribution of Prisma Cloud Compute Console and Defenders, verify the Console and Defender imageID SHA256 values match the Palo Alto Networks published release values.\n\nFor the Console and Defender images, perform the following command:\n$ docker inspect twistlock/private:console_22_01_839 | grep '\"Image\":'\n            \"Image\": \"sha256:dcd881fe9c796ed08867c242389737c4f2e8ab463377a90deddc0add4c3e8524\",\n\nIf the imageID values do not match the published release SHA256 for the version of the image release, this is a finding. \n\nNote: Image tag will be the release number, e.g., console_22_01_839. Published release image sha values are published here: https://docs.paloaltonetworks.com/prisma/prisma-cloud/prisma-cloud-compute-edition-public-sector/isolated_upgrades/releases.html","cciIds":["CCI-000803"],"status":"not_reviewed","findingDetails":"","comments":""}]}